!function(e,t){"use strict";e.PopUpVideo=t(e)}("undefined"!=typeof window?window:this,function(){function e(){if(this.element=null,this.content=null,this.close=null,arguments[0]&&(this.element=arguments[0]),null===this.element){var e=document.createElement("div");e.className="popup-video__modal";var o=document.createElement("div");o.className="popup-video__modal__close",o.innerHTML='<i class="l-svg-icons"><svg><use xlink:href="#Z003-Close"></use></svg></i>';var i=document.createElement("div");i.className="popup-video__modal__content",e.appendChild(o),e.appendChild(i),document.body.appendChild(e),this.element=e}this.content=this.element.querySelector(".popup-video__modal__content"),this.close=this.element.querySelector(".popup-video__modal__close"),this.element.addEventListener("click",t.bind(this)),this.close.addEventListener("click",t.bind(this))}function t(e){e.preventDefault(),this.close_modal()}function o(){this.element=null,this.typology=null,this.video_element=null,arguments[0]&&(this.element=arguments[0]);var e={closeOnEnd:!1};arguments[1]&&"object"==typeof arguments[1]?this.options=d(e,arguments[1]):this.options=e,null!==this.element&&""!==this.element.href&&"undefined"!=typeof this.element.href&&(i.call(this),this.typology&&(this.options.closeOnEnd&&l.call(this),n.call(this)))}function i(){if(-1!==this.element.href.search(/https?:\/\/youtu\.be\/[a-zA-Z0-9\-\_]+$/g)){this.typology="youtube";var e=/https+:\/\/youtu.be\/([a-zA-Z0-9\-\_]+)$/g,t=e.exec(this.element.href);this.resource_id=t[1]}else if(-1!==this.element.href.search(/https?:\/\/vimeo\.com\/[a-zA-Z0-9]+(?:\/[a-zA-Z0-9]+)?$/g)){this.typology="vimeo";var o=/https?:\/\/vimeo\.com\/([a-zA-Z0-9]+)(?:\/([a-zA-Z0-9]+))?$/g,i=o.exec(this.element.href);this.resource_id=i[1],this.resource_optional=i[2]}else-1!==this.element.href.search(/https?:\/\/\S*\.mp4$/g)&&(this.typology="mp4")}function n(){this.element.addEventListener("click",s.bind(this))}function s(e){e.preventDefault();var t;switch(this.typology){case"youtube":t=document.createElement("iframe"),t.setAttribute("allowfullscreen",!0),t.setAttribute("frameborder","0"),t.setAttribute("allow","autoplay"),t.setAttribute("src","https://www.youtube.com/embed/"+this.resource_id+"?autoplay=1&rel=0&color=white&frameborder=0"+(this.options.closeOnEnd?"&enablejsapi=1&origin="+window.location.origin:""));break;case"vimeo":t=document.createElement("iframe"),t.setAttribute("allowfullscreen",!0),t.setAttribute("frameborder","0"),t.setAttribute("allow","autoplay,fullscreen"),t.setAttribute("src","https://player.vimeo.com/video/"+this.resource_id+"?autoplay=1"+("undefined"!=typeof this.resource_optional?"&h="+this.resource_optional:""));break;case"mp4":t=document.createElement("video");var o=document.createElement("source");t.setAttribute("autoplay",!0),t.setAttribute("controls",!0),t.setAttribute("preload","metadata"),t.appendChild(o),o.setAttribute("type","video/mp4"),o.setAttribute("src",this.element.href)}if(this.video_element=t,this.options.closeOnEnd)switch(this.typology){case"youtube":r.call(this);break;case"vimeo":a.call(this);break;case"mp4":this.video_element.addEventListener("ended",c.bind(this))}u.open_modal(t)}function l(){switch(this.typology){case"youtube":if("undefined"==typeof YT){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}break;case"vimeo":if("undefined"==typeof Vimeo){var e=document.createElement("script");e.src="https://player.vimeo.com/api/player.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}break;case"mp4":}}function r(){var e=function(e){YT.PlayerState.ENDED==e.data&&u.close_modal()};new YT.Player(this.video_element,{events:{onStateChange:e}})}function a(){var e=new Vimeo.Player(this.video_element),t=function(){u.close_modal(),e.off("ended",t)};e.on("ended",t)}function c(){this.video_element.removeEventListener("ended",c.bind(this)),u.close_modal()}function d(e,t){var o;for(o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}e.prototype.open_modal=function(e){this.content.appendChild(e),this.element.style.display="block"},e.prototype.close_modal=function(){this.element.style.display="",this.content.innerHTML=""};var u=new e(document.querySelector(".popup-video__modal"));return o});