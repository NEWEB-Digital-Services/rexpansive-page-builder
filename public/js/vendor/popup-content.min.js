/**
 * PopUp Content plugin
 * 
 */
!function(t,e){"use strict";t.PopUpContent=e(t)}("undefined"!=typeof window?window:this,function(){function t(t){for(var e=0;e<E.length;e++)E[e].call(t)}function e(){this.element=null,this.iframeContainer=null,this.hashTarget="",this.target=null,this.urlTarget="",this.open=!1,this.closeBtn=null,this.contentLoaded=!1,arguments[0]&&(this.element=arguments[0]);var t={bodyPopUpViewClass:"popup-content--active",iframePopUpLoadClass:"popup-iframe--loaded",popUpContentLoaded:"popup-content--loaded",popUpWrapper:"popup-content",popupViewClass:"popup-content--view",popUpCloseWrapper:"popup-content-close-wrapper",popUpCloseClass:"popup-content-close",popUpContent:"popup-content-content",popUpAnimationClass:"popup-content--base-animation",contentInjectorPoint:"rexpansive_section",loadTiming:"hover",contentRetrieveMethod:"ajax",getPopUpContentComplete:null,ajaxSettings:null,listenESCKey:!1,listenClickOutside:!1};arguments[1]&&"object"==typeof arguments[1]?this.options=g(t,arguments[1]):this.options=t,null!==this.element&&(n.call(this),null!==this.target&&(o.call(this),v.push(this)))}function n(){if(this.hashTarget=this.element.hash.substr(1),""!==this.hashTarget)this.target=document.getElementById(this.hashTarget);else{this.urlTarget=this.element.href,this.target=f(this.options),null!==this.options.ajaxSettings&&(this.options.ajaxSettings.data.target=this.urlTarget,this.options.ajaxSettings.success=l.bind(this),this.options.ajaxSettings.error=function(t){console.log("There was an error")});var t=m(this.element,this.options.contentInjectorPoint);t.insertAdjacentElement("afterend",this.target),"load"===this.options.loadTiming&&r.call(this)}null!==this.target&&(this.closeBtn=[].slice.call(this.target.getElementsByClassName(this.options.popUpCloseClass)),this.closeBtn.length>0&&(this.closeBtn=this.closeBtn[0]))}function o(){this.element.addEventListener("click",p.bind(this)),this.closeBtn&&this.closeBtn.addEventListener("click",p.bind(this)),"hover"===this.options.loadTiming&&this.element.addEventListener("mouseover",r.bind(this),{once:!0}),this.options.listenESCKey&&E.push(s.bind(this)),this.options.listenClickOutside&&this.target.addEventListener("click",i.bind(this))}function i(t){this.target===t.target&&(t.preventDefault(),a.call(this))}function s(t){t=t||window.event;var e=!1;e="key"in t?"Escape"===t.key||"Esc"===t.key:27===t.keyCode,e&&a.call(this,t)}function a(){if(this.open){y(this.target,this.options.popupViewClass),y(document.body,this.options.bodyPopUpViewClass),this.open=!1;var t=new Event("popUpContent:close");document.dispatchEvent(t)}}function p(t){t.preventDefault(),b(this.target,this.options.popupViewClass),b(document.body,this.options.bodyPopUpViewClass),this.open=!this.open;var e=this.open?"popUpContent:open":"popUpContent:close",n=new Event(e);document.dispatchEvent(n)}function l(t){console.time("load_content"),t.success&&c.call(this,t.data.data),console.timeEnd("load_content")}function r(t){if(!this.contentLoaded){t.preventDefault();var e=this;switch(this.options.contentRetrieveMethod){case"iframe":c.call(this);break;case"append":default:if(null!==this.options.ajaxSettings)$.ajax(this.options.ajaxSettings);else{var n=new XMLHttpRequest;n.open("GET",this.urlTarget,!0),n.onload=function(){if(n.status>=200&&n.status<400){var t=n.responseText;c.call(e,t)}},n.onerror=function(){},n.send()}}}}function c(t){switch(h.call(this,t),this.options.contentRetrieveMethod){case"iframe":this.iframeContainer.addEventListener("load",d.bind(this));break;case"append":default:w(this.target,this.options.popUpContentLoaded),"function"==typeof this.options.getPopUpContentComplete&&this.options.getPopUpContentComplete.call(this)}this.contentLoaded=!0}function h(t){switch(this.options.contentRetrieveMethod){case"iframe":this.target.querySelector("."+this.options.popUpContent).innerHTML='<iframe src="'+this.urlTarget+'"></iframe>',this.iframeContainer=this.target.getElementsByTagName("IFRAME")[0];break;case"append":default:this.target.querySelector("."+this.options.popUpContent).innerHTML=t}}function d(t){w(this.iframeContainer.contentDocument.body,this.options.iframePopUpLoadClass),w(this.target,this.options.popUpContentLoaded),"function"==typeof this.options.getPopUpContentComplete&&this.options.getPopUpContentComplete.call(this);var e=new Event("popUpContent:loadComplete");this.iframeContainer.contentDocument.dispatchEvent(e),this.iframeContainer.contentWindow.addEventListener("click",u.bind(this))}function u(t){if("A"===t.target.tagName.toUpperCase()&&""!==t.target.href){t.preventDefault(),y(this.target,this.options.popupViewClass),y(document.body,this.options.bodyPopUpViewClass);var e={rexliveEvent:!0,eventName:"popUpContent:changePage",href:t.target.href};window.parent.postMessage(e,"*")}}function f(t){var e=document.createElement("div");w(e,t.popUpWrapper),w(e,"popup-content__method--"+t.contentRetrieveMethod),w(e,t.popUpAnimationClass);var n=document.createElement("div");if(w(n,t.popUpCloseWrapper),C)n.innerHTML=C.innerHTML;else{var o=document.createElement("div");o.innerHTML='<i class="l-svg-icons"><svg><use xlink:href="#Z003-Close"></use></svg></i>',w(o,t.popUpCloseClass),n.appendChild(o)}var i=document.createElement("div");return w(i,t.popUpContent),e.appendChild(n),e.appendChild(i),e}function m(t,e){return null===t.parentNode||t.parentNode instanceof HTMLDocument?null:U(t.parentNode,e)?t.parentNode:m(t.parentNode,e)}function g(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var v=[],C=document.getElementById("tmpl-popupcontent-close"),E=[];document.addEventListener("keydown",t);var U,w,y,b;return"classList"in document.documentElement?(U=function(t,e){return t.classList.contains(e)},w=function(t,e){t.classList.add(e)},y=function(t,e){t.classList.remove(e)}):(U=function(t,e){return new RegExp("\\b"+e+"\\b").test(t.className)},w=function(t,e){U(t,e)||(t.className+=" "+e)},y=function(t,e){t.className=t.className.replace(new RegExp("\\b"+e+"\\b","g"),"")}),b=function(t,e){U(t,e)?y(t,e):w(t,e)},e.prototype.openPopup=function(){var t=new Event("mouseover"),e=new Event("click");r.call(this,t),p.call(this,e)},e.data=function(t){var e=0,n=v.length;for(e=0;e<n;e++)if(t===v[e].element)return v[e];return null},e});