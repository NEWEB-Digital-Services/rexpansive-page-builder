/**
 * PopUp Content plugin
 * 
 */
!function(t,e){"use strict";t.PopUpContent=e()}("undefined"!=typeof window?window:this,function(){var o,i,s,e,a=[],p=document.getElementById("tmpl-popupcontent-close"),n=[];function t(){this.element=null,this.iframeContainer=null,this.hashTarget="",this.target=null,this.urlTarget="",this.open=!1,this.closeBtn=null,this.contentLoaded=!1,arguments[0]&&(this.element=arguments[0]);var t={bodyPopUpViewClass:"popup-content--active",iframePopUpLoadClass:"popup-iframe--loaded",popUpContentLoaded:"popup-content--loaded",popUpWrapper:"popup-content",popupViewClass:"popup-content--view",popUpCloseWrapper:"popup-content-close-wrapper",popUpCloseClass:"popup-content-close",popUpContent:"popup-content-content",popUpAnimationClass:"popup-content--base-animation",contentInjectorPoint:"rexpansive_section",loadTiming:"hover",contentRetrieveMethod:"ajax",getPopUpContentComplete:null,ajaxSettings:null,listenESCKey:!1,listenClickOutside:!1,closeCallback:null,openCallback:null,iframeClickCallback:null},t=(this.options=arguments[1]&&"object"==typeof arguments[1]?u(t,arguments[1]):t,this.element.getAttribute("data-popup-content-options"));if(null!==t)try{var e=JSON.parse(t);this.options=u(this.options,e)}catch(t){console.warn("[PopupContent]: inline options passed in wrong manner")}null!==this.element&&void 0!==this.element.href&&(function(){this.hashTarget=this.element.hash.substr(1),""!==this.hashTarget?this.target=document.getElementById(this.hashTarget):(this.urlTarget=this.element.href,this.target=function(t){var e=document.createElement("div"),n=(i(e,t.popUpWrapper),i(e,"popup-content__method--"+t.contentRetrieveMethod),i(e,t.popUpAnimationClass),document.createElement("div"));i(n,t.popUpCloseWrapper),p?n.innerHTML=p.innerHTML:((o=document.createElement("div")).innerHTML='<i class="l-svg-icons"><svg><use xlink:href="#Z003-Close"></use></svg></i>',i(o,t.popUpCloseClass),n.appendChild(o));var o=document.createElement("div");return i(o,t.popUpContent),e.appendChild(n),e.appendChild(o),e}(this.options),null!==this.options.ajaxSettings&&(this.options.ajaxSettings.data.target=this.urlTarget,this.options.ajaxSettings.success=function(t){console.time("load_content"),t.success&&h.call(this,t.data.data);console.timeEnd("load_content")}.bind(this),this.options.ajaxSettings.error=function(t){console.log("There was an error")}),function t(e,n){if(null===e.parentNode||e.parentNode instanceof HTMLDocument)return null;return o(e.parentNode,n)?e.parentNode:t(e.parentNode,n)}(this.element,this.options.contentInjectorPoint).insertAdjacentElement("afterend",this.target),"load"===this.options.loadTiming&&r.call(this));null!==this.target&&(this.closeBtn=[].slice.call(this.target.getElementsByClassName(this.options.popUpCloseClass)),0<this.closeBtn.length)&&(this.closeBtn=this.closeBtn[0])}.call(this),null!==this.target)&&(function(){this.element.addEventListener("click",c.bind(this)),this.closeBtn&&this.closeBtn.addEventListener("click",c.bind(this));"hover"===this.options.loadTiming&&this.element.addEventListener("mouseover",r.bind(this),{once:!0});this.options.listenESCKey&&n.push(function(t){t=t||window.event;var e=!1;e="key"in t?"Escape"===t.key||"Esc"===t.key:27===t.keyCode;e&&l.call(this,t)}.bind(this));this.options.listenClickOutside&&this.target.addEventListener("click",function(t){this.target===t.target&&(t.preventDefault(),l.call(this))}.bind(this))}.call(this),a.push(this))}function l(){var t;this.open&&(s(this.target,this.options.popupViewClass),s(document.body,this.options.bodyPopUpViewClass),this.open=!1,this.options.closeCallback&&this.options.closeCallback.call(this),t=new Event("popUpContent:close"),document.dispatchEvent(t))}function c(t){t.preventDefault(),e(this.target,this.options.popupViewClass),e(document.body,this.options.bodyPopUpViewClass),this.open=!this.open,this.open?this.options.openCallback&&this.options.openCallback.call(this):this.options.closeCallback&&this.options.closeCallback.call(this);t=this.open?"popUpContent:open":"popUpContent:close",t=new Event(t);document.dispatchEvent(t)}function r(t){var e,n;this.contentLoaded||(t.preventDefault(),"iframe"===(e=this).options.contentRetrieveMethod?h.call(this):null!==this.options.ajaxSettings?$.ajax(this.options.ajaxSettings):((n=new XMLHttpRequest).open("GET",this.urlTarget,!0),n.onload=function(){var t;200<=n.status&&n.status<400&&(t=n.responseText,h.call(e,t))},n.onerror=function(){},n.send()))}function h(t){!function(t){"iframe"===this.options.contentRetrieveMethod?(this.target.querySelector("."+this.options.popUpContent).innerHTML='<iframe src="'+this.urlTarget+'"></iframe>',this.iframeContainer=this.target.getElementsByTagName("IFRAME")[0]):this.target.querySelector("."+this.options.popUpContent).innerHTML=t}.call(this,t),"iframe"===this.options.contentRetrieveMethod?this.iframeContainer.addEventListener("load",function(t){i(this.iframeContainer.contentDocument.body,this.options.iframePopUpLoadClass),i(this.target,this.options.popUpContentLoaded),"function"==typeof this.options.getPopUpContentComplete&&this.options.getPopUpContentComplete.call(this);var e=new Event("popUpContent:loadComplete");this.iframeContainer.contentDocument.dispatchEvent(e),this.iframeContainer.contentWindow.addEventListener("click",function(t){var e,n;"A"===t.target.tagName.toUpperCase()&&""!==t.target.href&&(t.preventDefault(),e=!0,this.options.iframeClickCallback&&(n=this.options.iframeClickCallback.call(this,t),e=void 0===n||n),!0===e)&&(s(this.target,this.options.popupViewClass),s(document.body,this.options.bodyPopUpViewClass),n={rexliveEvent:!0,eventName:"popUpContent:changePage",href:t.target.href},window.parent.postMessage(n,"*"))}.bind(this))}.bind(this)):(i(this.target,this.options.popUpContentLoaded),"function"==typeof this.options.getPopUpContentComplete&&this.options.getPopUpContentComplete.call(this)),this.contentLoaded=!0}function u(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}return document.addEventListener("keydown",function(t){for(var e=0;e<n.length;e++)n[e].call(t)}),s="classList"in document.documentElement?(o=function(t,e){return t.classList.contains(e)},i=function(t,e){t.classList.add(e)},function(t,e){t.classList.remove(e)}):(o=function(t,e){return new RegExp("\\b"+e+"\\b").test(t.className)},i=function(t,e){o(t,e)||(t.className+=" "+e)},function(t,e){t.className=t.className.replace(new RegExp("\\b"+e+"\\b","g"),"")}),e=function(t,e){(o(t,e)?s:i)(t,e)},t.prototype.openPopup=function(){var t=new Event("mouseover"),e=new Event("click");r.call(this,t),c.call(this,e)},t.data=function(t){for(var e=0,n=a.length,e=0;e<n;e++)if(t===a[e].element)return a[e];return null},t});