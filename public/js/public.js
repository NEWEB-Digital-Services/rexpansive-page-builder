var Rexbuilder_Util=function($){"use strict";function rtimeOut(e,t){var i,a=Date.now,o=window.requestAnimationFrame,r=a(),n=function(){a()-r<t?i||o(n):e()};return o(n),{clear:function(){i=1}}}function rInterval(e,t){var i,a=Date.now,o=window.requestAnimationFrame,r=a(),n=function(){a()-r<t||(r+=t,e()),i||o(n)};return o(n),{clear:function(){i=1}}}function _smoothScroll(e){$("body,html").animate({scrollTop:e.offset().top+_plugin_frontend_settings.scroll_animation_offset},600)}var hasClass,addClass,removeClass,toggleClass;"classList"in document.documentElement?(hasClass=function(e,t){return e.classList.contains(t)},addClass=function(e,t){e.classList.add(t)},removeClass=function(e,t){e.classList.remove(t)}):(hasClass=function(e,t){return new RegExp("\\b"+t+"\\b").test(e.className)},addClass=function(e,t){hasClass(e,t)||(e.className+=" "+t)},removeClass=function(e,t){e.className=e.className.replace(new RegExp("\\b"+t+"\\b","g"),"")}),toggleClass=function(e,t){hasClass(e,t)?removeClass(e,t):addClass(e,t)};var fixSectionWidth=0,editorMode=!1,windowIsResizing=!1,firstResize=!0,responsiveLayouts,defaultLayoutSections,$modelsCustomizationsDataDiv,$pageCustomizationsDataDiv,$liveDataContainer,$layoutsDomOrder,$defaultLayoutState,$usedIDSContainer,sectionIDSused,frontAvailableLayouts,startFrontLayout,changedFrontLayout,loadWidth,createRandomID=function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},_storeNamesUsed=function(){sectionIDSused=$usedIDSContainer.length>0?JSON.parse($usedIDSContainer.text()):[]},_saveSectionNamesUsed=function(){$usedIDSContainer.text(JSON.stringify(sectionIDSused))},_getSectionNamesUsed=function(){return sectionIDSused},_addSectionID=function(e){var t;for(t=sectionIDSused.length-1;t>=0&&e!=sectionIDSused[t];t--);t==-1&&sectionIDSused.push(e)},_removeSectionID=function(e){var t=0;for(t=sectionIDSused.length-1;t>=0&&e!=sectionIDSused[t];t--);t>-1&&(sectionIDSused.splice(t,1),_saveSectionNamesUsed())},_createSectionID=function(){var e,t,i,a=4;do if(t=!0,e=createRandomID(a),"self"==e)t=!1;else for(i=0;i<sectionIDSused.length;i++)if(e==sectionIDSused[i]){t=!1;break}while(!t);return _addSectionID(e),e},createBlockID=function(){var e,t,i,a=4;do t=!0,e=createRandomID(a),"self"==e?t=!1:Rexbuilder_Util.$rexContainer.find(".grid-stack-item").each(function(){i=$(this),void 0!==i.attr("data-rexbuilder-block-id")&&i.attr("data-rexbuilder-block-id")==e&&(t=!1)});while(!t);return e},_updateSectionsID=function(){if(Rexbuilder_Util.rexContainer){var e,t,i=[].slice.call(Rexbuilder_Util.rexContainer.getElementsByClassName("rexpansive_section")),a=i.length;for(t=0;t<a;t++){var o=i[t].getAttribute("data-rexlive-section-id");null!==o&&""!==o||(e=_createSectionID(),i[t].setAttribute("data-rexlive-section-id",e),_fix_tools_ids(i[t],e))}}},_fix_tools_ids=function(e,t){if(e){var i,a,o,r,n,s,d=[].slice.call(e.getElementsByClassName("tool-area--side tool-area--left")),l=d.length;for(i=0;i<l;i++){for(o=[].slice.call(d[i].getElementsByClassName("edit-row-width")),r=o.length,a=0;a<r;a++)o[a].setAttribute("id",o[a].getAttribute("id")+t),o[a].setAttribute("name",o[a].getAttribute("name")+t),o[a].nextElementSibling.setAttribute("for",o[a].nextElementSibling.getAttribute("for")+t);for(n=[].slice.call(d[i].getElementsByClassName("edit-row-layout")),s=n.length,a=0;a<s;a++)n[a].setAttribute("id",n[a].getAttribute("id")+t),n[a].setAttribute("name",n[a].getAttribute("name")+t),n[a].nextElementSibling.setAttribute("for",n[a].nextElementSibling.getAttribute("for")+t)}}},_updateSectionsNumber=function(){var e=-1;if(Rexbuilder_Util.rexContainer){var t,i=[].slice.call(Rexbuilder_Util.rexContainer.getElementsByClassName("rexpansive_section")),a=i.length;for(t=0;t<a;t++)i[t].setAttribute("data-rexlive-section-number",t),e=t}Rexbuilder_Util.lastSectionNumber=e},_findLayoutType=function(e){return"default"==e||"tablet"==e||"mobile"==e?"standard":"custom"},_findFrontLayout=function(){for(var e=_viewport().width,t=frontAvailableLayouts.length-1;t>=0;t--)if(e>=parseInt(frontAvailableLayouts[t].min)&&(""==frontAvailableLayouts[t].max||e<=parseInt(frontAvailableLayouts[t].max)))return frontAvailableLayouts[t].id},_getModelsCustomizations=function(){var e=[];return $modelsCustomizationsDataDiv.children(".model-customizations-container").each(function(t,i){var a=$(i),o=parseInt(a.attr("data-model-id")),r=[];a.children(".model-customization-data").each(function(e,t){var i=$(t),a=i.attr("data-model-layout-name"),o=JSON.parse(i.text()),n={name:a,targets:o};r.push(n)});var n={id:o,customizations:r};e.push(n)}),e},_updateModelsCustomizationsData=function(e){var t,i,a=e.id,o=$modelsCustomizationsDataDiv.children('.model-customizations-container[data-model-id="'+a+'"]');for(0!=o.length?o.children(".model-customization-data").remove():(o=$(document.createElement("div")),o.addClass("model-customizations-container"),o.attr("data-model-id",a),o.appendTo($modelsCustomizationsDataDiv[0])),t=0,i=e.customizations.length;t<i;t++){var r=$(document.createElement("div"));r.addClass("model-customization-data"),r.attr("data-model-layout-name",e.customizations[t].name),r.text(JSON.stringify(e.customizations[t].targets)),r.appendTo(o[0])}$modelsCustomizationsDataDiv.attr("data-empty-models-customizations",!1)},_updateDivModelCustomizationsNames=function(e){var t,i,a=$("#rexbuilder-model-data .available-models-customizations-names"),o=JSON.parse(a.text()),r=[];for(t=0,i=o.length;t<i;t++){var n=o[t];n.id!=e.id&&r.push(n)}r.push(e),a.text(JSON.stringify(r))},_getPageCustomizations=function(){var e=[],t={name:"default",sections:[]},i=$pageCustomizationsDataDiv.children('.customization-wrap[data-customization-name="default"]');return i.children(".section-targets").each(function(e,i){var a=$(i),o=a.attr("data-section-rex-id"),r=isNaN(parseInt(a.attr("data-model-id")))?-1:parseInt(a.attr("data-model-id")),n=isNaN(parseInt(a.attr("data-model-number")))?-1:parseInt(a.attr("data-model-number")),s="undefined"!=typeof a.attr("data-section-hide")&&"1"==a.attr("data-section-hide").toString(),d=""!=a.text()?JSON.parse(a.text()):[];t.sections.push({section_rex_id:o,section_model_id:r!=-1?r:"",section_model_number:n!=-1?n:"",section_is_model:r!=-1,section_hide:s,targets:d})}),e.push(t),$pageCustomizationsDataDiv.children('.customization-wrap:not([data-customization-name="default"])').each(function(t,i){var a=$(i),o=a.attr("data-customization-name"),r={name:o,sections:[]};a.children(".section-targets").each(function(e,t){var i=$(t),a=i.attr("data-section-rex-id"),o=isNaN(parseInt(i.attr("data-model-id")))?-1:parseInt(i.attr("data-model-id")),n=isNaN(parseInt(i.attr("data-model-number")))?-1:parseInt(i.attr("data-model-number")),s="undefined"!=typeof i.attr("data-section-hide")&&"1"==i.attr("data-section-hide").toString(),d=""!=i.text()?JSON.parse(i.text()):[],l="undefined"!=typeof i.attr("data-section-created-live")&&"1"==i.attr("data-section-created-live").toString();r.sections.push({section_rex_id:a,section_model_id:o!=-1?o:"",section_model_number:n!=-1?n:"",section_is_model:o!=-1,section_hide:s,section_created_live:l,targets:d})}),e.push(r)}),e},_createPageCustomizationsDataLive=function(e){$liveDataContainer.children().remove();var t,i;for(t=0,i=e.length;t<i;t++){var a=$(document.createElement("div"));a.addClass("section-targets"),a.attr("data-section-rex-id",e[t].section_rex_id),a.attr("data-model-id",e[t].section_model_id),a.attr("data-model-number",e[t].section_model_number),a.attr("data-section-hide",e[t].section_hide),a.text(JSON.stringify(e[t].targets)),a.appendTo($liveDataContainer[0])}},_updatePageCustomizationsData=function(e){var t,i,a=e.name,o=$pageCustomizationsDataDiv.children('.customization-wrap[data-customization-name="'+a+'"]');for(0!=o.length?o.children(".section-targets").remove():(o=$(document.createElement("div")),o.addClass("customization-wrap"),o.attr("data-customization-name",a),o.appendTo($pageCustomizationsDataDiv[0])),t=0,i=e.sections.length;t<i;t++){var r=$(document.createElement("div"));r.addClass("section-targets"),r.attr("data-section-rex-id",e.sections[t].section_rex_id),r.attr("data-model-id",e.sections[t].section_model_id),r.attr("data-model-number",e.sections[t].section_model_number),r.attr("data-section-hide",e.sections[t].section_hide),r.attr("data-section-created-live","true"==e.sections[t].section_created_live.toString()&&"1"),""==e.sections[t].section_model_id&&r.text(JSON.stringify(e.sections[t].targets)),r.appendTo(o[0])}$pageCustomizationsDataDiv.removeAttr("data-empty-customizations")},_updatePageAvaiableLayoutsNames=function(e){var t=$("#rexbuilder-layout-data .available-layouts-names");t.text(JSON.stringify(e))},_getSectionCustomLayouts=function(e){var t,i,a,o,r=[],n=Rexbuilder_Util.getPageCustomizations();for(t=0,a=n.length;t<a;t++){var s=n[t].name;if(null!=n[t].sections)for(i=0,o=n[t].sections.length;i<o;i++)if(n[t].sections[i].section_rex_id==e){var d=jQuery.extend(!0,[],n[t].sections[i].targets),l={name:s,targets:d};r.push(l)}}return r},chooseLayout=function(){var e=$("#rexbuilder-layout-data"),t=$("#rexbuilder-model-data");if(Rexbuilder_Util.chosenLayoutData={min:0,max:"",id:"default",label:"My Desktop",type:"standard"},"true"==e.children(".layouts-data").attr("data-empty-customizations")||Rexbuilder_Util.editorMode&&Rexbuilder_Util.firstStart)return"default";var i,a,o,r,n,s,d,l,u,c,p=_viewport().width,m=$("#layout-avaiable-dimensions"),g=m.length>0?JSON.parse(m.text()):[],f=t.children(".available-models-customizations-names"),h=f.length>0?JSON.parse(f.text()):[],v=e.children(".available-layouts-names"),y=v.length>0?JSON.parse(v.text()):[],b=[];for(i=0,r=g.length;i<r;i++){for(c=!1,a=0,n=h.length;a<n;a++)for(o=0,s=h[a].names.length;o<s;o++)if(g[i].id==h[a].names[o]){var x=g[i];x.model=!0,c=!0,b.push(x)}if(!c)for(o=0,d=y.length;o<d;o++)if(g[i].id==y[o]){var x=g[i];x.model=!1,c=!0,b.push(x)}}for(i=0,l=b.length;i<l;i++)""==b[i].min&&(b[i].min=0);var S="",D=_.sortBy(b,[function(e){return parseInt(e.min)}]);for(i=0,u=D.length;i<u;i++)p>=D[i].min&&(""!=D[i].max?p<=D[i].max&&(S=D[i].id,Rexbuilder_Util.chosenLayoutData=D[i]):(S=D[i].id,Rexbuilder_Util.chosenLayoutData=D[i]));return""===S&&(S="default"),S},predictLayout=function(){var e=_viewport().width;return e<=767?"mobile":e<=1024?"tablet":"default"},_createEmptyTargets=function(e){var t,i,a=[];for(t=0,i=e.length;t<i;t++){var o={name:e[t].name,props:{}};"self"==e[t].name&&_viewport().width<_plugin_frontend_settings.defaultSettings.collapseWidth&&(o.props.collapse_grid=!0),a.push(o)}return a},_getDefaultPageLayout=function(e,t){var i,a,o,r,n,s,d,l,u,c=[];for(i=0,n=e.length;i<n;i++)if("default"==e[i].name){for(a=0,s=e[i].sections.length;a<s;a++)c.push(jQuery.extend(!0,{},e[i].sections[a]));break}for(i=0,d=c.length;i<d;i++)if("true"==c[i].section_is_model.toString())for(o=0,l=t.length;o<l;o++)if(t[o].id==c[i].section_model_id){for(r=0,u=t[o].customizations.length;r<u;r++)if("default"==t[o].customizations[r].name){c[i].targets=jQuery.extend(!0,[],t[o].customizations[r].targets);break}break}return c},_getDefaultModelsLayout=function(e){var t,i,a,o,r=[];for(t=0,a=e.length;t<a;t++)for(i=0,o=e[t].customizations.length;i<o;i++)if("default"==e[t].customizations[i].name){r.push({id:e[t].id,targets:e[t].customizations[i].targets});break}return r},_getCustomLayoutSections=function(e,t,i,a){if("default"==a)return i;var o,r,n,s,d,l,u,c,_,p,m,g,f=[],h=!1,v=_getDefaultModelsLayout(t);for(o=0,d=e.length;o<d;o++)if(e[o].name==a){for(h=!0,r=0,l=e[o].sections.length;r<l;r++)f.push(jQuery.extend(!0,{},e[o].sections[r]));break}if(!h)for(o=0,u=i.length;o<u;o++){var y=jQuery.extend(!0,{},i[o]);y.targets=_createEmptyTargets(i[o].targets),y.sectionCleared=!0,f.push(y)}for(o=0,c=f.length;o<c;o++)if("true"==f[o].section_is_model.toString()){for(n=0,_=t.length;n<_;n++)if(t[n].id==f[o].section_model_id){for(g=!1,s=0,p=t[n].customizations.length;s<p;s++)if(t[n].customizations[s].name==a){g=!0,f[o].targets=jQuery.extend(!0,[],t[n].customizations[s].targets),f[o].defaultSection=!1,f[o].sectionCleared=!1;break}if(!g)for(s=0,m=v.length;s<m;s++)if(f[o].section_model_id==v[s].id){f[o].targets=_createEmptyTargets(v[s].targets),f[o].sectionCleared=!0;break}break}}else if(0==f[o].targets.length)for(r=0,u=i.length;r<u;r++)if(f[o].section_rex_id==i[r].section_rex_id){f[o].targets=_createEmptyTargets(i[r].targets),f[o].sectionCleared=!0;break}return f},_mergeSections=function(e,t){var i,a,o,r,n,s,d,l,u;if("default"!=Rexbuilder_Util.activeLayout){for(i=0,n=e.length;i<n;i++)for(e[i].sectionFounded=!1,e[i].defaultSection=!1,a=0,s=t.length;a<s;a++)if(e[i].section_rex_id==t[a].section_rex_id){e[i].sectionFounded=!0;var c=e[i],p=t[a];for(("undefined"==typeof c.targets[0]||jQuery.isEmptyObject(c.targets[0].props)||"undefined"!=typeof c.sectionCleared&&c.sectionCleared)&&(c.defaultSection=!0,c.targets=jQuery.extend(!0,[],p.targets)),o=0,d=c.targets.length;o<d;o++){for(u=!1,r=0,l=p.targets.length;r<l;r++)if(c.targets[o].name==p.targets[r].name){if(c.targets[o].notDisplay=!1,u=!0,p.targets[r].oldElement=!0,o>=1&&jQuery.isEmptyObject(c.targets[o].props)&&"default"!=Rexbuilder_Util.activeLayout&&p.targets[0].props.layout!=c.targets[0].props.layout){var m=parseFloat(p.targets[0].props.grid_cell_width),g=5;"masonry"==p.targets[0].props.layout?(c.targets[o].props.gs_y=Math.round(p.targets[r].props.gs_y*g/m),c.targets[o].props.gs_height=Math.round(p.targets[r].props.gs_height*g/m),c.targets[o].props.gs_start_h=Math.round(p.targets[r].props.gs_start_h*g/m)):(c.targets[o].props.gs_y=Math.round(p.targets[r].props.gs_y*m/g),c.targets[o].props.gs_height=Math.round(p.targets[r].props.gs_height*m/g),c.targets[o].props.gs_start_h=Math.round(p.targets[r].props.gs_start_h*m/g))}c.targets[o].props=_.merge({},p.targets[r].props,c.targets[o].props);break}u||(c.targets[o].notDisplay=!0)}for(r=0,l=p.targets.length;r<l;r++)if("undefined"==typeof p.targets[r].oldElement){var f=jQuery.extend(!0,{},p.targets[r]);if("default"!=Rexbuilder_Util.activeLayout&&p.targets[0].props.layout!=c.targets[0].props.layout){var m=parseFloat(p.targets[0].props.grid_cell_width),g=5;"masonry"==p.targets[0].props.layout?(f.props.gs_y=Math.round(f.props.gs_y*g/m),f.props.gs_height=Math.round(f.props.gs_height*g/m),f.props.gs_start_h=Math.round(f.props.gs_start_h*g/m)):(f.props.gs_y=Math.round(f.props.gs_y*m/g),f.props.gs_height=Math.round(f.props.gs_height*m/g),f.props.gs_start_h=Math.round(f.props.gs_start_h*m/g))}c.targets.splice(1,0,f)}break}if(0==e.length)for(e=t,i=0,n=e.length;i<n;i++)e[i].defaultSection=!0}for(_createPageCustomizationsDataLive(e),i=0,n=e.length;i<n;i++)(e[i].sectionFounded||"default"==Rexbuilder_Util.activeLayout)&&("default"!=Rexbuilder_Util.activeLayout&&e[i].defaultSection||"default"==Rexbuilder_Util.activeLayout)&&_viewport().width<_plugin_frontend_settings.defaultSettings.collapseWidth&&(e[i].targets[0].props.collapse_grid=!0,e[i].targets[0].props.layout="masonry");return jQuery.extend(!0,{},e)},_isMobile=function(){return _viewport().width<_plugin_frontend_settings.defaultSettings.collapseWidth},_cssPropertyValueSupported=function(e,t){var i=document.createElement("div");return i.style[e]=t,i.style[e]===t},_edit_dom_layout=function(e){var t={collapse_needed:!1};if(e==Rexbuilder_Util.activeLayout&&"default"==e)return _viewport().width>=_plugin_frontend_settings.defaultSettings.collapseWidth?Rexbuilder_Util.removeCollapsedGrids():Rexbuilder_Util.blockGridUnder768||(Rexbuilder_Util.collapseAllGrids(),t.collapse_needed=!0),t;Rexbuilder_Util.$rexContainer.attr("data-rex-layout-selected",e),Rexbuilder_Util.activeLayout=e;var i=$("#rexbuilder-layout-data"),a=$("#rexbuilder-model-data");if("true"==i.children(".layouts-customizations").attr("data-empty-customizations")&&"true"==a.children(".models-customizations").attr("data-empty-models-customizations"))return _viewport().width>=_plugin_frontend_settings.defaultSettings.collapseWidth?removeCollapsedGrids():Rexbuilder_Util.blockGridUnder768||(Rexbuilder_Util.collapseAllGrids(),t.collapse_needed=!0),t;var o=[];Rexbuilder_Util.$rexContainer.children(".rexpansive_section:not(.removing_section)").each(function(e,t){var i=$(t);i.hasClass("rex-model-section")&&o.push(parseInt(i.attr("data-rexlive-model-id")))});var r=[];Rexbuilder_Util.$rexContainer.children(".rexpansive_section:not(.removing_section)").each(function(e,t){var i=$(t),a={rexID:i.attr("data-rexlive-section-id"),modelID:isNaN(parseInt(i.attr("data-rexlive-model-id")))?"":parseInt(i.attr("data-rexlive-model-id"))};r.push(a)});var n,s,d=_getPageCustomizations();"default"==Rexbuilder_Util.activeLayout&&_saveCustomizationDomOrder(jQuery.extend(!0,[],d));var l,u=_getModelsCustomizations();"true"==$defaultLayoutState.attr("data-empty-default-customization")?(l=_getDefaultPageLayout(d,u),_createDefaultLayoutState(l)):(_updateDefaultLayoutState({modelsData:u}),l=_getDefaultLayoutState());var c,_=_getCustomLayoutSections(d,u,l,e),p=[];for(n=0;n<_;n++)if("true"==_[n].section_is_model.toString()){for(c=!1,s=0;s<p.length;s++)if(p[s].id==_[n].section_model_id){p[s].number=p[s].number+1,_[n].section_model_number=p[s].number,c=!0;break}c||(_[n].section_model_number=1,p.push({id:_[n].section_model_id,number:1}))}Rexbuilder_Util_Editor.clearSectionsEdited();var m=_mergeSections(_,l);Rexbuilder_Util.removeCollapsedGrids(),Rexbuilder_Util.domUpdaiting=!0;var g=!1,f=[];return $.each(m,function(i,a){if(!a.notInSection||"default"==e){var o,r={rexID:a.section_rex_id,modelID:-1,modelNumber:-1};"true"==a.section_is_model.toString()?(r.modelID=a.section_model_id,r.modelNumber=a.section_model_number,o=Rexbuilder_Util.$rexContainer.children('section[data-rexlive-section-id="'+a.section_rex_id+'"][data-rexlive-model-number="'+r.modelNumber+'"]')):o=Rexbuilder_Util.$rexContainer.children('section[data-rexlive-section-id="'+a.section_rex_id+'"]'),0==o.length||o.hasClass("removing_section")||("undefined"!=typeof a.section_hide&&"true"==a.section_hide.toString()?o.addClass("rex-hide-section"):(o.removeClass("rex-hide-section"),t.collapse_needed+=_updateDOMelements(o,a.targets,g)),f.push(r))}}),Rexbuilder_Dom_Util.fixSectionDomOrder(f,!0),Rexbuilder_Util.domUpdaiting=!1,Rexbuilder_Util.editorMode||initPhotoSwipe(".photoswipe-gallery"),t},_updateDOMelements=function(e,t,i){var a=e.find(".grid-stack-row"),o=a.data();if(t[0].props.gridEdited&&a.attr("data-rexlive-layout-changed",!0),void 0!==o){var r=o.plugin_perfectGridGalleryEditor;if(void 0!==r){for(var n=1,s=t.length;n<s;n++){var d=a.children('div[data-rexbuilder-block-id="'+t[n].name+'"]'),l="undefined"!=typeof t[n].props.hide&&"true"==t[n].props.hide.toString();l?d.hasClass("rex-hide-element")||(d.addClass("rex-hide-element"),r.removeBlock(d)):d.hasClass("rex-hide-element")&&(d.removeClass("rex-hide-element"),r.reAddBlock(d))}var u=r.properties.gridstackInstance;r.batchGridstack()}}for(var n=1,c=t.length;n<c;n++)if(t[n].notDisplay&&"default"!=Rexbuilder_Util.activeLayout){var _=a.children('div[data-rexbuilder-block-id="'+p+'"]');0!=_.length}else{var p=t[n].name,m=t[n].props,d=a.children('div[data-rexbuilder-block-id="'+p+'"]'),g=d.children(".rexbuilder-block-data"),f=d.find(".grid-item-content");d.length>0&&_updateDOMSingleElement(d,m,g,f,u,{positionAndSize:!0})}updateSection(e,a,t[0].props,i),Rexbuilder_Util.editorMode&&updateSectionTools(e,a,t[0].props,i);var h="undefined"!=typeof t[0].props.collapse_grid&&("true"==t[0].props.collapse_grid.toString()||i);if(void 0!==o){var r=a.data().plugin_perfectGridGalleryEditor;void 0!==r&&(Rexbuilder_Util.domUpdaiting=!0,r.properties.gridstackInstance.commit(),setTimeout(function(){Rexbuilder_Util.domUpdaiting=!0,r.batchGridstack(),r.properties.gridstackInstance.batchUpdate(),r.fixBlockDomOrder(),r.saveStateGrid(),"masonry"!=r.settings.galleryLayout||h?"fixed"==r.settings.galleryLayout&&"true"==r.settings.fullHeight.toString()&&r.updateFullHeight():r.updateBlocksHeight(),t[0].props.collapse_grid&&(r.collapseElements(),r.collapseElementsProperties()),r.properties.gridstackInstance.commit(),setTimeout(function(){Rexbuilder_Util.domUpdaiting=!1,r.properties.dispositionBeforeCollapsing=r.createActionDataMoveBlocksGrid(),r._createFirstReverseStack(),r._fixImagesDimension(),Rexbuilder_Util.editorMode&&r._updateElementsSizeViewers(),Rexbuilder_Util.playAllVideos(),setTimeout(function(){Rexbuilder_Util.fixYoutube(r.$section)},1500,r.$section)},200,r)},300,r))}return h},_updateDOMSingleElement=function(e,t,i,a,o,r){if(r.positionAndSize){var n={x:e.attr("data-gs-x"),y:e.attr("data-gs-y"),w:e.attr("data-gs-width"),h:e.attr("data-gs-height"),startH:i.attr("data-gs_start_h"),realFluid:i.attr("data-element_real_fluid")},s={x:"undefined"==typeof t.gs_x?n.x:t.gs_x,y:"undefined"==typeof t.gs_y?n.y:t.gs_y,w:"undefined"==typeof t.gs_width?n.w:t.gs_width,h:"undefined"==typeof t.gs_height?n.h:t.gs_height,startH:"undefined"==typeof t.gs_start_h?n.startH:t.gs_start_h,realFluid:"undefined"==typeof t.element_real_fluid?n.realFluid:t.element_real_fluid,gridstackInstance:o};_updateElementDimensions(e[0],i[0],s)}var d=isNaN(parseInt(t.video_bg_id))?"":parseInt(t.video_bg_id),l="undefined"==typeof t.video_bg_url_youtube?"":t.video_bg_url_youtube,u="undefined"==typeof t.video_bg_url_vimeo?"":t.video_bg_url_vimeo,c="";""!=d?c="mp4":""!=u?c="vimeo":""!=l&&(c="youtube");var _={mp4Data:{idMp4:d,linkMp4:"undefined"==typeof t.video_mp4_url?"":t.video_mp4_url,width:isNaN(parseInt(t.video_bg_width))?parseInt(t.video_bg_width):"",height:isNaN(parseInt(t.video_bg_height))?parseInt(t.video_bg_height):""},vimeoUrl:u,youtubeUrl:l,audio:"undefined"==typeof t.video_has_audio?"":"1"==t.video_has_audio||"true"==t.video_has_audio.toString(),typeVideo:c};("1"!=_plugin_frontend_settings.fast_load||Rexbuilder_Util.editorMode)&&Rexbuilder_Dom_Util.updateVideos(a,_);var p="undefined"==typeof t.image_bg_elem_active||"true"==t.image_bg_elem_active.toString(),m={active:p,idImage:p?isNaN(parseInt(t.id_image_bg))?"":parseInt(t.id_image_bg):"",urlImage:p?t.image_bg_url:"",width:p?isNaN(parseInt(t.image_width))?"":parseInt(t.image_width):"",height:p?isNaN(parseInt(t.image_height))?"":parseInt(t.image_height):"",typeBGimage:p?t.type_bg_image:"",photoswipe:p?t.photoswipe:""};("1"!=_plugin_frontend_settings.fast_load||Rexbuilder_Util.editorMode)&&Rexbuilder_Dom_Util.updateImageBG(a,m);var g={$elem:e,color:t.color_bg_block,active:"undefined"==typeof t.color_bg_block_active||t.color_bg_block_active.toString()};-1===g.color.indexOf("gradient")?Rexbuilder_Dom_Util.updateBlockBackgroundColor(g):Rexbuilder_Dom_Util.updateBlockBackgroundGradient(g);var f={$elem:e,color:t.overlay_block_color,active:"undefined"!=typeof t.overlay_block_color_active&&t.overlay_block_color_active.toString()};-1===f.color.indexOf("gradient")?Rexbuilder_Dom_Util.updateBlockOverlay(f):Rexbuilder_Dom_Util.updateBlockOverlayGradient(f),Rexbuilder_Dom_Util.updateBlockPaddings(e,_getPaddingsDataString("undefined"!=typeof t.block_padding?t.block_padding:""));var h="undefined"==typeof t.block_custom_class?"":t.block_custom_class,v=[];""!=h&&(h=h.trim(),v=h.split(/\s+/)),Rexbuilder_Dom_Util.updateCustomClasses(e,v);var y="undefined"!=typeof t.block_flex_position?t.block_flex_position.split(" "):"",b={x:y[0],y:y[1]};Rexbuilder_Dom_Util.updateFlexPostition(e,b);var x="undefined"==typeof t.slider_dimension_ratio?"":t.slider_dimension_ratio;i.attr("data-slider_ratio",x);var S="undefined"==typeof t.block_ratio?"":t.block_ratio;i.attr("data-block_ratio",S);var D="undefined"==typeof t.block_dimensions_live_edited?"":t.block_dimensions_live_edited;i.attr("data-block_dimensions_live_edited",D);var C="undefined"!=typeof t.hide&&"true"==t.hide.toString();C?(e.hasClass("rex-hide-element")||e.addClass("rex-hide-element"),Rexbuilder_Util.stopBlockVideos(e)):(e.hasClass("rex-hide-element")&&e.removeClass("rex-hide-element"),Rexbuilder_Util.playBlockVideos(e));"undefined"!=typeof t.element_edited&&"true"==t.element_edited.toString();for(var w in t)switch(w){case"type":i.attr("data-type",t.type);break;case"size_x":e.attr("data-width",t.size_x);break;case"size_y":e.attr("data-height",t.size_y);break;case"row":e.attr("data-row",t.row);break;case"col":e.attr("data-col",t.col);break;case"photoswipe":if(!Rexbuilder_Util.editorMode){if("true"==t.photoswipe){addPhotoSwipeElement(a,t.image_bg_block,parseInt(t.image_width),parseInt(t.image_height),t.image_size);var k=e.parents(".rexpansive_section");k.addClass("photoswipe-gallery")}else removePhotoSwipeElement(a);i.attr("data-photoswipe",t.photoswipe)}break;case"linkurl":if(!Rexbuilder_Util.editorMode){var R=a.parents(".element-link");if(""!=t.linkurl)if(0!=R.length)R.attr("href",t.linkurl),R.attr("title",t.linkurl);else{var U=a.parent();tmpl.arg="link",U.append(tmpl("tmpl-link-block",{url:t.linkurl}));var $=U.children(".element-link");a.detach().appendTo($)}else 0!=R.length&&R.children().unwrap()}Rexbuilder_Dom_Util.updateBlockUrl(e,t.linkurl);break;case"zak_background":case"zak_side":case"zak_title":case"zak_icon":case"zak_foreground":break;case"block_animation":break;case"block_has_scrollbar":}},_getDefaultBlockMeasure=function(e){e="undefined"!=typeof e?e:"";var t={defDefaultWidth:3,defDefaultHeight:4,defMobileWidth:12,defMobileHeight:null};if(""!==e){var i=$pageCustomizationsDataDiv.find(".customization-wrap");i.each(function(i,a){for(var o=$(a),r=a.getAttribute("data-customization-name"),n=JSON.parse(o.find(".section-targets[data-section-rex-id="+e+"]").text()),s=0,d=n.length;s<d;s++)if("self"===n[s].name){switch(n[s].props.layout){case"masonry":"mobile"==r?t.defMobileHeight=52:t.defDefaultHeight=Math.ceil(4*n[s].props.grid_cell_width/5);break;case"fixed":"mobile"==r?t.defMobileHeight=4:t.defDefaultHeight=4}break}})}return t.defMobileHeight||(t.defMobileHeight=52),t},_updateModelsLive=function(e,t,i){Rexbuilder_Util.domUpdaiting=!0,Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(a,o){var r=$(o);r.attr("data-rexlive-model-id")==e&&r.attr("data-rexlive-model-number")!=i&&_updateDOMelements(r,t,!1)}),Rexbuilder_Util.domUpdaiting=!1},_saveCustomizationDomOrder=function(e){var t,i,a,o;$layoutsDomOrder.children().remove();var r=[];for(t=0,a=e.length;t<a;t++){var n=$(document.createElement("div"));for(n.addClass("layout-sections"),n.attr("data-rex-layout-name",e[t].name),r=[],i=0,o=e[t].sections.length;i<o;i++)r.push(e[t].sections[i]);n.text(JSON.stringify(r)),n.appendTo($layoutsDomOrder[0])}},_getPageCustomizationsDom=function(){var e=[];return $layoutsDomOrder.children('.layout-sections:not([data-rex-layout-name="default"])').each(function(t,i){var a=$(i);e.push({name:a.attr("data-rex-layout-name"),sections:JSON.parse(a.text())})}),e},_updatePageCustomizationsDomOrder=function(e){for(var t=0,i=e.length;t<i;t++)$layoutsDomOrder.children('.layout-sections[data-rex-layout-name="'+e[t].name+'"]').text(JSON.stringify(e[t].sections))},_getPageAvaiableLayoutsNames=function(){var e=$("#rexbuilder-layout-data .available-layouts-names");return JSON.parse(e.text())},_getLayoutLiveSectionTargets=function(e){var t=[];if(e.hasClass("rex-model-section")){var i=e.attr("data-rexlive-model-id");$liveDataContainer.children().each(function(e,a){var o=$(a);if(i==o.attr("data-model-id"))return t=JSON.parse(o.text()),!1})}else{var a=e.attr("data-rexlive-section-id");$liveDataContainer.children().each(function(e,i){var o=$(i);if(a==o.attr("data-section-rex-id"))return t=JSON.parse(o.text()),!1})}return t},_applyDefaultBlocksDimentions=function(e,t,i){for(var a=_getDefaultLayoutState(),o=e.attr("data-rexlive-section-id"),r=0,n=a.length;r<n;r++)if(o==a[r].section_rex_id){var s=a[r],d=s.targets;i.layout=d[0].props.layout,i.fullHeight=d[0].props.full_height,i.collapsed="undefined"!=typeof d[0].props.collapsed&&d[0].props.collapsed;for(var l=1,u=t.length;l<u;l++)for(var c=0,_=d.length;c<_;c++){var p=t[l];p.name==d[c].name&&(p.props.gs_x=d[c].props.gs_x,p.props.gs_y=d[c].props.gs_y,p.props.gs_width=d[c].props.gs_width,p.props.gs_height=d[c].props.gs_height,p.props.gs_start_h=d[c].props.gs_start_h)}break}},_createDefaultLayoutState=function(e){$defaultLayoutState.children().remove();var t,i;for(t=0,i=e.length;t<i;t++){var a=$(document.createElement("div"));a.addClass("section-targets"),a.attr("data-section-rex-id",e[t].section_rex_id),a.attr("data-model-id",e[t].section_model_id),a.attr("data-model-number",e[t].section_model_number),a.attr("data-section-hide",e[t].section_hide),a.text(JSON.stringify(e[t].targets)),a.appendTo($defaultLayoutState[0])}$defaultLayoutState.removeAttr("data-empty-default-customization")},_updateDefaultLayoutState=function(e){var t,i,a,o,r,n,s="undefined"==typeof e.pageData?[]:e.pageData,d="undefined"==typeof e.modelsData?[]:e.modelsData;if(0==s.length)$defaultLayoutState.children(".section-targets").each(function(e,t){var r=$(t),n=isNaN(parseInt(r.attr("data-model-id")))?-1:parseInt(r.attr("data-model-id"));if(n!=-1)for(i=0;i<d.length;i++)if(n==d[i].id){for(a=0,o=d[i].customizations.length;a<o;a++)if("default"==d[i].customizations[a].name){r.text(JSON.stringify(d[i].customizations[a].targets));break}break}});else for($defaultLayoutState.children(".section-targets").remove(),t=0,r=s.length;t<r;t++){var l=$(document.createElement("div"));if(l.addClass("section-targets"),l.attr("data-section-rex-id",s[t].section_rex_id),l.attr("data-model-id",s[t].section_model_id),l.attr("data-model-number",s[t].section_model_number),l.attr("data-section-hide",s[t].section_hide),""==s[t].section_model_id||s[t].section_model_id==-1)l.text(JSON.stringify(s[t].targets));else if(s[t].section_model_id!=-1)for(i=0,n=d.length;i<n;i++)if(s[t].section_model_id==d[i].id){for(a=0,o=d[i].customizations.length;a<o;a++)if("default"==d[i].customizations[a].name){l.text(JSON.stringify(d[i].customizations[a].targets));break}break}l.appendTo($defaultLayoutState[0])}},_updateDefaultLayoutStateDOMOrder=function(e){var t=_getDefaultLayoutState();e=jQuery.extend(!0,[],e);var i,a,o,r,n,s,d=[];for(i=0,o=e.length;i<o;i++)if(e[i].modelID!=-1){for(s=!1,a=0,r=d.length;a<r;a++)if(d[a].id==e[i].modelID){d[a].number=d[a].number+1,e[i].modelNumber=d[a].number,s=!0;break}s||(d.push({id:e[i].modelID,number:1}),e[i].modelNumber=1)}var l,u=[];for(i=0,o=e.length;i<e;i++){for(a=0,n=t.length;a<n;a++)e[i].modelID!=-1?e[i].modelID==t[a].section_model_id&&e[i].modelNumber==t[a].section_model_number&&(l=t.splice(a,1)):e[i].rexID==t[a].section_rex_id&&(l=t.splice(a,1));u.push(l[0])}_updateDefaultLayoutState({pageData:u})},_updateDefaultLayoutStateSection=function(e,t){var i=e[0];t="undefined"==typeof t?-1:t,Rexbuilder_Dom_Util.fixModelNumbers();var a=Rex_Save_Listeners.createTargets(e,Rexbuilder_Util.activeLayout),o=!1;if(hasClass(i,"rex-model-section")){var r,n=i.getAttribute("data-rexlive-model-id"),s=i.getAttribute("data-rexlive-section-number"),d=[].slice.call($defaultLayoutState[0].getElementsByClassName("section-targets")),l=d.length;for(r=0;r<l;r++)n==d[r].getAttribute("data-model-id")&&(d[r].textContent=JSON.stringify(a),s==d[r].getAttribute("data-model-number")&&(o=!0))}else{var r,u=i.getAttribute("data-rexlive-section-id"),d=[].slice.call($defaultLayoutState[0].getElementsByClassName("section-targets")),l=d.length;for(r=0;r<l;r++)u==d[r].getAttribute("data-section-rex-id")&&(d[r].textContent=JSON.stringify(a),o=!0)}if(!o){var c={section_rex_id:i.getAttribute("data-rexlive-section-id"),section_is_model:!1,section_model_id:"",section_model_number:-1,section_hide:!1};c.section_hide=hasClass(i,"rex-hide-section"),hasClass(i,"rex-model-section")&&(c.section_is_model=!0,c.section_model_id=i.getAttribute("data-rexlive-model-id"),c.section_model_number=i.getAttribute("data-rexlive-model-number"));var _=document.createElement("div");addClass(_,"section-targets"),_.setAttribute("data-section-rex-id",c.section_rex_id),_.setAttribute("data-model-id",c.section_model_id),_.setAttribute("data-model-number",c.section_model_number),_.setAttribute("data-section-hide",c.section_hide),_.textContent=JSON.stringify(a);
var p=$(_);if(t==-1)p.appendTo($defaultLayoutState[0]);else{var m;t-=1,$defaultLayoutState.children(".section-targets").each(function(e,i){if(e==t)return m=$(i),!1}),m.after(p[0])}}},_getDefaultLayoutState=function(){var e=[];return $defaultLayoutState.children(".section-targets").each(function(t,i){var a=$(i),o=a.attr("data-section-rex-id"),r=isNaN(parseInt(a.attr("data-model-id")))?-1:parseInt(a.attr("data-model-id")),n=isNaN(parseInt(a.attr("data-model-number")))?-1:parseInt(a.attr("data-model-number")),s="undefined"!=typeof a.attr("data-section-hide")&&"1"==a.attr("data-section-hide").toString(),d=""!=a.text()?JSON.parse(a.text()):[];e.push({section_rex_id:o,section_model_id:r!=-1?r:"",section_model_number:n!=-1?n:"",section_is_model:r!=-1,section_hide:s,targets:d})}),e},_updateSectionOrderCustomLayouts=function(e,t){var i,a,o,r,n,s,d,l=Rexbuilder_Util.getPageCustomizationsDom();for(o=0,n=t.length;o<n;o++)if(t[o].rexID==e.rexID&&t[o].modelNumber==e.modelNumber&&t[o].modelID==e.modelID){a=o;break}for(o=0,s=l.length;o<s;o++){for(i=!1,r=0,d=l[o].sections.length;r<d;r++)if(l[o].sections[r].section_is_model){if(l[o].sections[r].section_model_id==e.modelID&&l[o].sections[r].section_model_number==e.modelNumber){"undefined"!=typeof l[o].sections[r].section_created_live&&"true"==l[o].sections[r].section_created_live.toString()&&(i=!0);break}}else if(e.rexID==l[o].sections[r].section_rex_id){"undefined"!=typeof l[o].sections[r].section_created_live&&"true"==l[o].sections[r].section_created_live.toString()&&(i=!0);break}if(i){var u=l[o].sections.splice(r,1)[0];l[o].sections.splice(a,0,u)}}Rexbuilder_Util.updatePageCustomizationsDomOrder(l)},_updateSectionStateLive=function(e){Rexbuilder_Dom_Util.fixModelNumbers();var t=Rex_Save_Listeners.createTargets(e,Rexbuilder_Util.activeLayout),i=!1;if(e.hasClass("rex-model-section")){var a=e.attr("data-rexlive-model-id");$liveDataContainer.children().each(function(e,o){var r=$(o);a==r.attr("data-model-id")&&(r.text(JSON.stringify(t)),i=!0)})}else{var o=e.attr("data-rexlive-section-id");$liveDataContainer.children().each(function(e,a){var r=$(a);o==r.attr("data-section-rex-id")&&(r.text(JSON.stringify(t)),i=!0)})}if(!i){var r={section_rex_id:e.attr("data-rexlive-section-id"),section_is_model:!1,section_model_id:"",section_model_number:-1,section_hide:!1};r.section_hide=e.hasClass("rex-hide-section"),e.hasClass("rex-model-section")&&(r.section_is_model=!0,r.section_model_id=e.attr("data-rexlive-model-id"),r.section_model_number=e.attr("data-rexlive-model-number"));var n=$(document.createElement("div"));n.addClass("section-targets"),n.attr("data-section-rex-id",r.section_rex_id),n.attr("data-model-id",r.section_model_id),n.attr("data-model-number",r.section_model_number),n.attr("data-section-hide",r.section_hide),n.text(JSON.stringify(t)),n.appendTo($liveDataContainer[0])}},_getGridLayoutLive=function(e){var t,i={layout:"fixed",fullHeight:!1,collapsed:!1};if(e.hasClass("rex-model-section")){var a=e.attr("data-rexlive-model-id");$liveDataContainer.children(".section-targets").each(function(e,i){var o=$(i);a==o.attr("data-model-id")&&(t=JSON.parse(o.text()))})}else{var o=e.attr("data-rexlive-section-id");$liveDataContainer.children(".section-targets").each(function(e,i){var a=$(i);o==a.attr("data-section-rex-id")&&(t=JSON.parse(a.text()))})}return i.layout=t[0].props.layout,i.fullHeight=t[0].props.full_height,i.collapsed=t[0].props.collapse_grid,i},_getLayoutSectionTargets=function(e,t){t="undefined"==typeof t?"default":t;var i,a,o,r,n,s,d=[];if(e.hasClass("rex-model-section")){var l=e.attr("data-rexlive-model-id"),u=_getModelsCustomizations();for(i=0,o=u.length;i<o;i++)if(u[i].id==l){for(a=0,r=u[i].customizations.length;a<r;a++)if(u[i].customizations[a].name==t){d=jQuery.extend(!0,[],u[i].customizations[a].targets);break}break}}else{var c=e.attr("data-rexlive-section-id"),_=_getPageCustomizations();for(i=0,n=_.length;i<n;i++)if(_[i].name==t&&"undefined"!=typeof _[i].sections){for(a=0,s=_[i].sections.length;a<s;a++)if(_[i].sections[a].section_rex_id==c){d=jQuery.extend(!0,[],_[i].sections[a].targets);break}break}}return d},_getDefaultBlockProps=function(e,t){var i,a,o=_getLayoutSectionTargets(e,"default"),r={};for(i=1,a=o.length;i<a;i++)if(o[i].name==t){r=jQuery.extend(!0,{},o[i].props);break}return r},_getGridLayout=function(e,t){t="undefined"==typeof t?"default":t;var i,a,o,r,n,s,d={layout:"fixed",fullHeight:!1,collapsed:!1};if(e.hasClass("rex-model-section")){var l=e.attr("data-rexlive-model-id"),u=_getModelsCustomizations();for(i=0,o=u.length;i<o;i++)if(u[i].id==l){for(a=0,r=u[i].customizations.length;a<r;a++)if(u[i].customizations[a].name==t){d.layout=u[i].customizations[a].targets[0].props.layout,d.fullHeight=u[i].customizations[a].targets[0].props.full_height,d.collapsed=u[i].customizations[a].targets[0].props.collapse_grid;break}break}}else{var c=e.attr("data-rexlive-section-id"),_=_getPageCustomizations();for(i=0,n=_.length;i<n;i++)if(_[i].name==t&&"undefined"!=typeof _[i].sections&&null!==typeof _[i].sections){for(a=0,s=_[i].sections.length;a<s;a++)if(_[i].sections[a].section_rex_id==c){0!=_[i].sections[a].targets.length&&(d.layout=_[i].sections[a].targets[0].props.layout,d.fullHeight=_[i].sections[a].targets[0].props.full_height,d.collapsed=_[i].sections[a].targets[0].props.collapse_grid);break}break}}return d},_customizationExists=function(e){var t,i,a=!1,o=$("#rexbuilder-layout-data .available-layouts-names"),r=[];for(""!=o.text()&&(r=JSON.parse(o.text())),t=0,i=r.length;t<i;t++)if(r[t]==e){a=!0;break}return a},updateSection=function(e,t,i,a){var o=e.children(".section-data"),r=isNaN(parseInt(i.video_bg_id))?"":parseInt(i.video_bg_id),n="undefined"==typeof i.video_bg_url_section?"":i.video_bg_url_section,s="undefined"==typeof i.video_bg_url_vimeo_section?"":i.video_bg_url_vimeo_section,d="";""!=r?d="mp4":""!=s?d="vimeo":""!=n&&(d="youtube");var l="undefined"!==i.custom_classes&&-1!==i.custom_classes.indexOf("rex-video--with-audio"),u={mp4Data:{idMp4:r,linkMp4:"undefined"==typeof i.video_mp4_url?"":i.video_mp4_url,width:"",height:""},vimeoUrl:s,youtubeUrl:n,audio:l,typeVideo:d};("1"!=_plugin_frontend_settings.fast_load||Rexbuilder_Util.editorMode)&&Rexbuilder_Dom_Util.updateSectionVideoBackground(e,u);var c={active:"undefined"==typeof i.image_bg_section_active||i.image_bg_section_active.toString(),idImage:isNaN(parseInt(i.id_image_bg_section))?"":parseInt(i.id_image_bg_section),urlImage:i.image_bg_section,width:parseInt(i.image_width),height:parseInt(i.image_height)},_={color:i.row_overlay_color,active:"undefined"!=typeof i.row_overlay_active&&i.row_overlay_active.toString()};("1"!=_plugin_frontend_settings.fast_load||Rexbuilder_Util.editorMode)&&Rexbuilder_Dom_Util.updateImageBG(e,c);var p={color:i.color_bg_section,active:"undefined"==typeof i.color_bg_section_active||i.color_bg_section_active.toString()};-1===p.color.indexOf("gradient")?Rexbuilder_Dom_Util.updateSectionBackgroundColor(e,p):Rexbuilder_Dom_Util.updateSectionBackgroundGradient(e,p),-1===_.color.indexOf("gradient")?Rexbuilder_Dom_Util.updateSectionOverlay(e,_):Rexbuilder_Dom_Util.updateSectionOverlayGradient(e,_);var m={top:isNaN(parseInt(i.row_margin_top))?0:parseInt(i.row_margin_top),right:isNaN(parseInt(i.row_margin_right))?0:parseInt(i.row_margin_right),bottom:isNaN(parseInt(i.row_margin_bottom))?0:parseInt(i.row_margin_bottom),left:isNaN(parseInt(i.row_margin_left))?0:parseInt(i.row_margin_left)};Rexbuilder_Dom_Util.updateSectionMarginsData(e,m),-1!==i.custom_classes.indexOf("rex-block-grid")&&(i.collapse_grid=!1,i.layout=o.attr("data-layout"));var g={gutter:i.block_distance,top:i.row_separator_top,bottom:i.row_separator_bottom,right:i.row_separator_right,left:i.row_separator_left,full_height:i.full_height,layout:i.layout,section_width:i.section_width,dimension:i.dimension,collapse_grid:"undefined"!=typeof i.collapse_grid&&("true"==i.collapse_grid.toString()||a)};Rexbuilder_Dom_Util.updateRow(e,o,t,g);var f="undefined"==typeof i.section_name?"":i.section_name;Rexbuilder_Dom_Util.updateSectionName(e,f),e.attr("data-type",i.type);var h="undefined"==typeof i.custom_classes?"":i.custom_classes,v=[];""!=h&&(h=h.trim(),v=h.split(/\s+/)),Rexbuilder_Dom_Util.updateCustomClasses(e,v);var y="undefined"!=typeof i.section_edited&&"true"==i.section_edited.toString();e.attr("data-rexlive-section-edited",y)},updateSectionTools=function(e,t,i,a){var o={top:isNaN(parseInt(i.row_margin_top))?0:parseInt(i.row_margin_top),right:isNaN(parseInt(i.row_margin_right))?0:parseInt(i.row_margin_right),bottom:isNaN(parseInt(i.row_margin_bottom))?0:parseInt(i.row_margin_bottom),left:isNaN(parseInt(i.row_margin_left))?0:parseInt(i.row_margin_left)};Rexbuilder_Section.fixSectionToolbox(e,o),-1!==i.custom_classes.indexOf("rex-block-grid")&&(i.collapse_grid=!1);var r={gutter:i.block_distance,top:i.row_separator_top,bottom:i.row_separator_bottom,right:i.row_separator_right,left:i.row_separator_left,full_height:i.full_height,layout:i.layout,section_width:i.section_width,dimension:i.dimension,collapse_grid:"undefined"!=typeof i.collapse_grid&&("true"==i.collapse_grid.toString()||a)};Rexbuilder_Section.fixBlockToolsAccordingToSeparator(e,r)},_updateElementDimensions=function(e,t,i){var a=parseInt(i.x),o=parseInt(i.y),r=parseInt(i.w),n=parseInt(i.h),s=parseInt(i.startH),d=(parseInt(i.increaseHeight),parseInt(i.realFluid));"undefined"!=typeof i.gridstackInstance?i.gridstackInstance.update(e,a,o,r,n):(e.setAttribute("data-gs-height",n),e.setAttribute("data-gs-width",r),e.setAttribute("data-gs-y",o),e.setAttribute("data-gs-x",a)),t.setAttribute("data-gs_start_h",s),t.setAttribute("data-gs_width",r),t.setAttribute("data-gs_height",n),t.setAttribute("data-gs_y",o),t.setAttribute("data-gs_x",a),t.setAttribute("data-element_real_fluid",d)},addPhotoSwipeElement=function(e,t,i,a,o){if(!e.parents(".grid-stack-item").hasClass("block-has-slider")){tmpl.arg="image";var r=e.parents(".grid-stack-item-content");if(0==e.parents(".pswp-figure").length){e.parent().prepend(tmpl("tmpl-photoswipe-block",{link:t,width:i,height:a,type:o}));var n=r.find(".pswp-item");e.detach().appendTo(n)}}},removePhotoSwipeElement=function(e){var t=e.parents(".pswp-figure");if(0!=t.length){var i=t.parent();e.detach().appendTo(i),t.remove()}},initPhotoSwipe=function(e){for(var t=function(e){for(var t,i,a,o,r=$(e).find(".pswp-figure").get(),n=r.length,s=[],d=0;d<n;d++)t=r[d],1===t.nodeType&&(i=t.children[0],a=i.getAttribute("data-size").split("x"),o={src:i.getAttribute("href"),w:parseInt(a[0],10),h:parseInt(a[1],10)},t.children.length>1&&(o.title=t.children[1].innerHTML),i.children.length>0&&(o.msrc=i.children[0].getAttribute("data-thumburl")),o.el=t,s.push(o));return s},i=function u(e,t){return e&&(t(e)?e:u(e.parentNode,t))},a=function(t){if(t=t||window.event,!($(t.target).parents(".perfect-grid-item").find(".element-link").length>0||$(t.target).is("a"))){t.preventDefault?t.preventDefault():t.returnValue=!1;var a=t.target||t.srcElement,o=i(a,function(e){return e.tagName&&"FIGURE"===e.tagName.toUpperCase()});if(o){for(var n,s=$(o).parents(e)[0],d=$(s).find(".pswp-figure").get(),l=d.length,u=0,c=0;c<l;c++)if(1===d[c].nodeType){if(d[c]===o){n=u;break}u++}return n>=0&&r(n,s),!1}}},o=function(){var e=window.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),a=0;a<i.length;a++)if(i[a]){var o=i[a].split("=");o.length<2||(t[o[0]]=o[1])}return t.gid&&(t.gid=parseInt(t.gid,10)),t},r=function(e,i,a,o){var r,n,s,d=document.querySelectorAll(".pswp")[0];if(s=t(i),n={galleryUID:i.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(e){var t=s[e].el.getElementsByClassName("pswp-item-thumb")[0],i=s[e].el.getElementsByClassName("rex-custom-scrollbar")[0],a=window.pageYOffset||document.documentElement.scrollTop,o=i.getBoundingClientRect(),r=t.getAttribute("data-thumb-image-type");return"natural"==r?{x:o.left,y:o.top+a,w:o.width}:null},closeOnScroll:!1,showHideOpacity:!0},o)if(n.galleryPIDs){for(var l=0,u=s.length;l<u;l++)if(s[l].pid==e){n.index=l;break}}else n.index=parseInt(e,10)-1;else n.index=parseInt(e,10);isNaN(n.index)||(a&&(n.showAnimationDuration=0),r=new PhotoSwipe(d,PhotoSwipeUI_Default,s,n),r.init())},n=document.querySelectorAll(e),s=0,d=n.length;s<d;s++)n[s].setAttribute("data-pswp-uid",s+1),n[s].onclick=a;var l=o();l.pid&&l.gid&&r(l.pid,n[l.gid-1],!0,!0)},_detect_mobile=function(){"ontouchstart"in document.documentElement?document.documentElement.className+=" touch":document.documentElement.className+=" no-touch"},_viewport=function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}},getYoutubeID=function(e){var t;return t=e.indexOf("youtu.be")>0?e.substr(e.lastIndexOf("/")+1,e.length):e.indexOf("http")>-1?e.match(/[\\?&]v=([^&#]*)/)[1]:e.length>15?null:e},_getQueryVariable=function(e){for(var t=window.location.search.substring(1),i=t.split("&"),a=0,o=i.length;a<o;a++){var r=i[a].split("=");if(r[0]==e)return r[1]}return!1},_checkPresentationPage=function(){return 0!==$(".rexpansive_portfolio_presentation").length},_checkStaticPresentationPage=function(){return 0!==$(".rexpansive-static-portfolio").length},_checkPost=function(){return 0!==$("#rex-article").length},_whichTransitionEvent=function(){var e,t=document.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in i)if(void 0!==t.style[e])return i[e]},_whichAnimationEvent=function(){var e,t=document.createElement("fakeelement"),i={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in i)if(void 0!==t.style[e])return i[e]},addWindowListeners=function(){Rexbuilder_Util.firstResize=!0;var e;Rexbuilder_Util.$window.on("resize",function(t){Rexbuilder_Util_Editor.elementIsResizing||(Rexbuilder_Util.windowIsResizing=!0,Rexbuilder_Util.firstResize&&(Rexbuilder_Util.firstResize=!1),loadWidth!==Rexbuilder_Util.viewport().width&&(clearTimeout(e),e=setTimeout(Rexbuilder_Util.doneResizing,1e3)))})},doneResizing=function(){if(Rexbuilder_Util.windowIsResizing=!0,Rexbuilder_Util.editorMode){if(!Rexbuilder_Util_Editor.changedLayout)return"default"===Rexbuilder_Util.chosenLayoutData.id&&_updateGridsHeights(),void(Rexbuilder_Util.windowIsResizing=!1);Rexbuilder_Util_Editor.changedLayout=!1;var e=_edit_dom_layout(Rexbuilder_Util_Editor.clickedLayoutID);0===e.collapse_needed?Rexbuilder_Util_Editor.endLoading():$(document).one("rexlive:collapsingElementsEnded",function(e){Rexbuilder_Util_Editor.endLoading()})}else{var t=_findFrontLayout();if(startFrontLayout!=t&&(Rexbuilder_Util.changedFrontLayout=!0,startFrontLayout=t,Rexbuilder_Util_Editor.startLoading()),Rexbuilder_Util.changedFrontLayout){var i=chooseLayout();_set_initial_grids_state(i),setTimeout(function(){var e=_edit_dom_layout(i);_updateGridsHeights(),Rexbuilder_Util.changedFrontLayout&&(0==e.collapse_needed?Rexbuilder_Util_Editor.endLoading():$(document).one("rexlive:collapsingElementsEnded",function(e){Rexbuilder_Util_Editor.endLoading()})),Rexbuilder_Util.changedFrontLayout=!1},300)}else{var e=(chooseLayout(),_edit_dom_layout(chooseLayout()));_updateGridsHeights()}}Rexbuilder_Util.windowIsResizing=!1,Rexbuilder_Util.firstResize=!0,loadWidth=Rexbuilder_Util.viewport().width},_set_initial_grids_state=function(e){if(e="undefined"!=typeof e?e:"default",Rexbuilder_Util.rexContainer){var t,i=[].slice.call(Rexbuilder_Util.rexContainer.getElementsByClassName("rexpansive_section")),a=i.length;for(t=0;t<a;t++){for(var o=$(i[t]),r=o.find(".grid-stack-row"),n=r.data().plugin_perfectGridGalleryEditor,s=Rexbuilder_Util.getSectionCustomLayouts(i[t].getAttribute("data-rexlive-section-id")),d=null,l=null,u=0;u<s.length;u++){if("default"===s[u].name&&(l=u),s[u].name===e){d=u;break}u==s.length-1&&(d=l)}for(var c=[],u=0,_=s[d].targets.length;u<_;u++)if("self"!==s[d].targets[u].name){var p={};p.el=o.find(".perfect-grid-item[data-rexbuilder-block-id="+s[d].targets[u].name+"]"),p.x=parseInt(s[d].targets[u].props.gs_x),p.y=parseInt(s[d].targets[u].props.gs_y),p.width=parseInt(s[d].targets[u].props.gs_width),p.height=parseInt(s[d].targets[u].props.gs_height),c.push(p)}n.set_grid_initial_state(c)}}},_updateGridsHeights=function(){if(Rexbuilder_Util.rexContainer){var e,t,i,a=[].slice.call(Rexbuilder_Util.rexContainer.getElementsByClassName("grid-stack-row")),o=a.length;for(e=0;e<o;e++){t=$(a[e]),i=t.data().plugin_perfectGridGalleryEditor,void 0!==i&&(i.batchGridstack(),i._defineDynamicPrivateProperties(),i.updateGridstackStyles(),i.setFullWidthNaturalBackground(),i.setNaturalBackground(),i.updateBlocksHeight(),i.fixVideoProportion(),i.commitGridstack());var r=jQuery.Event("rexlive:updateGridsHeights");r.settings={$row:t},Rexbuilder_Util.$document.trigger(r)}}},_stopBlockVideos=function(e){_stopVideo(e.find(".grid-item-content"))},_playBlockVideos=function(e){_playVideoFromBegin(e.find(".grid-item-content"))},_stopPluginsSection=function(e){var t=e.find(".mp4-player"),i=e.find(".vimeo-player"),a=e.find(".youtube-player");$.each(t,function(e,t){Rexbuilder_Util.stopVideo($(t))}),$.each(i,function(e,t){Rexbuilder_Util.stopVideo($(t))}),$.each(a,function(e,t){Rexbuilder_Util.stopVideo($(t))})},_playPluginsSection=function(e){var t=e.find(".mp4-player"),i=e.find(".vimeo-player"),a=e.find(".youtube-player");("1"!=_plugin_frontend_settings.fast_load||Rexbuilder_Util.editorMode)&&$.each(t,function(e,t){Rexbuilder_Util.playVideoFromBegin($(t))}),$.each(i,function(e,t){Rexbuilder_Util.playVideoFromBegin($(t))}),$.each(a,function(e,t){Rexbuilder_Util.playVideoFromBegin($(t))})},_stopVideo=function(e){if(e.hasClass("mp4-player")){var t=e.children(".rex-video-wrap").find("video")[0];t.currentTime=0,t.pause()}else if(e.hasClass("vimeo-player"))VimeoVideo.findVideo(e.children(".rex-video-vimeo-wrap").find("iframe")[0]).unload();else if(e.hasClass("youtube-player")){if(void 0===e.children(".rex-youtube-wrap").YTPGetPlayer())return;e.children(".rex-youtube-wrap").YTPStop()}},_fixVideosAudioSection=function(e){var t=e.find(".mp4-player"),i=e.find(".vimeo-player"),a=e.find(".youtube-player");Rexbuilder_Util.fixVideoAudio(e),$.each(t,function(e,t){Rexbuilder_Util.fixVideoAudio($(t))}),$.each(i,function(e,t){Rexbuilder_Util.fixVideoAudio($(t))}),$.each(a,function(e,t){Rexbuilder_Util.fixVideoAudio($(t))})},_fixYoutube=function(e){var t=e.find(".rex-youtube-wrap");$.each(t,function(e,t){var i=$(t),a=i.parents(".youtube-player").eq(0).children(".rex-video-toggle-audio"),o=i.YTPGetPlayer();void 0!==o&&(i.optimizeDisplay(),i.YTPPlay(),0==a.length||a.hasClass("user-has-muted")?(o.mute(),o.isMute=!0,o.setVolume(0)):i.YTPUnmute())})},_fixVideoAudio=function(e){var t=e.children("rex-video-toggle-audio");if(e.hasClass("mp4-player")){var i=e.children(".rex-video-wrap").find("video")[0];0==t.length||t.hasClass("user-has-muted")?$(i).prop("muted",!0):$(i).prop("muted",!1)}else if(e.hasClass("vimeo-player")){var a=VimeoVideo.findVideo(e.children(".rex-video-vimeo-wrap").find("iframe")[0]);0==t.length||t.hasClass("user-has-muted")?a.setVolume(0):a.setVolume(1)}else if(e.hasClass("youtube-player")){var o=e.children(".rex-youtube-wrap"),r=o.YTPGetPlayer();void 0!==r&&(0==t.length||t.hasClass("user-has-muted")?(r.mute(),r.isMute=!0,r.setVolume(0)):o.YTPUnmute())}},_playVideoFromBegin=function(e){if(e.hasClass("mp4-player")){var t=e.children(".rex-video-wrap").find("video")[0];t.currentTime=0,t.play()}else if(e.hasClass("vimeo-player")){var i=VimeoVideo.findVideo(e.children(".rex-video-vimeo-wrap").find("iframe")[0]);null!==i&&i.play()}else if(e.hasClass("youtube-player")){var a=e.children(".rex-youtube-wrap");if(0==a.length)return;var o=a.YTPGetPlayer();if(void 0===o)return;a.YTPPlay()}setTimeout(function(){Rexbuilder_Util.fixVideoAudio(e)},500,e)},_destroyVideoPlugins=function(){},_launchVideoPlugins=function(){jQuery.browser.mobile?Rexbuilder_Util.$rexContainer.find(".rex-youtube-wrap").each(function(i,el){var $this=$(el),data_yt=eval("("+$this.attr("data-property")+")"),url=data_yt.videoURL,id=getYoutubeID(url);$this.css("background-image","url(http://img.youtube.com/vi/"+id+"/0.jpg)"),$this.click(function(e){e.preventDefault(),window.location.href=url})}):Rexbuilder_Util.$rexContainer.find(".rex-youtube-wrap").each(function(e,t){var i=$(t);return void 0!==i.YTPGetPlayer()||i.hasClass("youtube-player-launching")?void i.removeClass("youtube-player-launching"):void i.YTPlayer()}),VimeoVideo.init()},setContainer=function(e){this.$rexContainer=e},_has_class=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},_add_class=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},_remove_class=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},_parents=function(e,t){for(;e.parentNode;){if(_matches(e,t))return e;e=e.parentNode}return null},_matches=function(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)},_transitionEvent="",_animationEvent="",_scroll_timing=600,_getGalleryInstance=function(e){return e.find(".grid-stack-row").data().plugin_perfectGridGalleryEditor},removeCollapsedGrids=function(){if(Rexbuilder_Util.rexContainer){var e,t=[].slice.call(Rexbuilder_Util.rexContainer.getElementsByClassName("rexpansive_section")),i=t.length;for(e=0;e<i;e++)if(Rexbuilder_Util.galleryPluginActive){var a=_getGalleryInstance($(t[e]));Rexbuilder_Dom_Util.collapseGrid(a,!1,a.properties.dispositionBeforeCollapsing,a.properties.layoutBeforeCollapsing)}}},collapseAllGrids=function(){if(Rexbuilder_Util.rexContainer){var e,t=[].slice.call(Rexbuilder_Util.rexContainer.getElementsByClassName("rexpansive_section")),i=t.length;for(e=0;e<i;e++)if(Rexbuilder_Util.galleryPluginActive){var a=_getGalleryInstance($(t[e]));a._defineDynamicPrivateProperties(),a.collapseElements()}}},_startVideoPlugin=function(e){if(e.hasClass("mp4-player"));else if(e.hasClass("vimeo-player")){var t=e.children(".rex-video-vimeo-wrap").find("iframe")[0],i={autoplay:!0,background:!0,loop:!0};VimeoVideo.addPlayer("1",t,i)}else e.hasClass("youtube-player")&&void 0===e.children(".rex-youtube-wrap").YTPGetPlayer()&&e.children(".rex-youtube-wrap").YTPlayer()},_destroyVideo=function(e,t){var i="";return e.hasClass("mp4-player")?(i="mp4",Rexbuilder_Dom_Util.removeMp4Video(e,t)):e.hasClass("vimeo-player")?(i="vimeo",Rexbuilder_Dom_Util.removeVimeoVideo(e,t)):e.hasClass("youtube-player")&&(i="youtube",Rexbuilder_Dom_Util.removeYoutubeVideo(e,t)),i},_pauseVideo=function(e){if(e.hasClass("mp4-player"))e.children(".rex-video-wrap").find("video")[0].pause();else if(e.hasClass("vimeo-player")){var t=VimeoVideo.findVideo(e.find(".rex-video-vimeo-wrap").find("iframe")[0]);t.pause()}else if(e.hasClass("youtube-player")){if(void 0===e.children(".rex-youtube-wrap").YTPGetPlayer())return;e.children(".rex-youtube-wrap").YTPPause()}},_playAllVideos=function(){Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(e,t){var i=$(t),a=i.find(".mp4-player"),o=i.find(".vimeo-player"),r=i.find(".youtube-player");("1"!=_plugin_frontend_settings.fast_load||Rexbuilder_Util.editorMode)&&$.each(a,function(e,t){Rexbuilder_Util.playVideo($(t))}),$.each(o,function(e,t){Rexbuilder_Util.playVideo($(t))}),$.each(r,function(e,t){Rexbuilder_Util.playVideo($(t))}),Rexbuilder_Util.playVideo(i)})},_playVideo=function(e){if(e.hasClass("mp4-player")){var t=e.find("video")[0];t&&t.play()}else if(e.hasClass("vimeo-player")){var i=VimeoVideo.findVideo(e.find("iframe")[0]);i&&i.play()}else if(e.hasClass("youtube-player")){if(0==e.children(".rex-youtube-wrap").length)return;if(void 0===e.children(".rex-youtube-wrap").YTPGetPlayer())return;e.children(".rex-youtube-wrap").YTPPlay()}},_getBackgroundUrlFromCss=function(e){return e.replace("url(","").replace(")","").replace(/\"/gi,"")},_getPaddingsDataString=function(e){var t={top:"5",right:"5",bottom:"5",left:"5",type:"px"};if(""!=e){var i=e.split(/;/gm);t.top=parseInt(i[0].split(/\D+/gm)[0]),t.right=parseInt(i[1].split(/\D+/gm)[0]),t.bottom=parseInt(i[2].split(/\D+/gm)[0]),t.left=parseInt(i[3].split(/\D+/gm)[0]);var a="";a=i[0].indexOf("%")!=-1?"%":"px",t.type=a}return t},_paddingsToString=function(e){var t="";return t+=""+e.top+e.type+";",t+=""+e.right+e.type+";",t+=""+e.bottom+e.type+";",t+=""+e.left+e.type+";"},getCoord=function(e,t){return t="undefined"!=typeof t?t:12,{x:e%t,y:Math.floor(e/t)}},_diffStrings=function(e,t){t="undefined"!=typeof t?t:" ";for(var i=e.join(" "),a=i.split(t),o={},r=[],n=0,s=a.length;n<s;n++)o[a[n]]="undefined"!=typeof o[a[n]]?o[a[n]]+1:1;for(var d in o)1===o[d]&&r.push(d);return r},init=function(){if(this.firstStart=!0,_plugin_frontend_settings.scroll_animation_offset=0,_plugin_frontend_settings.user.logged&&_plugin_frontend_settings.user.editing)this.editorMode=!0;else{this.editorMode=!1,Rexbuilder_Util.changedFrontLayout=!1;var e=$("#layout-avaiable-dimensions");frontAvailableLayouts=e.length>0?JSON.parse(e.text()):[],startFrontLayout=_findFrontLayout()}this.$window=$(window),this.$document=$(document),this.$body=$("body"),$modelsCustomizationsDataDiv=$("#rexbuilder-model-data").children(".models-customizations").eq(0),$pageCustomizationsDataDiv=$("#rexbuilder-layout-data").children(".layouts-customizations").eq(0),$liveDataContainer=$("#rexbuilder-layout-data-live"),$layoutsDomOrder=$("#rexbuilder-layouts-sections-order"),$defaultLayoutState=$("#rexbuilder-default-layout-state"),$usedIDSContainer=$("#sections-ids-used"),_storeNamesUsed(),this.$rexContainer=$(".rex-container"),this.rexContainer=this.$rexContainer[0],this.$loader=$(".rexlive-loader"),this.backendEdited=!1,Rexbuilder_Util.$rexContainer.length>0&&"true"==Rexbuilder_Util.$rexContainer.attr("data-backend-edited").toString()&&(Rexbuilder_Util.$rexContainer.addClass("backend-edited"),this.backendEdited=!0),this.lastSectionNumber=-1,this.activeLayout="",this.domUpdaiting=!1;var t=this.$rexContainer.children(".rexpansive_section").eq(0).attr("data-rex-collapse-grid");this.blockGridUnder768="undefined"!=typeof t&&"false"==t.toString(),this.chosenLayoutData=null,_updateSectionsID(),Rexbuilder_Dom_Util.fixModelNumbers();var i=chooseLayout();_edit_dom_layout(i),_updateSectionsNumber(),_detect_mobile(),this._transitionEvent=_whichTransitionEvent(),this._animationEvent=_whichAnimationEvent(),this.scrollbarProperties={className:"os-theme-dark",overflowBehavior:{x:"hidden"},autoUpdate:!1},this.galleryPluginActive=!1,this.firstStart=!1,Rexbuilder_Util.changedFrontLayout=!1,loadWidth=Rexbuilder_Util.viewport().width};return{init:init,viewport:_viewport,getYoutubeID:getYoutubeID,transitionEvent:_transitionEvent,animationEvent:_animationEvent,getQueryVariable:_getQueryVariable,checkPresentationPage:_checkPresentationPage,checkStaticPresentationPage:_checkStaticPresentationPage,checkPost:_checkPost,scroll_timing:_scroll_timing,fixSectionWidth:fixSectionWidth,editorMode:editorMode,windowIsResizing:windowIsResizing,firstResize:firstResize,addWindowListeners:addWindowListeners,launchVideoPlugins:_launchVideoPlugins,destroyVideoPlugins:_destroyVideoPlugins,stopPluginsSection:_stopPluginsSection,playPluginsSection:_playPluginsSection,stopBlockVideos:_stopBlockVideos,playBlockVideos:_playBlockVideos,chooseLayout:chooseLayout,predictLayout:predictLayout,setContainer:setContainer,createSectionID:_createSectionID,createBlockID:createBlockID,has_class:_has_class,responsiveLayouts:responsiveLayouts,defaultLayoutSections:defaultLayoutSections,edit_dom_layout:_edit_dom_layout,smoothScroll:_smoothScroll,getGalleryInstance:_getGalleryInstance,removeCollapsedGrids:removeCollapsedGrids,collapseAllGrids:collapseAllGrids,stopVideo:_stopVideo,playVideoFromBegin:_playVideoFromBegin,pauseVideo:_pauseVideo,playVideo:_playVideo,destroyVideo:_destroyVideo,startVideoPlugin:_startVideoPlugin,getBackgroundUrlFromCss:_getBackgroundUrlFromCss,getPaddingsDataString:_getPaddingsDataString,paddingsToString:_paddingsToString,playAllVideos:_playAllVideos,findLayoutType:_findLayoutType,updateModelsLive:_updateModelsLive,getLayoutSectionTargets:_getLayoutSectionTargets,updateElementDimensions:_updateElementDimensions,getGridLayout:_getGridLayout,customizationExists:_customizationExists,getDefaultBlockProps:_getDefaultBlockProps,fixVideosAudioSection:_fixVideosAudioSection,fixVideoAudio:_fixVideoAudio,fixYoutube:_fixYoutube,getModelsCustomizations:_getModelsCustomizations,updateModelsCustomizationsData:_updateModelsCustomizationsData,getPageCustomizations:_getPageCustomizations,updatePageCustomizationsData:_updatePageCustomizationsData,updatePageAvaiableLayoutsNames:_updatePageAvaiableLayoutsNames,getPageAvaiableLayoutsNames:_getPageAvaiableLayoutsNames,updateDivModelCustomizationsNames:_updateDivModelCustomizationsNames,getSectionCustomLayouts:_getSectionCustomLayouts,getLayoutLiveSectionTargets:_getLayoutLiveSectionTargets,getGridLayoutLive:_getGridLayoutLive,updateSectionStateLive:_updateSectionStateLive,updatePageCustomizationsDomOrder:_updatePageCustomizationsDomOrder,getPageCustomizationsDom:_getPageCustomizationsDom,updateDefaultLayoutState:_updateDefaultLayoutState,updateDefaultLayoutStateSection:_updateDefaultLayoutStateSection,updateDefaultLayoutStateDOMOrder:_updateDefaultLayoutStateDOMOrder,getDefaultLayoutState:_getDefaultLayoutState,updateSectionOrderCustomLayouts:_updateSectionOrderCustomLayouts,updateGridsHeights:_updateGridsHeights,getSectionNamesUsed:_getSectionNamesUsed,saveSectionNamesUsed:_saveSectionNamesUsed,addSectionID:_addSectionID,removeSectionID:_removeSectionID,createRandomID:createRandomID,updateDOMSingleElement:_updateDOMSingleElement,getDefaultBlockMeasure:_getDefaultBlockMeasure,doneResizing:doneResizing,getCoord:getCoord,diffStrings:_diffStrings,applyDefaultBlocksDimentions:_applyDefaultBlocksDimentions,isMobile:_isMobile,cssPropertyValueSupported:_cssPropertyValueSupported,changedFrontLayout:changedFrontLayout,hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,rtimeOut:rtimeOut,rInterval:rInterval}}(jQuery);
var RexSlider=function(e){"use strict";function t(e){var t=this,i=this.element.getAttribute("data-custom-autoplay-timer")?this.element.getAttribute("data-custom-autoplay-timer"):9e3;t.customAutoplayInterval&&t.customAutoplayInterval.clear(),t.customAutoplayInterval=Rexbuilder_Util.rtimeOut(function(){t.playPlayer()},i),t.pausePlayer()}var i=".rex-slider-wrap",a=".rex-slider-element",r=".flickity-page-dots.rex-slider__custom-nav",n=".rexpansive_section",l=".rex-box-slider-wrap",d=".rex-box-slider-element",s=function(i){var n={cellAlign:"left",prevNextButtons:!1,pageDots:!1,cellSelector:a,selectedAttraction:.018,friction:.3,wrapAround:!0,arrowShape:"M 71.080084,1.034481 C 71.763642,0.34482599 72.61809,-1.250001e-8 73.557983,-1.250001e-8 c 0.939893,0 1.794341,0.34482600250001 2.477899,1.03448101250001 1.367117,1.37931 1.367117,3.620689 0,5 L 32.459031,49.999998 76.035882,93.965515 c 1.367117,1.379311 1.367117,3.62069 0,5 -1.367117,1.379315 -3.588681,1.379315 -4.955798,0 L 25.025333,52.499998 c -1.367117,-1.37931 -1.367117,-3.62069 0,-5 l 46.054751,-46.465517 0,0 z"},l=i.parents(".block-has-slider");n.setGallerySize="undefined"!=typeof i.attr("data-set-gallery-size")&&JSON.parse(i.attr("data-set-gallery-size")),n.wrapAround="undefined"==typeof i.attr("data-wrap-around")||JSON.parse(i.attr("data-wrap-around"));var d=i.attr("data-rex-slider-animation");"undefined"!=typeof d&&"true"==d.toString()?n.autoPlay=!0:n.autoPlay=!1;var s=i.attr("data-rex-slider-prev-next");"undefined"!=typeof s&&"1"==s.toString()&&(n.prevNextButtons=!0);var o=i.attr("data-rex-slider-dots");if("undefined"!=typeof o&&"1"==o.toString()&&(n.pageDots=!0),i.hasClass("rex-slider--bottom-interface")&&l.addClass("block-has-slider--navigator"),i.find(".rex-slider-element").each(function(t,i){var a=e(i).find(".rex-slider-video-wrapper");Rexbuilder_Util.startVideoPlugin(a)}),1==n.setGallerySize&&(n.on={ready:function(e){var t=this.$element.parents(".rexpansive_section").eq(0);if(t.length>0){var i=Rexbuilder_Util.getGalleryInstance(t);"undefined"!==i&&i.updateElementHeight(this.$element.parents(".grid-stack-item")[0])}}}),n.prevNextButtons&&l.hasClass("custom-autoplay")&&(n.pauseAutoPlayOnHover=!1),i.flickity(n),i.flickity("stopPlayer"),Rexbuilder_Util.$window.on("resize",function(){i.data("flickity")&&i.flickity("resize")}),i.on("dragStart.flickity",function(){e(this).addClass("is-dragging")}),i.on("dragEnd.flickity",function(){e(this).removeClass("is-dragging")}),i.on("select.flickity",function(t,i){var a=e(t.target),r=a.find(".rex-slider-element.is-selected .rex-slider-video-wrapper");a.find(".rex-slider-video-wrapper").each(function(t,i){i!=r[0]&&Rexbuilder_Util.pauseVideo(e(i))}),Rexbuilder_Util.playVideo(r)}),n.autoPlay&&i.flickity("playPlayer"),n.prevNextButtons&&l.hasClass("custom-autoplay")){var c=i.data("flickity");c.customAutoplayInterval,c.prevButton.element.addEventListener("click",t.bind(c)),c.nextButton.element.addEventListener("click",t.bind(c)),c.$element.on("dragEnd.flickity",t.bind(c))}i.attr("data-rex-slider-active",!0),i.find(r).children().first().addClass("is-selected"),i.find(r).on("click",".dot",function(t){var a=e(this),r=a.index();a.addClass("is-selected").siblings(".dot").removeClass("is-selected"),i.flickity("select",r)})},o=function(t){var i={cellAlign:"center",prevNextButtons:!0,pageDots:!0,cellSelector:d,selectedAttraction:.018,friction:.3,initialIndex:"undefined"!=typeof e(t).attr("data-rex-box-slider-initialIndex")?parseInt(e(t).attr("data-rex-box-slider-initialIndex")):0,setGallerySize:!1,arrowShape:"m 38.79662,40.087413 0,0 c -0.387529,0 -0.757576,-0.154429 -1.031468,-0.425408 L 1.2470862,3.1322842 c -0.56818177,-0.5681815 -0.56818177,-1.4918411 0,-2.060023 0.5681819,-0.56818197 1.4918415,-0.56818197 2.0600234,0 L 38.793706,36.570513 74.294872,1.0722612 c 0.568182,-0.56818197 1.491842,-0.56818197 2.060023,0 0.568182,0.5681819 0.568182,1.4918415 0,2.060023 L 39.825175,39.659091 c -0.273893,0.273893 -0.641026,0.428322 -1.028555,0.428322 l 0,0 0,0 z"},a=e(t).attr("data-rex-slider-animation");"undefined"!=typeof a&&"true"==a&&(i.autoPlay=!0),e(t).flickity(i),e(t).flickity("stopPlayer"),Rexbuilder_Util.$window.on("resize",function(){e(t).flickity("resize")}),e(t).on("dragStart.flickity",function(){e(this).addClass("is-dragging")}),e(t).on("dragEnd.flickity",function(){e(this).removeClass("is-dragging")})},c=function(){e(i,n).length>0&&e(i,n).each(function(t,i){RexSlider.initSlider(e(i)),e(i).attr("data-rex-slider-number",t),Rexbuilder_Dom_Util.lastSliderNumber=t}),e(l,n).length>0&&e(l,n).each(function(e,t){o(t)})},u=function(t){"undefined"!=typeof t.data("flickity")&&t.flickity("destroy"),t.find(".rex-slider-video-wrapper").each(function(t,i){Rexbuilder_Util.destroyVideo(e(i),!1)})},f=function(){e(i,n).length>0&&e(i,n).each(function(t,i){u(e(i))}),e(l,n).length>0&&e(l,n).each(function(t,i){u(e(i))})},y=function(){e(i,n).length&&e(i,n).each(function(t,i){var a=e(i).attr("data-rex-slider-animation");"undefined"!=typeof a&&"true"==a&&e(i).flickity("playPlayer")})},p=function(){c()};return{init:p,initSlider:s,startAutoPlay:y,destroy:f,destroySliderPlugins:u}}(jQuery);
/**
 * JS object to fix CF7 forms if user wants some materialize style
 */
var Rexbuilder_FormFixes=function(e){"use strict";var c,n=function(){c=e(".wpcf7-form")},i=function(){c.each(function(c,n){var i=e(n);i.hasClass("rxcf7-custom-checkbox")&&(i.find(".wpcf7-checkbox").each(function(c,n){e(n).find("label").length>0&&0==e(n).find(".rex-checkbox__indicator").length&&e(n).find("input[type=checkbox]").after('<span class="rex-checkbox__indicator"></span>')}),i.find(".wpcf7-acceptance").each(function(c,n){e(n).find("label").length>0&&0==e(n).find(".rex-checkbox__indicator").length&&e(n).find("input[type=checkbox]").after('<span class="rex-checkbox__indicator"></span>')})),i.hasClass("rxcf7-custom-loader")&&0==i.find(".sk-double-bounce").length&&i.find(".ajax-loader").append('<div class="sk-double-bounce"><div class="sk-child sk-double-bounce1"></div><div class="sk-child sk-double-bounce2"></div></div>')})},t=function(){document.addEventListener("wpcf7submit",function(c){var n=e(c.srcElement).parents(".perfect-grid-gallery");n.length>0&&setTimeout(function(){n.perfectGridGallery("refreshGrid")},200)},!1)},a=function(){n(),t(),i()};return{init:a}}(jQuery);
var VimeoVideo=function(e){"use strict";var i=null,o=null,n=function(){i=Rexbuilder_Util.$rexContainer.find(".rex-video-vimeo-wrap--section"),o=Rexbuilder_Util.$rexContainer.find(".rex-video-vimeo-wrap--block")},t=function(){i.length>0&&i.each(function(i,o){var n=e(o).find("iframe")[0];if("undefined"!=typeof Vimeo){var t=new Vimeo.Player(n);t.ready().then(function(){t.setVolume(0)})}})},r=function(i){var n=i;o.length>0&&o.each(function(i,o){var t=e(o).attr("data-vimeo-video-mute"),r=e(o).find("iframe")[0];"undefined"!=typeof Vimeo&&n.addPlayer(t,r)})},l=function(e,i,o){if("undefined"!=typeof this.blockVideos){var n;n="undefined"!=typeof o?new Vimeo.Player(i,o):new Vimeo.Player(i),"1"==e&&n.ready().then(function(){n.setVolume(0)});var t={el:i,player:n};this.blockVideos.push(t)}},d=function(e){if(void 0!==this.blockVideos)for(var i=0,o=this.blockVideos.length;i<o;i++)if(this.blockVideos[i].el===e)return this.blockVideos[i].player;return null},a=function(e){var i,o=!1;for(i=0,tot_blockVideos=this.blockVideos.length;i<tot_blockVideos;i++)if(this.blockVideos[i].el===e){this.blockVideos[i].player.destroy().then(function(){})["catch"](function(e){}),o=!0;break}o&&this.blockVideos.splice(i,1)},c=function(){this.blockVideos=[],n(),t(),r(this)};return{init:c,findVideo:d,initBlockVideos:r,addPlayer:l,removePlayer:a}}(jQuery);
// var lodash = _.noConflict();
var Rexbuilder_App=function(e){"use strict";function t(){var t,i=this.element.querySelector(".perfect-grid-gallery"),n=e(i);for(t=0;t<this.totScrollEls;t++)this.scrollEls[t].style.height=this.scrollEls[t].offsetHeight+"px";for(t=0;t<this.totOpacityEls;t++)this.opacityEls[t].style.height=this.opacityEls[t].offsetHeight+"px";n.data("plugin_perfectGridGalleryEditor").destroyGridGallery(),i.style.height=""}var i=null,n=null,r=null,o=[],l={},a=function(){var e=[].slice.call(document.getElementsByClassName("rex-button-wrapper")),t=e.length,i=0;for(i=0;i<t;i++){var n=e[i].querySelector(".rex-button-container");if(!n){var r=document.createElement("span");r.className="rex-button-container";var o=e[i].querySelector(".rex-button-background");o.parentNode.insertBefore(r,o),r.appendChild(o)}}},s=function(){function t(t){var i=e(t.target),n=i.parents(".youtube-player").eq(0).children(".rex-video-toggle-audio"),r=i.YTPGetPlayer();void 0!==r&&(i.optimizeDisplay(),0==n.length||n.hasClass("user-has-muted")?(r.mute(),r.isMute=!0,r.setVolume(0)):i.YTPUnmute())}function i(t){var i=e(t.target).parents(".rex-youtube-wrap");if(i.length>0){var n=i[0].state;1==n?i.YTPPause():i.YTPPlay()}}function n(t){var i=e(this).find(".grid-item-content"),n=i.children(".rex-youtube-wrap"),r=i.children(".rex-video-vimeo-wrap--block"),o=i.children(".rex-video-wrap");if(n.length>0){var l=n[0].state;1==l?n.YTPPause():n.YTPPlay()}if(r.length>0){var a=VimeoVideo.findVideo(r.find("iframe")[0]);a&&a.getPaused().then(function(e){e?a.play():a.pause()})["catch"](function(e){})}if(o.length>0){var s=o.find(".rex-video-container").get(0);s.paused?s.play():s.pause()}}function r(t){t.stopPropagation();var i=e(this),n=i.parents(".youtube-player").eq(0).children(".rex-youtube-wrap"),r=i.parents(".mp4-player").eq(0).find(".rex-video-container"),o=i.parents(".vimeo-player").eq(0).find(".rex-video-vimeo-wrap--block");if(n.length>0){var l=n.get(0).player.isMuted();l?(n.YTPUnmute(),i.removeClass("user-has-muted")):(n.YTPMute(),i.addClass("user-has-muted"))}if(r.length>0&&(r.prop("muted")?(r.prop("muted",!1),i.removeClass("user-has-muted")):(r.prop("muted",!0),i.addClass("user-has-muted"))),o.length>0){var a=VimeoVideo.findVideo(o.find("iframe")[0]);a&&a.getVolume().then(function(e){0==e?(a.setVolume(1),i.removeClass("user-has-muted")):(a.setVolume(0),i.addClass("user-has-muted"))})["catch"](function(e){})}}function o(t){var i=e(t.currentTarget),n=i.parent().children(".play"),r=i.parents(".rexpansive_section");i.removeClass("video-tool--view"),n.addClass("video-tool--view"),Rexbuilder_Util.pauseVideo(r)}function l(t){var i=e(t.currentTarget),n=i.parent().children(".pause"),r=i.parents(".rexpansive_section");i.removeClass("video-tool--view"),n.addClass("video-tool--view"),Rexbuilder_Util.playVideo(r)}Rexbuilder_Util.$document.on("YTPStart",t),Rexbuilder_Util.$document.on("click",".YTPOverlay",i),Rexbuilder_Util.$document.on("click",".block-has-slider",n),Rexbuilder_Util.$document.on("click",".rex-video-toggle-audio",r),Rexbuilder_Util.$document.on("click",".rex-video__controls .pause",o),Rexbuilder_Util.$document.on("click",".rex-video__controls .play",l)},d=function(){if("undefined"!=typeof StickySection){var e=!(Rexbuilder_Util.cssPropertyValueSupported("position","sticky")||Rexbuilder_Util.cssPropertyValueSupported("position","-webkit-sticky")),t=[].slice.call(document.getElementsByClassName("sticky-section")),i=t.length,n=0,r="",o=!1;for(n=0;n<i;n++){if(Rexbuilder_Util.has_class(t[n],"mp4-player"))r=".rex-video-wrap";else if(""!==t[n].style.backgroundImage){r=".sticky-background-simulator";var l=t[n].querySelector(".responsive-overlay");l.insertAdjacentHTML("beforebegin",'<div class="sticky-background-simulator"></div>');var a=t[n].querySelector(".sticky-background-simulator");a.style.backgroundImage=t[n].style.backgroundImage}else if(Rexbuilder_Util.has_class(t[n],"section-w-image")){r=".sticky-background-simulator";var l=t[n].querySelector(".responsive-overlay");l.insertAdjacentHTML("beforebegin",'<div class="sticky-background-simulator"></div>');var a=t[n].querySelector(".sticky-background-simulator");a.style.backgroundImage="url("+t[n].querySelector(".section-data").getAttribute("data-image_bg_section")+")"}o="true"===t[n].querySelector(".section-data").getAttribute("data-row_overlay_active");new StickySection(t[n],{borderAnimation:!0,stickyJS:e,stickyElementSelector:r,overlayAnimation:o})}}},c=function(){if("undefined"!=typeof ScrollCSSAnimation){var e=[].slice.call(document.getElementsByClassName("fadeUpTextCSS")),t=e.length,i=0;for(i=0;i<t;i++){new ScrollCSSAnimation(e[i],{offset:.75})}}},u=function(){if("undefined"!=typeof DistanceAccordion)for(var e=document.getElementsByClassName("distance-accordion-toggle"),t=0,i=e.length;t<i;t++){new DistanceAccordion(e[t])}},p=function(){var i=e(this.target),r=i.find(".grid-stack-row"),o=i.find(".rexpansive_section"),a=i.find(".rex-accordion"),s=n.length;if(o.length>0){var d,c=o.length;for(d=0;d<c;d++){o[d].setAttribute("data-rexlive-section-number",s+d);var u=o[d].getElementsByClassName("pswp-figure");0===u.length&&Rexbuilder_Util.removeClass(o[d],"photoswipe-gallery")}_(".photoswipe-gallery")}if(r.length>0&&r.perfectGridGalleryEditor({editorMode:Rexbuilder_Util.editorMode}),a.length>0&&a.rexAccordion(l),RexSlider.init(),"undefined"!=typeof DistanceAccordion)for(var p=this.target.getElementsByClassName("distance-accordion-toggle"),f=0,g=p.length;f<g;f++){new DistanceAccordion(p[f],{context:this.target})}if("undefined"!=typeof SplitScrollable){var m=[].slice.call(this.target.getElementsByClassName("split-scrollable")),h=m.length,d=0;for(d=0;d<h;d++){new SplitScrollable(m[d],{scrollElsToWatchClass:"text-wrap",initializeComplete:t,customScrollContainer:this.target})}}},f=function(){if("undefined"!=typeof PopUpContent){var e=[].slice.call(document.getElementsByClassName("popup-content-button")),t=e.length,i=0;for(i=0;i<t;i++)new PopUpContent(e[i],{getPopUpContentComplete:p,ajaxSettings:{type:"GET",dataType:"json",url:_plugin_frontend_settings.rexajax.ajaxurl,data:{action:"rex_get_popup_content",nonce_param:_plugin_frontend_settings.rexajax.rexnonce}}})}},g=function(){if("undefined"!=typeof SplitScrollable){var e,i=[].slice.call(document.getElementsByClassName("split-scrollable")),n=i.length;for(e=0;e<n;e++){new SplitScrollable(i[e],{scrollElsToWatchClass:"text-wrap",initializeComplete:t})}}},m=function(e){if("undefined"!==Odometer){var t=e.innerText;if(null!==e.getAttribute("data-yearly-inc")&&""!==_plugin_frontend_settings.sitedate){var i=new Date(_plugin_frontend_settings.sitedate),n=new Date,r=n.getFullYear()-i.getFullYear(),o=e.getAttribute("data-yearly-inc");t=parseInt(t)+parseInt(o)*r}if(null!==e.getAttribute("data-montly-inc")&&""!==_plugin_frontend_settings.sitedate){var i=new Date(_plugin_frontend_settings.sitedate),n=new Date,r=n.getMonth()-i.getMonth(),l=e.getAttribute("data-montly-inc");t=parseInt(t)+parseInt(l)*r}e.setAttribute("data-final-value",t);var a=e.getAttribute("data-start-value");if(null==a){a="";for(var s=0,d=e.innerText.length;s<d;s++)a+="1"}var c=new Odometer({el:e,value:a,format:_plugin_frontend_settings.odometer.format,theme:_plugin_frontend_settings.odometer.theme});return c}},_=function(t,i){i="undefined"==typeof i?document:i;for(var n=function(t){for(var i,n,r,o,l=e(t).find(".pswp-figure").get(),a=l.length,s=[],d=0;d<a;d++)i=l[d],1===i.nodeType&&(n=i.children[0],r=n.getAttribute("data-size").split("x"),o={src:n.getAttribute("href"),w:parseInt(r[0],10),h:parseInt(r[1],10)},i.children.length>1&&(o.title=i.children[1].innerHTML),n.children.length>0&&(o.msrc=n.children[0].getAttribute("data-thumburl")),o.el=i,s.push(o));return s},r=function p(e,t){return e&&(t(e)?e:p(e.parentNode,t))},o=function(i){if(i=i||window.event,!(e(i.target).parents(".perfect-grid-item").find(".element-link").length>0||e(i.target).is("a"))){var n=i.target||i.srcElement,o=r(n,function(e){return e.tagName&&"FIGURE"===e.tagName.toUpperCase()});if(o){i.preventDefault?i.preventDefault():i.returnValue=!1;for(var l,s=e(o).parents(t)[0],d=e(s).find(".pswp-figure").get(),c=d.length,u=0,p=0;p<c;p++)if(1===d[p].nodeType){if(d[p]===o){l=u;break}u++}return l>=0&&a(l,s),!1}}},l=function(){var e=window.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),n=0,r=i.length;n<r;n++)if(i[n]){var o=i[n].split("=");o.length<2||(t[o[0]]=o[1])}return t.gid&&(t.gid=parseInt(t.gid,10)),t},a=function(e,t,i,r){var o,l,a,s=document.querySelectorAll(".pswp")[0];if(a=n(t),l={galleryUID:t.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(e){var t=a[e].el.getElementsByClassName("pswp-item-thumb")[0],i=a[e].el.getElementsByClassName("rex-custom-scrollbar")[0],n=window.pageYOffset||document.documentElement.scrollTop,r=i.getBoundingClientRect(),o=t.getAttribute("data-thumb-image-type");return"natural"==o?{x:r.left,y:r.top+n,w:r.width}:null},closeOnScroll:!1,showHideOpacity:!0},r)if(l.galleryPIDs){for(var d=0,c=a.length;d<c;d++)if(a[d].pid==e){l.index=d;break}}else l.index=parseInt(e,10)-1;else l.index=parseInt(e,10);isNaN(l.index)||(i&&(l.showAnimationDuration=0),o=new PhotoSwipe(s,PhotoSwipeUI_Default,a,l),o.init())},s=i.querySelectorAll(t),d=0,c=s.length;d<c;d++)s[d].setAttribute("data-pswp-uid",d+1),s[d].onclick=o;var u=l();u.pid&&u.gid&&a(u.pid,s[u.gid-1],!0,!0)},h=function(){if(Rexbuilder_Util.init(),Rexbuilder_Dom_Util.init(),Rexbuilder_Rexbutton.init(),Rexbuilder_Util.editorMode?(Rexbuilder_Util_Editor.init(),Rexbuilder_Color_Palette.init(),Rexbuilder_Overlay_Palette.init(),Rexbuilder_Section.init(),Rexbuilder_Section_Editor.init(),Rexbuilder_Block.init(),Rexbuilder_Block_Editor.init(),Rexbuilder_Util_Editor.addDocumentListeners(),Rexbuilder_Util_Editor.addWindowListeners(),Rexbuilder_Util_Editor.addDnDEvents(),TextEditor.init(),Rexbuilder_Section_Editor.triggerRowDataChange()):a(),Rex_Navigator.init(),Rexbuilder_Util.addWindowListeners(),i=Rexbuilder_Util.$rexContainer.find(".rexpansive_section"),n=Rexbuilder_Util.$rexContainer.find(".grid-stack-row"),r=Rexbuilder_Util.$rexContainer.find(".rex-accordion"),n&&n.perfectGridGalleryEditor({editorMode:Rexbuilder_Util.editorMode}),!Rexbuilder_Util.editorMode){i.each(function(e,t){var i=t.getElementsByClassName("pswp-figure");0===i.length&&Rexbuilder_Util.removeClass(t,"photoswipe-gallery")}),_(".photoswipe-gallery"),Rexbuilder_Util.$body.find(".rex-num-spin").each(function(t,i){var n=m(i);o.push(n),e(i).rexScrolled({callback:function(e){e.innerHTML=e.getAttribute("data-final-value")}})});var t=Rexbuilder_Util.$body.find(".rex-slideshow");t.length>0&&t.rexSlideshow()}if(1==_plugin_frontend_settings.native_scroll_animation){for(var d=['[href="#"]',".no-smoothing",".vertical-nav-link",".rex-vertical-nav-link",".woocommerce-review-link"],c=Rexbuilder_Util.$body.find('a[href*="#"]'),u=0,p=d.length;u<p;u++)c=c.not(d[u]);c=c.not(f),c.click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=e(this.hash);if(t=t.length?t:Rexbuilder_Util.$rexContainer.find("[name="+this.hash.slice(1)+"]"),t.length)return Rexbuilder_Util.smoothScroll(t),!1}});var f=function(t){return 0!=e(this).parents(".woocommerce-tabs").length}}s(),RexSlider.init(),Rexbuilder_Util.launchVideoPlugins(),Rexbuilder_Util.playAllVideos(),l={durationOpen:10,durationClose:300},Rexbuilder_Util.editorMode?(l.open={progressClbk:function(e){var t=e.properties.$content.parents(".grid-stack-item")[0],i=e.properties.$content.parents(".grid-stack").data("gridstack");i.resize(t,null,Math.round(e.element.parentElement.offsetHeight/i.opts.cellHeight))}},l.close={progressClbk:function(e){var t=e.properties.$content.parents(".grid-stack-item")[0],i=t.children[0].getAttribute("data-gs_start_h"),n=e.properties.$content.parents(".grid-stack").data("gridstack");n.resize(t,null,Math.round(parseInt(i)))}}):(l.open={completeClbk:function(t){var i=t.$element.parents(".text-wrap")[0].offsetHeight,n=t.properties.$content.parents(".grid-stack-item")[0],r=t.properties.$content.parents(".grid-stack").data("plugin_perfectGridGalleryEditor");if(r){var o=r.properties.gridstackInstance,l=Math.ceil((i+r.properties.gutter)/o.opts.cellHeight);o.batchUpdate(),o.resize(n,null,l),o.commit()}t.properties.$content.addClass("rSlideInTop").one(Rexbuilder_Util._animationEvent,function(){e(this).removeClass("rSlideInTop")})}},l.close={startClbk:function(t){t.properties.$content.addClass("rSlideOutTop").one(Rexbuilder_Util._animationEvent,function(){e(this).removeClass("rSlideOutTop")})},completeClbk:function(e){var t=e.$element.parents(".text-wrap")[0].offsetHeight,i=e.properties.$content.parents(".grid-stack-item")[0],n=e.properties.$content.parents(".grid-stack").data("plugin_perfectGridGalleryEditor");if(n){var r=n.properties.gridstackInstance,o=Math.ceil((t+n.properties.gutter)/r.opts.cellHeight);r.batchUpdate(),r.resize(i,null,o),r.commit()}}}),r.rexAccordion(l)},v=function(){Rexbuilder_Util.editorMode&&Rexbuilder_Util_Editor.load();var t=e(".text-fill-container-canvas");t.length>0&&(t.textFill({relative:!0,relativeWrap:".perfect-grid-item",fontFamily:_plugin_frontend_settings.textFill.font_family,fontWeight:_plugin_frontend_settings.textFill.font_weight}),t.on("textfill-render-complete",function(){Rexbuilder_Util.$window.resize()})),RexSlider.startAutoPlay(),n&&"undefined"!=typeof rexIndicator&&n.find(".rex-indicator__placeholder").rexIndicator(),0==_plugin_frontend_settings.user.editing&&(e(".rex-effect-distortion").each(function(t,i){var n=e(i);1==_plugin_frontend_settings.animations?n.one("rs-animation-complete",function(){n.rexEffect({effect:{name:"distortion",properties:{startDelay:2500}}})}):n.rexEffect({effect:{name:"distortion",properties:{startDelay:2500}}})}),e(".rex-effect-distortion-section").each(function(t,i){var n=e(i);1==_plugin_frontend_settings.animations?n.one("rs-scrolled-complete",function(){n.rexEffect({effect:{name:"distortion-section",properties:{startDelay:2500}}})}):n.rexEffect({effect:{name:"distortion-section",properties:{startDelay:2500}}})})),0==_plugin_frontend_settings.user.editing&&e("[class*=border-space-animated-]").each(function(t,i){var n=e(i);n.addClass("border-space-animated"),1==_plugin_frontend_settings.animations&&Rexbuilder_Util.viewport().width>768?n.one("rs-animation-complete",function(){n.addClass("border-active")}):n.parents(".rexpansive_section").one("rs-scrolled-complete",function(){n.addClass("border-active")})}),0==_plugin_frontend_settings.user.editing&&i.rexScrolled({callback:function(t){if(Rexbuilder_Util.has_class(t,"rex-element--animated")){var i=e(t);i.addClass("run-animation").on(Rexbuilder_Util.transitionEvent,function(e){})}}}),"undefined"!=typeof _plugin_frontend_settings&&1==_plugin_frontend_settings.animations&&(0==_plugin_frontend_settings.user.editing?e(".rs-animation").rexScrollify({mobile:!1}):e(".rs-animation").removeClass("has-rs-animation")),0==_plugin_frontend_settings.user.editing&&(d(),c(),u(),f(),g()),Rexbuilder_Util.galleryPluginActive=!0};return{init:h,load:v}}(jQuery);!function(){"use strict";document.addEventListener("DOMContentLoaded",Rexbuilder_App.init),window.addEventListener("load",Rexbuilder_App.load)}();