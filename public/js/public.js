var Rexbuilder_Util=function($){"use strict";function _smoothScroll(e){$("body,html").animate({scrollTop:e.offset().top+_plugin_frontend_settings.scroll_animation_offset},600)}var $window=$(window),fixSectionWidth=0,editorMode=!1,windowIsResizing=!1,responsiveLayouts,defaultLayoutSections,$modelsCustomizationsDataDiv,$pageCustomizationsDataDiv,$liveDataContainer,$layoutsDomOrder,$defaultLayoutState,createRandomID=function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},_createSectionID=function(){var e,t,i=4;do t=!0,e=createRandomID(i),"self"==e?t=!1:Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(){void 0!==$(this).attr("data-rexlive-section-id")&&$(this).attr("data-rexlive-section-id")==e&&(t=!1)});while(!t);return e},createBlockID=function(){var e,t,i,a=4;do t=!0,e=createRandomID(a),"self"==e?t=!1:Rexbuilder_Util.$rexContainer.find(".grid-stack-item").each(function(){i=$(this),void 0!==i.attr("data-rexbuilder-block-id")&&i.attr("data-rexbuilder-block-id")==e&&(t=!1)});while(!t);return e},_updateSectionsID=function(){var e,t;Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(i,a){t=$(a),"undefined"!=typeof t.attr("data-rexlive-section-id")&&""!=t.attr("data-rexlive-section-id")||(e=_createSectionID(),t.attr("data-rexlive-section-id",e))})},_updateSectionsNumber=function(){var e,t=-1;Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(i,a){e=$(a),e.attr("data-rexlive-section-number",i),t=i}),Rexbuilder_Util.lastSectionNumber=t},_findLayoutType=function(e){return"default"==e||"tablet"==e||"mobile"==e?"standard":"custom"},_getModelsCustomizations=function(){var e=[];return $modelsCustomizationsDataDiv.children(".model-customizations-container").each(function(t,i){var a=$(i),o=parseInt(a.attr("data-model-id")),r=[];a.children(".model-customization-data").each(function(e,t){var i=$(t),a=i.attr("data-model-layout-name"),o=JSON.parse(i.text()),n={name:a,targets:o};r.push(n)});var n={id:o,customizations:r};e.push(n)}),e},_updateModelsCustomizationsData=function(e){var t,i=e.id,a=$modelsCustomizationsDataDiv.children('.model-customizations-container[data-model-id="'+i+'"]');for(0!=a.length?a.children(".model-customization-data").remove():(a=$(document.createElement("div")),a.addClass("model-customizations-container"),a.attr("data-model-id",i),a.appendTo($modelsCustomizationsDataDiv[0])),t=0;t<e.customizations.length;t++){var o=$(document.createElement("div"));o.addClass("model-customization-data"),o.attr("data-model-layout-name",e.customizations[t].name),o.text(JSON.stringify(e.customizations[t].targets)),o.appendTo(a[0])}$modelsCustomizationsDataDiv.attr("data-empty-models-customizations",!1)},_updateDivModelCustomizationsNames=function(e){var t,i=$("#rexbuilder-model-data .available-models-customizations-names"),a=JSON.parse(i.text()),o=[];for(t=0;t<a.length;t++){var r=a[t];r.id!=e.id&&o.push(r)}o.push(e),i.text(JSON.stringify(o))},_getPageCustomizations=function(){var e=[],t={name:"default",sections:[]},i=$pageCustomizationsDataDiv.children('.customization-wrap[data-customization-name="default"]');return i.children(".section-targets").each(function(e,i){var a=$(i),o=a.attr("data-section-rex-id"),r=isNaN(parseInt(a.attr("data-model-id")))?-1:parseInt(a.attr("data-model-id")),n=isNaN(parseInt(a.attr("data-model-number")))?-1:parseInt(a.attr("data-model-number")),s="undefined"!=typeof a.attr("data-section-hide")&&"1"==a.attr("data-section-hide").toString(),d=""!=a.text()?JSON.parse(a.text()):[];t.sections.push({section_rex_id:o,section_model_id:r!=-1?r:"",section_model_number:n!=-1?n:"",section_is_model:r!=-1,section_hide:s,targets:d})}),e.push(t),$pageCustomizationsDataDiv.children('.customization-wrap:not([data-customization-name="default"])').each(function(t,i){var a=$(i),o=a.attr("data-customization-name"),r={name:o,sections:[]};a.children(".section-targets").each(function(e,t){var i=$(t),a=i.attr("data-section-rex-id"),o=isNaN(parseInt(i.attr("data-model-id")))?-1:parseInt(i.attr("data-model-id")),n=isNaN(parseInt(i.attr("data-model-number")))?-1:parseInt(i.attr("data-model-number")),s="undefined"!=typeof i.attr("data-section-hide")&&"1"==i.attr("data-section-hide").toString(),d=""!=i.text()?JSON.parse(i.text()):[],l="undefined"!=typeof i.attr("data-section-created-live")&&"1"==i.attr("data-section-created-live").toString();r.sections.push({section_rex_id:a,section_model_id:o!=-1?o:"",section_model_number:n!=-1?n:"",section_is_model:o!=-1,section_hide:s,section_created_live:l,targets:d})}),e.push(r)}),e},_createPageCustomizationsDataLive=function(e){$liveDataContainer.children().remove();var t;for(t=0;t<e.length;t++){var i=$(document.createElement("div"));i.addClass("section-targets"),i.attr("data-section-rex-id",e[t].section_rex_id),i.attr("data-model-id",e[t].section_model_id),i.attr("data-model-number",e[t].section_model_number),i.attr("data-section-hide",e[t].section_hide),i.text(JSON.stringify(e[t].targets)),i.appendTo($liveDataContainer[0])}},_updatePageCustomizationsData=function(e){var t,i=e.name,a=$pageCustomizationsDataDiv.children('.customization-wrap[data-customization-name="'+i+'"]');for(0!=a.length?a.children(".section-targets").remove():(a=$(document.createElement("div")),a.addClass("customization-wrap"),a.attr("data-customization-name",i),a.appendTo($pageCustomizationsDataDiv[0])),t=0;t<e.sections.length;t++){var o=$(document.createElement("div"));o.addClass("section-targets"),o.attr("data-section-rex-id",e.sections[t].section_rex_id),o.attr("data-model-id",e.sections[t].section_model_id),o.attr("data-model-number",e.sections[t].section_model_number),o.attr("data-section-hide",e.sections[t].section_hide),o.attr("data-section-created-live","true"==e.sections[t].section_created_live.toString()&&"1"),""==e.sections[t].section_model_id&&o.text(JSON.stringify(e.sections[t].targets)),o.appendTo(a[0])}$pageCustomizationsDataDiv.removeAttr("data-empty-customizations")},_updatePageAvaiableLayoutsNames=function(e){var t=$("#rexbuilder-layout-data .available-layouts-names");t.text(JSON.stringify(e))},_getSectionCustomLayouts=function(e){var t,i,a=[],o=Rexbuilder_Util.getPageCustomizations();for(t=0;t<o.length;t++){var r=o[t].name;if(null!=o[t].sections)for(i=0;i<o[t].sections.length;i++)if(o[t].sections[i].section_rex_id==e){var n=jQuery.extend(!0,[],o[t].sections[i].targets),s={name:r,targets:n};a.push(s)}}return a},chooseLayout=function(){var e=$("#rexbuilder-layout-data"),t=$("#rexbuilder-model-data");if(Rexbuilder_Util.chosenLayoutData={min:0,max:"",id:"default",label:"My Desktop",type:"standard"},"true"==e.children(".layouts-data").attr("data-empty-customizations")||Rexbuilder_Util.editorMode&&Rexbuilder_Util.firstStart)return"default";var i,a,o,r,n=_viewport().width,s=JSON.parse($("#layout-avaiable-dimensions").text()),d=JSON.parse(t.children(".available-models-customizations-names").text()),l=JSON.parse(e.children(".available-layouts-names").text()),u=[];for(i=0;i<s.length;i++){for(r=!1,a=0;a<d.length;a++)for(o=0;o<d[a].names.length;o++)if(s[i].id==d[a].names[o]){var c=s[i];c.model=!0,r=!0,u.push(c)}if(!r)for(o=0;o<l.length;o++)if(s[i].id==l[o]){var c=s[i];c.model=!1,r=!0,u.push(c)}}for(i=0;i<u.length;i++)""==u[i].min&&(u[i].min=0);var _="",m=lodash.sortBy(u,[function(e){return parseInt(e.min)}]);for(i=0;i<m.length;i++)n>=m[i].min&&(""!=m[i].max?n<m[i].max&&(_=m[i].id,Rexbuilder_Util.chosenLayoutData=m[i]):(_=m[i].id,Rexbuilder_Util.chosenLayoutData=m[i]));return""===_&&(_="default"),_},_createEmptyTargets=function(e){var t,i=[];for(t=0;t<e.length;t++){var a={name:e[t].name,props:{}};"self"==e[t].name&&_viewport().width<_plugin_frontend_settings.defaultSettings.collapseWidth&&(a.props.collapse_grid=!0),i.push(a)}return i},_getDefaultPageLayout=function(e,t){var i,a,o,r,n=[];for(i=0;i<e.length;i++)if("default"==e[i].name){for(a=0;a<e[i].sections.length;a++)n.push(jQuery.extend(!0,{},e[i].sections[a]));break}for(i=0;i<n.length;i++)if("true"==n[i].section_is_model.toString())for(o=0;o<t.length;o++)if(t[o].id==n[i].section_model_id){for(r=0;r<t[o].customizations.length;r++)if("default"==t[o].customizations[r].name){n[i].targets=jQuery.extend(!0,[],t[o].customizations[r].targets);break}break}return n},_getDefaultModelsLayout=function(e){var t,i,a=[];for(t=0;t<e.length;t++)for(i=0;i<e[t].customizations.length;i++)if("default"==e[t].customizations[i].name){a.push({id:e[t].id,targets:e[t].customizations[i].targets});break}return a},_getCustomLayoutSections=function(e,t,i,a){if("default"==a)return i;var o,r,n,s,d,l=[],u=!1,c=_getDefaultModelsLayout(t);for(o=0;o<e.length;o++)if(e[o].name==a){for(u=!0,r=0;r<e[o].sections.length;r++)l.push(jQuery.extend(!0,{},e[o].sections[r]));break}if(!u)for(o=0;o<i.length;o++){var _=jQuery.extend(!0,{},i[o]);_.targets=_createEmptyTargets(i[o].targets),_.sectionCleared=!0,l.push(_)}for(o=0;o<l.length;o++)if("true"==l[o].section_is_model.toString()){for(n=0;n<t.length;n++)if(t[n].id==l[o].section_model_id){for(d=!1,s=0;s<t[n].customizations.length;s++)if(t[n].customizations[s].name==a){d=!0,l[o].targets=jQuery.extend(!0,[],t[n].customizations[s].targets),l[o].defaultSection=!1,l[o].sectionCleared=!1;break}if(!d)for(s=0;s<c.length;s++)if(l[o].section_model_id==c[s].id){l[o].targets=_createEmptyTargets(c[s].targets),l[o].sectionCleared=!0;break}break}}else if(0==l[o].targets.length)for(r=0;r<i.length;r++)if(l[o].section_rex_id==i[r].section_rex_id){l[o].targets=_createEmptyTargets(i[r].targets),l[o].sectionCleared=!0;break}return l},_mergeSections=function(e,t){var i,a,o,r,n;if(console.log("layoutSelectedSections",jQuery.extend(!0,[],e)),console.log("defaultLayoutSections",jQuery.extend(!0,[],t)),"default"!=Rexbuilder_Util.activeLayout){for(i=0;i<e.length;i++)for(e[i].sectionFounded=!1,e[i].defaultSection=!1,a=0;a<t.length;a++)if(e[i].section_rex_id==t[a].section_rex_id){e[i].sectionFounded=!0;var s=e[i],d=t[a];for(("undefined"==typeof s.targets[0]||jQuery.isEmptyObject(s.targets[0].props)||"undefined"!=typeof s.sectionCleared&&s.sectionCleared)&&(s.defaultSection=!0,s.targets=jQuery.extend(!0,[],d.targets)),o=0;o<s.targets.length;o++){for(n=!1,r=0;r<d.targets.length;r++)if(s.targets[o].name==d.targets[r].name){if(s.targets[o].notDisplay=!1,n=!0,d.targets[r].oldElement=!0,o>=1&&jQuery.isEmptyObject(s.targets[o].props)&&"default"!=Rexbuilder_Util.activeLayout&&d.targets[0].props.layout!=s.targets[0].props.layout){var l=parseFloat(d.targets[0].props.grid_cell_width),u=5;"masonry"==d.targets[0].props.layout?(s.targets[o].props.gs_y=Math.round(d.targets[r].props.gs_y*u/l),s.targets[o].props.gs_height=Math.round(d.targets[r].props.gs_height*u/l),s.targets[o].props.gs_start_h=Math.round(d.targets[r].props.gs_start_h*u/l)):(s.targets[o].props.gs_y=Math.round(d.targets[r].props.gs_y*l/u),s.targets[o].props.gs_height=Math.round(d.targets[r].props.gs_height*l/u),s.targets[o].props.gs_start_h=Math.round(d.targets[r].props.gs_start_h*l/u))}s.targets[o].props=lodash.merge({},d.targets[r].props,s.targets[o].props);break}n||(s.targets[o].notDisplay=!0)}for(r=0;r<d.targets.length;r++)if("undefined"==typeof d.targets[r].oldElement){var c=jQuery.extend(!0,{},d.targets[r]);if("default"!=Rexbuilder_Util.activeLayout&&d.targets[0].props.layout!=s.targets[0].props.layout){var l=parseFloat(d.targets[0].props.grid_cell_width),u=5;"masonry"==d.targets[0].props.layout?(c.props.gs_y=Math.round(c.props.gs_y*u/l),c.props.gs_height=Math.round(c.props.gs_height*u/l),c.props.gs_start_h=Math.round(c.props.gs_start_h*u/l)):(c.props.gs_y=Math.round(c.props.gs_y*l/u),c.props.gs_height=Math.round(c.props.gs_height*l/u),c.props.gs_start_h=Math.round(c.props.gs_start_h*l/u))}s.targets.splice(1,0,c)}break}if(0==e.length)for(e=t,i=0;i<e.length;i++)e[i].defaultSection=!0}for(_createPageCustomizationsDataLive(e),i=0;i<e.length;i++)(e[i].sectionFounded||"default"==Rexbuilder_Util.activeLayout)&&("true"==e[i].targets[0].props.collapse_grid.toString()?e[i].targets[0].props.wasCollapsed=!0:e[i].targets[0].props.wasCollapsed=!1,("default"!=Rexbuilder_Util.activeLayout&&e[i].defaultSection||"default"==Rexbuilder_Util.activeLayout)&&_viewport().width<_plugin_frontend_settings.defaultSettings.collapseWidth?e[i].targets[0].props.collapse_grid=!0:e[i].targets[0].props.collapse_grid=!1);return jQuery.extend(!0,{},e)},_edit_dom_layout=function(e){if(e==Rexbuilder_Util.activeLayout&&"default"==e)return void(_viewport().width>=_plugin_frontend_settings.defaultSettings.collapseWidth?Rexbuilder_Util.removeCollapsedGrids():Rexbuilder_Util.blockGridUnder768||Rexbuilder_Util.collapseAllGrids());Rexbuilder_Util.$rexContainer.attr("data-rex-layout-selected",e),Rexbuilder_Util.activeLayout=e;var t=$("#rexbuilder-layout-data"),i=$("#rexbuilder-model-data");if("true"==t.children(".layouts-customizations").attr("data-empty-customizations")&&"true"==i.children(".models-customizations").attr("data-empty-models-customizations"))return void(_viewport().width>=_plugin_frontend_settings.defaultSettings.collapseWidth?removeCollapsedGrids():Rexbuilder_Util.blockGridUnder768||Rexbuilder_Util.collapseAllGrids());var a=[];Rexbuilder_Util.$rexContainer.children(".rexpansive_section:not(.removing_section)").each(function(e,t){var i=$(t);i.hasClass("rex-model-section")&&a.push(parseInt(i.attr("data-rexlive-model-id")))});var o=[];Rexbuilder_Util.$rexContainer.children(".rexpansive_section:not(.removing_section)").each(function(e,t){var i=$(t),a={rexID:i.attr("data-rexlive-section-id"),modelID:isNaN(parseInt(i.attr("data-rexlive-model-id")))?"":parseInt(i.attr("data-rexlive-model-id"))};o.push(a)});var r,n,s=_getPageCustomizations();"default"==Rexbuilder_Util.activeLayout&&_saveCustomizationDomOrder(jQuery.extend(!0,[],s));var d,l=_getModelsCustomizations();"true"==$defaultLayoutState.attr("data-empty-default-customization")?(d=_getDefaultPageLayout(s,l),_createDefaultLayoutState(d)):(_updateDefaultLayoutState({modelsData:l}),d=_getDefaultLayoutState());var u,c=_getCustomLayoutSections(s,l,d,e),_=[];for(r=0;r<c;r++)if("true"==c[r].section_is_model.toString()){for(u=!1,n=0;n<_.length;n++)if(_[n].id==c[r].section_model_id){_[n].number=_[n].number+1,c[r].section_model_number=_[n].number,u=!0;break}u||(c[r].section_model_number=1,_.push({id:c[r].section_model_id,number:1}))}var m=_mergeSections(c,d);Rexbuilder_Util.removeCollapsedGrids(),console.log("mergedEdits",m),Rexbuilder_Util.domUpdaiting=!0;var p=!1,g=[];$.each(m,function(t,i){if(!i.notInSection||"default"==e){var a,o={rexID:i.section_rex_id,modelID:-1,modelNumber:-1};"true"==i.section_is_model.toString()?(o.modelID=i.section_model_id,o.modelNumber=i.section_model_number,a=Rexbuilder_Util.$rexContainer.children('section[data-rexlive-section-id="'+i.section_rex_id+'"][data-rexlive-saved-model-number="'+o.modelNumber+'"]')):a=Rexbuilder_Util.$rexContainer.children('section[data-rexlive-section-id="'+i.section_rex_id+'"]'),0==a.length||a.hasClass("removing_section")||("undefined"!=typeof i.section_hide&&"true"==i.section_hide.toString()?a.addClass("rex-hide-section"):(a.removeClass("rex-hide-section"),_updateDOMelements(a,i.targets,p)),g.push(o))}}),console.log("dom applied order",jQuery.extend(!0,[],g)),Rexbuilder_Dom_Util.fixSectionDomOrder(g,!0),Rexbuilder_Util.domUpdaiting=!1,Rexbuilder_Util.editorMode||initPhotoSwipe(".photoswipe-gallery")},_updateDOMelements=function(e,t,i){var a=e.find(".grid-stack-row"),o=a.data();if(void 0!==o){var r=o.plugin_perfectGridGalleryEditor;if(void 0!==r){for(var n=1;n<t.length;n++){var s=a.children('div[data-rexbuilder-block-id="'+t[n].name+'"]'),d="undefined"!=typeof t[n].props.hide&&"true"==t[n].props.hide.toString();d?s.hasClass("rex-hide-element")||(s.addClass("rex-hide-element"),r.removeBlock(s)):s.hasClass("rex-hide-element")&&(s.removeClass("rex-hide-element"),r.reAddBlock(s))}var l=r.properties.gridstackInstance;r.batchGridstack()}}for(var n=1;n<t.length;n++)if(t[n].notDisplay&&"default"!=Rexbuilder_Util.activeLayout){var u=a.children('div[data-rexbuilder-block-id="'+c+'"]');0!=u.length&&console.log("che me ne facico di lui")}else{var c=t[n].name,_=t[n].props,s=a.children('div[data-rexbuilder-block-id="'+c+'"]'),m=s.children(".rexbuilder-block-data"),p=s.find(".grid-item-content"),g={x:s.attr("data-gs-x"),y:s.attr("data-gs-y"),w:s.attr("data-gs-width"),h:s.attr("data-gs-height"),startH:m.attr("data-gs_start_h")},f={x:"undefined"==typeof _.gs_x?g.x:_.gs_x,y:"undefined"==typeof _.gs_y?g.y:_.gs_y,w:"undefined"==typeof _.gs_width?g.w:_.gs_width,h:"undefined"==typeof _.gs_height?g.h:_.gs_height,startH:"undefined"==typeof _.gs_start_h?g.startH:_.gs_start_h,gridstackInstance:l};_updateElementDimensions(s,m,f);var h=isNaN(parseInt(_.video_bg_id))?"":parseInt(_.video_bg_id),v="undefined"==typeof _.video_bg_url_youtube?"":_.video_bg_url_youtube,y="undefined"==typeof _.video_bg_url_vimeo?"":_.video_bg_url_vimeo,b="";""!=h?b="mp4":""!=y?b="vimeo":""!=v&&(b="youtube");var x={mp4Data:{idMp4:h,linkMp4:"undefined"==typeof _.video_mp4_url?"":_.video_mp4_url,width:isNaN(parseInt(_.video_bg_width))?parseInt(_.video_bg_width):"",height:isNaN(parseInt(_.video_bg_height))?parseInt(_.video_bg_height):""},vimeoUrl:y,youtubeUrl:v,audio:"undefined"==typeof _.video_has_audio?"":"1"==_.video_has_audio||"true"==_.video_has_audio.toString(),typeVideo:b};Rexbuilder_Dom_Util.updateVideos(p,x);var S="undefined"==typeof _.image_bg_elem_active||"true"==_.color_bg_block_active.toString(),D={active:S,idImage:S?isNaN(parseInt(_.id_image_bg))?"":parseInt(_.id_image_bg):"",urlImage:S?_.image_bg_url:"",width:S?isNaN(parseInt(_.image_width))?"":parseInt(_.image_width):"",height:S?isNaN(parseInt(_.image_height))?"":parseInt(_.image_height):"",typeBGimage:S?_.type_bg_image:"",photoswipe:S?_.photoswipe:""};Rexbuilder_Dom_Util.updateImageBG(p,D);var w={$elem:s,color:_.color_bg_block,active:"undefined"==typeof _.color_bg_block_active||_.color_bg_block_active.toString()};Rexbuilder_Dom_Util.updateBlockBackgroundColor(w);var C={$elem:s,color:_.overlay_block_color,active:"undefined"!=typeof _.overlay_block_color_active&&_.overlay_block_color_active.toString()};Rexbuilder_Dom_Util.updateBlockOverlay(C),Rexbuilder_Dom_Util.updateBlockPaddings(s,_getPaddingsDataString("undefined"!=typeof _.block_padding?_.block_padding:""));var $="undefined"==typeof _.block_custom_class?"":_.block_custom_class,k=[];""!=$&&($=$.trim(),k=$.split(/\s+/)),Rexbuilder_Dom_Util.updateCustomClasses(s,k);var U="undefined"!=typeof _.block_flex_position?_.block_flex_position.split(" "):"",R={x:U[0],y:U[1]};Rexbuilder_Dom_Util.updateFlexPostition(s,R);var z="undefined"==typeof _.slider_dimension_ratio?"":_.slider_dimension_ratio;m.attr("data-slider_ratio",z);var I="undefined"==typeof _.block_dimensions_live_edited?"":_.block_dimensions_live_edited;m.attr("data-block_dimensions_live_edited",I);var L="undefined"!=typeof _.hide&&"true"==_.hide.toString();L?(s.hasClass("rex-hide-element")||s.addClass("rex-hide-element"),Rexbuilder_Util.stopBlockVideos(s)):(s.hasClass("rex-hide-element")&&s.removeClass("rex-hide-element"),Rexbuilder_Util.playBlockVideos(s));var P="undefined"!=typeof _.element_edited&&"true"==_.element_edited.toString();s.attr("data-rexlive-element-edited",P);for(var N in _)switch(N){case"type":m.attr("data-type",_.type);break;case"size_x":s.attr("data-width",_.size_x);break;case"size_y":s.attr("data-height",_.size_y);break;case"row":s.attr("data-row",_.row);break;case"col":s.attr("data-col",_.col);break;case"photoswipe":Rexbuilder_Util.editorMode||("true"==_.photoswipe?(addPhotoSwipeElement(p,_.image_bg_block,parseInt(_.image_width),parseInt(_.image_height),_.image_size),e.addClass("photoswipe-gallery")):removePhotoSwipeElement(p),m.attr("data-photoswipe",_.photoswipe));break;case"linkurl":if(!Rexbuilder_Util.editorMode){var V=p.parents(".element-link");if(""!=_.linkurl)if(0!=V.length)V.attr("href",_.linkurl),V.attr("title",_.linkurl);else{var E=p.parent();tmpl.arg="link",E.append(tmpl("tmpl-link-block",{url:_.linkurl}));var O=E.children(".element-link");p.detach().appendTo(O)}else 0!=V.length&&V.children().unwrap()}Rexbuilder_Dom_Util.updateBlockUrl(s,_.linkurl);break;case"zak_background":case"zak_side":case"zak_title":case"zak_icon":case"zak_foreground":break;case"block_animation":break;case"block_has_scrollbar":}}updateSection(e,a,t[0].props,i);var T="undefined"!=typeof t[0].props.collapse_grid&&("true"==t[0].props.collapse_grid.toString()||i);if(void 0!==o){var r=a.data().plugin_perfectGridGalleryEditor;void 0!==r&&(Rexbuilder_Util.domUpdaiting=!0,r.properties.gridstackInstance.commit(),setTimeout(function(){Rexbuilder_Util.domUpdaiting=!0,r.batchGridstack(),r.properties.gridstackInstance.batchUpdate(),"masonry"!=r.settings.galleryLayout||T?"fixed"==r.settings.galleryLayout&&"true"==r.settings.fullHeight.toString()&&r.updateFullHeight():r.updateBlocksHeight(),t[0].props.wasCollapsed&&r.collapseElementsProperties(),r.properties.gridstackInstance.commit(),setTimeout(function(){Rexbuilder_Util.domUpdaiting=!1,r.properties.dispositionBeforeCollapsing=r.createActionDataMoveBlocksGrid(),r._createFirstReverseStack(),r._fixImagesDimension(),Rexbuilder_Util.editorMode&&r.createScrollbars(),r._updateElementsSizeViewers(),Rexbuilder_Util.playAllVideos()},200,r)},300,r))}},_updateModelsLive=function(e,t,i){Rexbuilder_Util.domUpdaiting=!0,Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(a,o){var r=$(o);r.attr("data-rexlive-model-id")==e&&r.attr("data-rexlive-model-number")!=i&&_updateDOMelements(r,t,!1)}),Rexbuilder_Util.domUpdaiting=!1},_saveCustomizationDomOrder=function(e){var t,i;$layoutsDomOrder.children().remove();var a=[];for(t=0;t<e.length;t++){var o=$(document.createElement("div"));for(o.addClass("layout-sections"),o.attr("data-rex-layout-name",e[t].name),a=[],i=0;i<e[t].sections.length;i++)a.push(e[t].sections[i]);o.text(JSON.stringify(a)),o.appendTo($layoutsDomOrder[0])}},_getPageCustomizationsDom=function(){var e=[];return $layoutsDomOrder.children('.layout-sections:not([data-rex-layout-name="default"])').each(function(t,i){var a=$(i);e.push({name:a.attr("data-rex-layout-name"),sections:JSON.parse(a.text())})}),e},_updatePageCustomizationsDomOrder=function(e){console.log("layoutsData",e);for(var t=0;t<e.length;t++)$layoutsDomOrder.children('.layout-sections[data-rex-layout-name="'+e[t].name+'"]').text(JSON.stringify(e[t].sections))},_getPageAvaiableLayoutsNames=function(){var e=$("#rexbuilder-layout-data .available-layouts-names");return JSON.parse(e.text())},_getLayoutLiveSectionTargets=function(e){var t=[];if(e.hasClass("rex-model-section")){var i=e.attr("data-rexlive-model-id");$liveDataContainer.children().each(function(e,a){var o=$(a);if(i==o.attr("data-model-id"))return t=JSON.parse(o.text()),!1})}else{var a=e.attr("data-rexlive-section-id");$liveDataContainer.children().each(function(e,i){var o=$(i);if(a==o.attr("data-section-rex-id"))return t=JSON.parse(o.text()),!1})}return t},_createDefaultLayoutState=function(e){$defaultLayoutState.children().remove();var t;for(t=0;t<e.length;t++){var i=$(document.createElement("div"));i.addClass("section-targets"),i.attr("data-section-rex-id",e[t].section_rex_id),i.attr("data-model-id",e[t].section_model_id),i.attr("data-model-number",e[t].section_model_number),i.attr("data-section-hide",e[t].section_hide),i.text(JSON.stringify(e[t].targets)),i.appendTo($defaultLayoutState[0])}$defaultLayoutState.removeAttr("data-empty-default-customization")},_updateDefaultLayoutState=function(e){var t,i,a,o="undefined"==typeof e.pageData?[]:e.pageData,r="undefined"==typeof e.modelsData?[]:e.modelsData;if(0==o.length)$defaultLayoutState.children(".section-targets").each(function(e,t){var o=$(t),n=isNaN(parseInt(o.attr("data-model-id")))?-1:parseInt(o.attr("data-model-id"));if(n!=-1)for(i=0;i<r.length;i++)if(n==r[i].id){for(a=0;a<r[i].customizations.length;a++)if("default"==r[i].customizations[a].name){o.text(JSON.stringify(r[i].customizations[a].targets));break}break}});else for($defaultLayoutState.children(".section-targets").remove(),t=0;t<o.length;t++){var n=$(document.createElement("div"));if(n.addClass("section-targets"),n.attr("data-section-rex-id",o[t].section_rex_id),n.attr("data-model-id",o[t].section_model_id),n.attr("data-model-number",o[t].section_model_number),n.attr("data-section-hide",o[t].section_hide),""==o[t].section_model_id||o[t].section_model_id==-1)n.text(JSON.stringify(o[t].targets));else if(o[t].section_model_id!=-1)for(i=0;i<r.length;i++)if(o[t].section_model_id==r[i].id){for(a=0;a<r[i].customizations.length;a++)if("default"==r[i].customizations[a].name){n.text(JSON.stringify(r[i].customizations[a].targets));break}break}n.appendTo($defaultLayoutState[0])}},_updateDefaultLayoutStateDOMOrder=function(e){var t=_getDefaultLayoutState();e=jQuery.extend(!0,[],e);var i,a,o,r=[];for(i=0;i<e.length;i++)if(e[i].modelID!=-1){for(o=!1,a=0;a<r.length;a++)if(r[a].id==e[i].modelID){r[a].number=r[a].number+1,e[i].modelNumber=r[a].number,o=!0;break}o||(r.push({id:e[i].modelID,number:1}),e[i].modelNumber=1)}var n,s=[];for(i=0;i<e.length;i++){for(a=0;a<t.length;a++)e[i].modelID!=-1?e[i].modelID==t[a].section_model_id&&e[i].modelNumber==t[a].section_model_number&&(n=t.splice(a,1)):e[i].rexID==t[a].section_rex_id&&(n=t.splice(a,1));s.push(n[0])}_updateDefaultLayoutState({pageData:s})},_updateDefaultLayoutStateSection=function(e,t){t="undefined"==typeof t?-1:t,Rexbuilder_Dom_Util.fixModelNumbersSaving();var i=Rex_Save_Listeners.createTargets(e,Rexbuilder_Util.activeLayout),a=!1;if(e.hasClass("rex-model-section")){var o=e.attr("data-rexlive-model-id"),r=e.attr("data-rexlive-section-number");$defaultLayoutState.children(".section-targets").each(function(e,t){var n=$(t);o==n.attr("data-model-id")&&(n.text(JSON.stringify(i)),r==n.attr("data-model-number")&&(a=!0))})}else{var n=e.attr("data-rexlive-section-id");$defaultLayoutState.children(".section-targets").each(function(e,t){var o=$(t);n==o.attr("data-section-rex-id")&&(o.text(JSON.stringify(i)),a=!0)})}if(!a){var s={section_rex_id:e.attr("data-rexlive-section-id"),section_is_model:!1,section_model_id:"",section_model_number:-1,section_hide:!1};s.section_hide=e.hasClass("rex-hide-section"),e.hasClass("rex-model-section")&&(s.section_is_model=!0,s.section_model_id=e.attr("data-rexlive-model-id"),s.section_model_number=e.attr("data-rexlive-saved-model-number"));var d=$(document.createElement("div"));if(d.addClass("section-targets"),d.attr("data-section-rex-id",s.section_rex_id),d.attr("data-model-id",s.section_model_id),d.attr("data-model-number",s.section_model_number),d.attr("data-section-hide",s.section_hide),d.text(JSON.stringify(i)),t==-1)d.appendTo($defaultLayoutState[0]);else{var l;t-=1,$defaultLayoutState.children(".section-targets").each(function(e,i){if(e==t)return l=$(i),!1}),l.after(d[0])}}},_getDefaultLayoutState=function(){var e=[];return $defaultLayoutState.children(".section-targets").each(function(t,i){var a=$(i),o=a.attr("data-section-rex-id"),r=isNaN(parseInt(a.attr("data-model-id")))?-1:parseInt(a.attr("data-model-id")),n=isNaN(parseInt(a.attr("data-model-number")))?-1:parseInt(a.attr("data-model-number")),s="undefined"!=typeof a.attr("data-section-hide")&&"1"==a.attr("data-section-hide").toString(),d=""!=a.text()?JSON.parse(a.text()):[];e.push({section_rex_id:o,section_model_id:r!=-1?r:"",section_model_number:n!=-1?n:"",section_is_model:r!=-1,section_hide:s,targets:d})}),e},_updateSectionOrderCustomLayouts=function(e,t){console.log(e),console.log(t);var i,a,o,r,n=Rexbuilder_Util.getPageCustomizationsDom();for(o=0;o<t.length;o++)if(t[o].rexID==e.rexID&&t[o].modelNumber==e.modelNumber&&t[o].modelID==e.modelID){a=o;break}for(console.log(a),o=0;o<n.length;o++){for(i=!1,r=0;r<n[o].sections.length;r++)if(n[o].sections[r].section_is_model){if(n[o].sections[r].section_model_id==e.modelID&&n[o].sections[r].section_model_number==e.modelNumber){"undefined"!=typeof n[o].sections[r].section_created_live&&"true"==n[o].sections[r].section_created_live.toString()&&(i=!0);break}}else if(e.rexID==n[o].sections[r].section_rex_id){"undefined"!=typeof n[o].sections[r].section_created_live&&"true"==n[o].sections[r].section_created_live.toString()&&(i=!0);break}if(i){var s=n[o].sections.splice(r,1)[0];n[o].sections.splice(a,0,s)}}Rexbuilder_Util.updatePageCustomizationsDomOrder(n)},_updateSectionStateLive=function(e){Rexbuilder_Dom_Util.fixModelNumbersSaving();var t=Rex_Save_Listeners.createTargets(e,Rexbuilder_Util.activeLayout),i=!1;if(e.hasClass("rex-model-section")){var a=e.attr("data-rexlive-model-id");$liveDataContainer.children().each(function(e,o){var r=$(o);a==r.attr("data-model-id")&&(r.text(JSON.stringify(t)),i=!0)})}else{var o=e.attr("data-rexlive-section-id");$liveDataContainer.children().each(function(e,a){var r=$(a);o==r.attr("data-section-rex-id")&&(r.text(JSON.stringify(t)),i=!0)})}if(!i){var r={section_rex_id:e.attr("data-rexlive-section-id"),section_is_model:!1,section_model_id:"",section_model_number:-1,section_hide:!1};r.section_hide=e.hasClass("rex-hide-section"),e.hasClass("rex-model-section")&&(r.section_is_model=!0,r.section_model_id=e.attr("data-rexlive-model-id"),r.section_model_number=e.attr("data-rexlive-saved-model-number"));var n=$(document.createElement("div"));n.addClass("section-targets"),n.attr("data-section-rex-id",r.section_rex_id),n.attr("data-model-id",r.section_model_id),n.attr("data-model-number",r.section_model_number),n.attr("data-section-hide",r.section_hide),n.text(JSON.stringify(t)),n.appendTo($liveDataContainer[0])}},_getGridLayoutLive=function(e){var t,i={layout:"fixed",fullHeight:!1,collapsed:!1};if(e.hasClass("rex-model-section")){var a=e.attr("data-rexlive-model-id");$liveDataContainer.children(".section-targets").each(function(e,i){var o=$(i);a==o.attr("data-model-id")&&(t=JSON.parse(o.text()))})}else{var o=e.attr("data-rexlive-section-id");$liveDataContainer.children(".section-targets").each(function(e,i){var a=$(i);o==a.attr("data-section-rex-id")&&(t=JSON.parse(a.text()))})}return i.layout=t[0].props.layout,i.fullHeight=t[0].props.full_height,i.collapsed=t[0].props.collapse_grid,i},_getLayoutSectionTargets=function(e,t){t="undefined"==typeof t?"default":t;var i,a,o=[];if(e.hasClass("rex-model-section")){var r=e.attr("data-rexlive-model-id"),n=_getModelsCustomizations();for(i=0;i<n.length;i++)if(n[i].id==r){for(a=0;a<n[i].customizations.length;a++)if(n[i].customizations[a].name==t){o=jQuery.extend(!0,[],n[i].customizations[a].targets);break}break}}else{var s=e.attr("data-rexlive-section-id"),d=_getPageCustomizations();for(i=0;i<d.length;i++)if(d[i].name==t&&"undefined"!=typeof d[i].sections){for(a=0;a<d[i].sections.length;a++)if(d[i].sections[a].section_rex_id==s){o=jQuery.extend(!0,[],d[i].sections[a].targets);break}break}}return o},_getDefaultBlockProps=function(e,t){var i,a=_getLayoutSectionTargets(e,"default"),o={};for(i=1;i<a.length;i++)if(a[i].name==t){o=jQuery.extend(!0,{},a[i].props);break}return o},_getGridLayout=function(e,t){t="undefined"==typeof t?"default":t;var i,a,o={layout:"fixed",fullHeight:!1,collapsed:!1};if(e.hasClass("rex-model-section")){var r=e.attr("data-rexlive-model-id"),n=_getModelsCustomizations();for(i=0;i<n.length;i++)if(n[i].id==r){for(a=0;a<n[i].customizations.length;a++)if(n[i].customizations[a].name==t){o.layout=n[i].customizations[a].targets[0].props.layout,o.fullHeight=n[i].customizations[a].targets[0].props.full_height,o.collapsed=n[i].customizations[a].targets[0].props.collapse_grid;break}break}}else{var s=e.attr("data-rexlive-section-id"),d=_getPageCustomizations();for(i=0;i<d.length;i++)if(d[i].name==t&&"undefined"!=typeof d[i].sections&&null!==typeof d[i].sections){for(a=0;a<d[i].sections.length;a++)if(d[i].sections[a].section_rex_id==s){0!=d[i].sections[a].targets.length&&(o.layout=d[i].sections[a].targets[0].props.layout,o.fullHeight=d[i].sections[a].targets[0].props.full_height,o.collapsed=d[i].sections[a].targets[0].props.collapse_grid);
break}break}}return o},_customizationExists=function(e){var t,i=!1,a=$("#rexbuilder-layout-data .available-layouts-names"),o=[];for(""!=a.text()&&(o=JSON.parse(a.text())),t=0;t<o.length;t++)if(o[t]==e){i=!0;break}return i},updateSection=function(e,t,i,a){var o=e.children(".section-data"),r=isNaN(parseInt(i.video_bg_id))?"":parseInt(i.video_bg_id),n="undefined"==typeof i.video_bg_url_section?"":i.video_bg_url_section,s="undefined"==typeof i.video_bg_url_vimeo_section?"":i.video_bg_url_vimeo_section,d="";""!=r?d="mp4":""!=s?d="vimeo":""!=n&&(d="youtube");var l={mp4Data:{idMp4:r,linkMp4:"undefined"==typeof i.video_mp4_url?"":i.video_mp4_url,width:"",height:""},vimeoUrl:s,youtubeUrl:n,audio:!1,typeVideo:d};Rexbuilder_Dom_Util.updateSectionVideoBackground(e,l);var u={active:"undefined"==typeof i.image_bg_section_active||i.image_bg_section_active.toString(),idImage:isNaN(parseInt(i.id_image_bg_section))?"":parseInt(i.id_image_bg_section),urlImage:i.image_bg_section,width:parseInt(i.image_width),height:parseInt(i.image_height)},c={color:i.row_overlay_color,active:"undefined"!=typeof i.row_overlay_active&&i.row_overlay_active.toString()};Rexbuilder_Dom_Util.updateImageBG(e,u);var _={color:i.color_bg_section,active:"undefined"==typeof i.color_bg_section_active||i.color_bg_section_active.toString()};Rexbuilder_Dom_Util.updateSectionBackgroundColor(e,_),Rexbuilder_Dom_Util.updateSectionOverlay(e,c);var m={top:isNaN(parseInt(i.row_margin_top))?0:parseInt(i.row_margin_top),right:isNaN(parseInt(i.row_margin_right))?0:parseInt(i.row_margin_right),bottom:isNaN(parseInt(i.row_margin_bottom))?0:parseInt(i.row_margin_bottom),left:isNaN(parseInt(i.row_margin_left))?0:parseInt(i.row_margin_left)};Rexbuilder_Dom_Util.updateSectionMargins(e,m);var p={gutter:i.block_distance,row_separator_top:i.row_separator_top,row_separator_bottom:i.row_separator_bottom,row_separator_right:i.row_separator_right,row_separator_left:i.row_separator_left,full_height:i.full_height,layout:i.layout,section_width:i.section_width,dimension:i.dimension,collapse_grid:"undefined"!=typeof i.collapse_grid&&("true"==i.collapse_grid.toString()||a)};Rexbuilder_Dom_Util.updateRow(e,o,t,p);var g="undefined"==typeof i.section_name?"":i.section_name;Rexbuilder_Dom_Util.updateSectionName(e,g),e.attr("data-type",i.type);var f="undefined"==typeof i.custom_classes?"":i.custom_classes,h=[];""!=f&&(f=f.trim(),h=f.split(/\s+/)),Rexbuilder_Dom_Util.updateCustomClasses(e,h);var v="undefined"!=typeof i.section_edited&&"true"==i.section_edited.toString();e.attr("data-rexlive-section-edited",v)},_updateElementDimensions=function(e,t,i){var a=parseInt(i.x),o=parseInt(i.y),r=parseInt(i.w),n=parseInt(i.h),s=parseInt(i.startH);"undefined"!=typeof i.gridstackInstance?i.gridstackInstance.update(e[0],a,o,r,n):(e.attr("data-gs-height",n),e.attr("data-gs-width",r),e.attr("data-gs-y",o),e.attr("data-gs-x",a)),t.attr("data-gs_start_h",s),t.attr("data-gs_width",r),t.attr("data-gs_height",n),t.attr("data-gs_y",o),t.attr("data-gs_x",a)},addPhotoSwipeElement=function(e,t,i,a,o){tmpl.arg="image";var r=e.parents(".grid-stack-item-content");if(console.log("have to add photoswipe?"),0==e.parents(".pswp-figure").length){console.log("yes?"),e.parent().prepend(tmpl("tmpl-photoswipe-block",{link:t,width:i,height:a,type:o}));var n=r.find(".pswp-item");e.detach().appendTo(n)}},removePhotoSwipeElement=function(e){var t=e.parents(".pswp-figure");if(0!=t.length){var i=t.parent();e.detach().appendTo(i),t.remove()}},initPhotoSwipe=function(e){for(var t=function(e){for(var t,i,a,o,r=$(e).find(".pswp-figure").get(),n=r.length,s=[],d=0;d<n;d++)t=r[d],1===t.nodeType&&(i=t.children[0],a=i.getAttribute("data-size").split("x"),o={src:i.getAttribute("href"),w:parseInt(a[0],10),h:parseInt(a[1],10)},t.children.length>1&&(o.title=t.children[1].innerHTML),i.children.length>0&&(o.msrc=i.children[0].getAttribute("data-thumburl")),o.el=t,s.push(o));return s},i=function u(e,t){return e&&(t(e)?e:u(e.parentNode,t))},a=function(t){if(t=t||window.event,!($(t.target).parents(".perfect-grid-item").find(".element-link").length>0||$(t.target).is("a"))){t.preventDefault?t.preventDefault():t.returnValue=!1;var a=t.target||t.srcElement,o=i(a,function(e){return e.tagName&&"FIGURE"===e.tagName.toUpperCase()});if(o){for(var n,s=$(o).parents(e)[0],d=$(s).find(".pswp-figure").get(),l=d.length,u=0,c=0;c<l;c++)if(1===d[c].nodeType){if(d[c]===o){n=u;break}u++}return n>=0&&r(n,s),!1}}},o=function(){var e=window.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),a=0;a<i.length;a++)if(i[a]){var o=i[a].split("=");o.length<2||(t[o[0]]=o[1])}return t.gid&&(t.gid=parseInt(t.gid,10)),t},r=function(e,i,a,o){var r,n,s,d=document.querySelectorAll(".pswp")[0];if(s=t(i),n={galleryUID:i.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(e){var t=s[e].el.getElementsByClassName("pswp-item-thumb")[0],i=s[e].el.getElementsByClassName("rex-custom-scrollbar")[0],a=window.pageYOffset||document.documentElement.scrollTop,o=i.getBoundingClientRect(),r=t.getAttribute("data-thumb-image-type");return"natural"==r?{x:o.left,y:o.top+a,w:o.width}:null},closeOnScroll:!1,showHideOpacity:!0},o)if(n.galleryPIDs){for(var l=0;l<s.length;l++)if(s[l].pid==e){n.index=l;break}}else n.index=parseInt(e,10)-1;else n.index=parseInt(e,10);isNaN(n.index)||(a&&(n.showAnimationDuration=0),r=new PhotoSwipe(d,PhotoSwipeUI_Default,s,n),r.init())},n=document.querySelectorAll(e),s=0,d=n.length;s<d;s++)n[s].setAttribute("data-pswp-uid",s+1),n[s].onclick=a;var l=o();l.pid&&l.gid&&r(l.pid,n[l.gid-1],!0,!0)},_detect_mobile=function(){"ontouchstart"in document.documentElement?document.documentElement.className+=" touch":document.documentElement.className+=" no-touch"},_viewport=function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}},getYoutubeID=function(e){var t;return t=e.indexOf("youtu.be")>0?e.substr(e.lastIndexOf("/")+1,e.length):e.indexOf("http")>-1?e.match(/[\\?&]v=([^&#]*)/)[1]:e.length>15?null:e},_getQueryVariable=function(e){for(var t=window.location.search.substring(1),i=t.split("&"),a=0;a<i.length;a++){var o=i[a].split("=");if(o[0]==e)return o[1]}return!1},_checkPresentationPage=function(){return 0!==$(".rexpansive_portfolio_presentation").length},_checkStaticPresentationPage=function(){return 0!==$(".rexpansive-static-portfolio").length},_checkPost=function(){return 0!==$("#rex-article").length},_whichTransitionEvent=function(){var e,t=document.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in i)if(void 0!==t.style[e])return i[e]},_whichAnimationEvent=function(){var e,t=document.createElement("fakeelement"),i={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in i)if(void 0!==t.style[e])return i[e]},addWindowListeners=function(){function e(){return Rexbuilder_Util.windowIsResizing=!0,Rexbuilder_Util.editorMode&&!Rexbuilder_Util_Editor.buttonResized?void(Rexbuilder_Util.windowIsResizing=!1):(Rexbuilder_Util.editorMode?(Rexbuilder_Util_Editor.buttonResized=!1,_edit_dom_layout(Rexbuilder_Util_Editor.clickedLayoutID)):(_edit_dom_layout(chooseLayout()),_updateGridsHeights()),Rexbuilder_Util.windowIsResizing=!1,void(i=!0))}var t,i=!0;Rexbuilder_Util.$window.on("resize",function(a){Rexbuilder_Util_Editor.elementIsResizing||(a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation(),Rexbuilder_Util.windowIsResizing=!0,i&&(Rexbuilder_Util.$rexContainer.find(".grid-stack-row").each(function(e,t){var i=$(t).data().plugin_perfectGridGalleryEditor;void 0!==i&&i.removeScrollbars()}),i=!1),clearTimeout(t),t=setTimeout(e,1e3))})},_updateGridsHeights=function(){Rexbuilder_Util.$rexContainer.find(".grid-stack-row").each(function(e,t){var i=$(t).data().plugin_perfectGridGalleryEditor;void 0!==i&&(i.batchGridstack(),i._defineDynamicPrivateProperties(),i.updateGridstackStyles(),i.updateBlocksHeight(),i.commitGridstack(),setTimeout(i.createScrollbars(),200))})},_stopBlockVideos=function(e){_stopVideo(e.find(".grid-item-content"))},_playBlockVideos=function(e){_playVideoFromBegin(e.find(".grid-item-content"))},_stopPluginsSection=function(e){var t=e.find(".mp4-player"),i=e.find(".vimeo-player"),a=e.find(".youtube-player");$.each(t,function(e,t){Rexbuilder_Util.stopVideo($(t))}),$.each(i,function(e,t){Rexbuilder_Util.stopVideo($(t))}),$.each(a,function(e,t){Rexbuilder_Util.stopVideo($(t))})},_playPluginsSection=function(e){var t=e.find(".mp4-player"),i=e.find(".vimeo-player"),a=e.find(".youtube-player");$.each(t,function(e,t){Rexbuilder_Util.playVideoFromBegin($(t))}),$.each(i,function(e,t){Rexbuilder_Util.playVideoFromBegin($(t))}),$.each(a,function(e,t){Rexbuilder_Util.playVideoFromBegin($(t))})},_stopVideo=function(e){if(e.hasClass("mp4-player")){var t=e.children(".rex-video-wrap").find("video")[0];t.currentTime=0,t.pause()}else if(e.hasClass("vimeo-player"))VimeoVideo.findVideo(e.children(".rex-video-vimeo-wrap").find("iframe")[0]).unload();else if(e.hasClass("youtube-player")){if(void 0===e.children(".rex-youtube-wrap").YTPGetPlayer())return;e.children(".rex-youtube-wrap").YTPStop()}},_fixVideosAudioSection=function(e){var t=e.find(".mp4-player"),i=e.find(".vimeo-player"),a=e.find(".youtube-player");Rexbuilder_Util.fixVideoAudio(e),$.each(t,function(e,t){Rexbuilder_Util.fixVideoAudio($(t))}),$.each(i,function(e,t){Rexbuilder_Util.fixVideoAudio($(t))}),$.each(a,function(e,t){Rexbuilder_Util.fixVideoAudio($(t))})},_fixYoutube=function(e){var t=e.find(".rex-youtube-wrap");$.each(t,function(e,t){var i=$(t),a=i.parents(".youtube-player").eq(0).children(".rex-video-toggle-audio"),o=i.YTPGetPlayer();void 0!==o&&(i.optimizeDisplay(),i.YTPPlay(),0==a.length||a.hasClass("user-has-muted")?(o.mute(),o.isMute=!0,o.setVolume(0)):i.YTPUnmute())})},_fixVideoAudio=function(e){var t=e.children("rex-video-toggle-audio");if(e.hasClass("mp4-player")){var i=e.children(".rex-video-wrap").find("video")[0];0==t.length||t.hasClass("user-has-muted")?$(i).prop("muted",!0):$(i).prop("muted",!1)}else if(e.hasClass("vimeo-player")){var a=VimeoVideo.findVideo(e.children(".rex-video-vimeo-wrap").find("iframe")[0]);0==t.length||t.hasClass("user-has-muted")?a.setVolume(0):a.setVolume(1)}else if(e.hasClass("youtube-player")){var o=e.children(".rex-youtube-wrap"),r=o.YTPGetPlayer();void 0!==r&&(0==t.length||t.hasClass("user-has-muted")?(r.mute(),r.isMute=!0,r.setVolume(0)):o.YTPUnmute())}},_playVideoFromBegin=function(e){if(e.hasClass("mp4-player")){var t=e.children(".rex-video-wrap").find("video")[0];t.currentTime=0,t.play()}else if(e.hasClass("vimeo-player")){var i=VimeoVideo.findVideo(e.children(".rex-video-vimeo-wrap").find("iframe")[0]);i.play()}else if(e.hasClass("youtube-player")){var a=e.children(".rex-youtube-wrap");if(0==a.length)return;var o=a.YTPGetPlayer();if(void 0===o)return;a.YTPPlay()}setTimeout(function(){Rexbuilder_Util.fixVideoAudio(e)},500,e)},_destroyVideoPlugins=function(){},_launchVideoPlugins=function(){jQuery.browser.mobile?Rexbuilder_Util.$rexContainer.find(".rex-youtube-wrap").each(function(i,el){var $this=$(el),data_yt=eval("("+$this.attr("data-property")+")"),url=data_yt.videoURL,id=getYoutubeID(url);$this.css("background-image","url(http://img.youtube.com/vi/"+id+"/0.jpg)"),$this.click(function(e){e.preventDefault(),window.location.href=url})}):Rexbuilder_Util.$rexContainer.find(".rex-youtube-wrap").each(function(e,t){var i=$(t);return void 0!==i.YTPGetPlayer()||i.hasClass("youtube-player-launching")?void i.removeClass("youtube-player-launching"):void i.YTPlayer()}),VimeoVideo.init()},setContainer=function(e){this.$rexContainer=e},_has_class=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},_transitionEvent="",_animationEvent="",_scroll_timing=600,_getGalleryInstance=function(e){return e.find(".grid-stack-row").data().plugin_perfectGridGalleryEditor},removeCollapsedGrids=function(){Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(){if(Rexbuilder_Util.galleryPluginActive){var e=_getGalleryInstance($(this));Rexbuilder_Dom_Util.collapseGrid(e,!1,e.properties.dispositionBeforeCollapsing,e.properties.layoutBeforeCollapsing)}})},collapseAllGrids=function(){Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(){if(Rexbuilder_Util.galleryPluginActive){var e=_getGalleryInstance($(this));e._defineDynamicPrivateProperties(),e.collapseElements()}})},_startVideoPlugin=function(e){if(e.hasClass("mp4-player"));else if(e.hasClass("vimeo-player")){var t=e.children(".rex-video-vimeo-wrap").find("iframe")[0],i={autoplay:!0,background:!0,loop:!0};VimeoVideo.addPlayer("1",t,i)}else e.hasClass("youtube-player")&&void 0===e.children(".rex-youtube-wrap").YTPGetPlayer()&&e.children(".rex-youtube-wrap").YTPlayer()},_destroyVideo=function(e,t){var i="";return e.hasClass("mp4-player")?(i="mp4",Rexbuilder_Dom_Util.removeMp4Video(e,t)):e.hasClass("vimeo-player")?(i="vimeo",Rexbuilder_Dom_Util.removeVimeoVideo(e,t)):e.hasClass("youtube-player")&&(i="youtube",Rexbuilder_Dom_Util.removeYoutubeVideo(e,t)),i},_pauseVideo=function(e){if(e.hasClass("mp4-player"))e.children(".rex-video-wrap").find("video")[0].pause();else if(e.hasClass("vimeo-player")){var t=VimeoVideo.findVideo(e.children(".rex-video-vimeo-wrap").find("iframe")[0]);t.pause()}else if(e.hasClass("youtube-player")){if(void 0===e.children(".rex-youtube-wrap").YTPGetPlayer())return;e.children(".rex-youtube-wrap").YTPPause()}},_playAllVideos=function(){Rexbuilder_Util.$rexContainer.children(".rexpansive_section").each(function(e,t){var i=$(t),a=i.find(".mp4-player"),o=i.find(".vimeo-player"),r=i.find(".youtube-player");$.each(a,function(e,t){Rexbuilder_Util.playVideo($(t))}),$.each(o,function(e,t){Rexbuilder_Util.playVideo($(t))}),$.each(r,function(e,t){Rexbuilder_Util.playVideo($(t))})})},_playVideo=function(e){if(e.hasClass("mp4-player"))e.find("video")[0].play();else if(e.hasClass("vimeo-player")){var t=VimeoVideo.findVideo(e.find("iframe")[0]);t.play()}else if(e.hasClass("youtube-player")){if(0==e.children(".rex-youtube-wrap").length)return;if(void 0===e.children(".rex-youtube-wrap").YTPGetPlayer())return;e.children(".rex-youtube-wrap").YTPPlay()}},_getBackgroundUrlFromCss=function(e){return e.replace("url(","").replace(")","").replace(/\"/gi,"")},_getPaddingsDataString=function(e){var t={top:"5",right:"5",bottom:"5",left:"5",type:"px"};if(""!=e){var i=e.split(/;/gm);t.top=parseInt(i[0].split(/\D+/gm)[0]),t.right=parseInt(i[1].split(/\D+/gm)[0]),t.bottom=parseInt(i[2].split(/\D+/gm)[0]),t.left=parseInt(i[3].split(/\D+/gm)[0]);var a="";a=i[0].indexOf("%")!=-1?"%":"px",t.type=a}return t},_paddingsToString=function(e){var t="";return t+=""+e.top+e.type+";",t+=""+e.right+e.type+";",t+=""+e.bottom+e.type+";",t+=""+e.left+e.type+";"},init=function(){this.firstStart=!0,_plugin_frontend_settings.scroll_animation_offset=0,_plugin_frontend_settings.user.logged&&_plugin_frontend_settings.user.editing?this.editorMode=!0:this.editorMode=!1,this.$window=$(window),this.$body=$("body"),$modelsCustomizationsDataDiv=$("#rexbuilder-model-data").children(".models-customizations").eq(0),$pageCustomizationsDataDiv=$("#rexbuilder-layout-data").children(".layouts-customizations").eq(0),$liveDataContainer=$("#rexbuilder-layout-data-live"),$layoutsDomOrder=$("#rexbuilder-layouts-sections-order"),$defaultLayoutState=$("#rexbuilder-default-layout-state"),this.$rexContainer=$(".rex-container"),this.backendEdited=!1,"true"==Rexbuilder_Util.$rexContainer.attr("data-backend-edited").toString()&&(Rexbuilder_Util.$rexContainer.addClass("backend-edited"),this.backendEdited=!0),this.lastSectionNumber=-1,this.activeLayout="",this.domUpdaiting=!1;var e=this.$rexContainer.children(".rexpansive_section").eq(0).attr("data-rex-collapse-grid");this.blockGridUnder768="undefined"!=typeof e&&"false"==e.toString(),this.chosenLayoutData=null,_updateSectionsID(),Rexbuilder_Dom_Util.fixModelNumbers(),Rexbuilder_Dom_Util.fixModelNumbersSaving();var t=chooseLayout();_edit_dom_layout(t),_updateSectionsNumber(),_detect_mobile(),this._transitionEvent=_whichTransitionEvent(),this._animationEvent=_whichAnimationEvent(),this.scrollbarProperties={className:"os-theme-dark",overflowBehavior:{x:"hidden"},autoUpdate:!1},this.galleryPluginActive=!1,this.firstStart=!1};return{init:init,viewport:_viewport,getYoutubeID:getYoutubeID,transitionEvent:_transitionEvent,animationEvent:_animationEvent,getQueryVariable:_getQueryVariable,checkPresentationPage:_checkPresentationPage,checkStaticPresentationPage:_checkStaticPresentationPage,checkPost:_checkPost,$window:$window,scroll_timing:_scroll_timing,fixSectionWidth:fixSectionWidth,editorMode:editorMode,windowIsResizing:windowIsResizing,addWindowListeners:addWindowListeners,launchVideoPlugins:_launchVideoPlugins,destroyVideoPlugins:_destroyVideoPlugins,stopPluginsSection:_stopPluginsSection,playPluginsSection:_playPluginsSection,stopBlockVideos:_stopBlockVideos,playBlockVideos:_playBlockVideos,chooseLayout:chooseLayout,setContainer:setContainer,createSectionID:_createSectionID,createBlockID:createBlockID,has_class:_has_class,responsiveLayouts:responsiveLayouts,defaultLayoutSections:defaultLayoutSections,edit_dom_layout:_edit_dom_layout,smoothScroll:_smoothScroll,getGalleryInstance:_getGalleryInstance,removeCollapsedGrids:removeCollapsedGrids,collapseAllGrids:collapseAllGrids,stopVideo:_stopVideo,playVideoFromBegin:_playVideoFromBegin,pauseVideo:_pauseVideo,playVideo:_playVideo,destroyVideo:_destroyVideo,startVideoPlugin:_startVideoPlugin,getBackgroundUrlFromCss:_getBackgroundUrlFromCss,getPaddingsDataString:_getPaddingsDataString,paddingsToString:_paddingsToString,playAllVideos:_playAllVideos,findLayoutType:_findLayoutType,updateModelsLive:_updateModelsLive,getLayoutSectionTargets:_getLayoutSectionTargets,updateElementDimensions:_updateElementDimensions,getGridLayout:_getGridLayout,customizationExists:_customizationExists,getDefaultBlockProps:_getDefaultBlockProps,fixVideosAudioSection:_fixVideosAudioSection,fixVideoAudio:_fixVideoAudio,fixYoutube:_fixYoutube,getModelsCustomizations:_getModelsCustomizations,updateModelsCustomizationsData:_updateModelsCustomizationsData,getPageCustomizations:_getPageCustomizations,updatePageCustomizationsData:_updatePageCustomizationsData,updatePageAvaiableLayoutsNames:_updatePageAvaiableLayoutsNames,getPageAvaiableLayoutsNames:_getPageAvaiableLayoutsNames,updateDivModelCustomizationsNames:_updateDivModelCustomizationsNames,getSectionCustomLayouts:_getSectionCustomLayouts,getLayoutLiveSectionTargets:_getLayoutLiveSectionTargets,getGridLayoutLive:_getGridLayoutLive,updateSectionStateLive:_updateSectionStateLive,updatePageCustomizationsDomOrder:_updatePageCustomizationsDomOrder,getPageCustomizationsDom:_getPageCustomizationsDom,updateDefaultLayoutState:_updateDefaultLayoutState,updateDefaultLayoutStateSection:_updateDefaultLayoutStateSection,updateDefaultLayoutStateDOMOrder:_updateDefaultLayoutStateDOMOrder,getDefaultLayoutState:_getDefaultLayoutState,updateSectionOrderCustomLayouts:_updateSectionOrderCustomLayouts,updateGridsHeights:_updateGridsHeights}}(jQuery);
var RexSlider=function(e){"use strict";var i=".rex-slider-wrap",t=".rex-slider-element",r=".flickity-page-dots.rex-slider__custom-nav",n=".rexpansive_section",a=".rex-box-slider-wrap",l=".rex-box-slider-element",d=function(i){var n={cellAlign:"left",prevNextButtons:!1,pageDots:!1,cellSelector:t,selectedAttraction:.018,friction:.3,wrapAround:!0,arrowShape:"M 71.080084,1.034481 C 71.763642,0.34482599 72.61809,-1.250001e-8 73.557983,-1.250001e-8 c 0.939893,0 1.794341,0.34482600250001 2.477899,1.03448101250001 1.367117,1.37931 1.367117,3.620689 0,5 L 32.459031,49.999998 76.035882,93.965515 c 1.367117,1.379311 1.367117,3.62069 0,5 -1.367117,1.379315 -3.588681,1.379315 -4.955798,0 L 25.025333,52.499998 c -1.367117,-1.37931 -1.367117,-3.62069 0,-5 l 46.054751,-46.465517 0,0 z"};n.setGallerySize="undefined"!=typeof i.attr("data-set-gallery-size")&&JSON.parse(i.attr("data-set-gallery-size"));var a=i.attr("data-rex-slider-animation");"undefined"!=typeof a&&"1"==a.toString()&&(n.autoPlay=!0);var l=i.attr("data-rex-slider-prev-next");"undefined"!=typeof l&&"1"==l.toString()&&(n.prevNextButtons=!0);var d=i.attr("data-rex-slider-dots");"undefined"!=typeof d&&"1"==d.toString()&&(n.pageDots=!0),i.hasClass("rex-slider--bottom-interface")&&i.parents(".block-has-slider").addClass("block-has-slider--navigator"),i.find(".rex-slider-element").each(function(i,t){var r=e(t).find(".rex-slider-video-wrapper");Rexbuilder_Util.startVideoPlugin(r)}),i.flickity(n),i.flickity("stopPlayer"),Rexbuilder_Util.$window.on("resize",function(){i.data("flickity")&&i.flickity("resize")}),i.on("dragStart.flickity",function(){e(this).addClass("is-dragging")}),i.on("dragEnd.flickity",function(){e(this).removeClass("is-dragging")}),i.on("select.flickity",function(i,t){var r=e(i.target),n=r.find(".rex-slider-element.is-selected .rex-slider-video-wrapper");r.find(".rex-slider-video-wrapper").each(function(i,t){t!=n[0]&&Rexbuilder_Util.pauseVideo(e(t))}),Rexbuilder_Util.playVideo(n)}),a&&i.flickity("playPlayer"),i.attr("data-rex-slider-active",!0),i.find(r).children().first().addClass("is-selected"),i.find(r).on("click",".dot",function(t){var r=e(this),n=r.index();r.addClass("is-selected").siblings(".dot").removeClass("is-selected"),i.flickity("select",n)})},s=function(i){var t={cellAlign:"center",prevNextButtons:!0,pageDots:!0,cellSelector:l,selectedAttraction:.018,friction:.3,initialIndex:"undefined"!=typeof e(i).attr("data-rex-box-slider-initialIndex")?parseInt(e(i).attr("data-rex-box-slider-initialIndex")):0,setGallerySize:!1,arrowShape:"m 38.79662,40.087413 0,0 c -0.387529,0 -0.757576,-0.154429 -1.031468,-0.425408 L 1.2470862,3.1322842 c -0.56818177,-0.5681815 -0.56818177,-1.4918411 0,-2.060023 0.5681819,-0.56818197 1.4918415,-0.56818197 2.0600234,0 L 38.793706,36.570513 74.294872,1.0722612 c 0.568182,-0.56818197 1.491842,-0.56818197 2.060023,0 0.568182,0.5681819 0.568182,1.4918415 0,2.060023 L 39.825175,39.659091 c -0.273893,0.273893 -0.641026,0.428322 -1.028555,0.428322 l 0,0 0,0 z"},r=e(i).attr("data-rex-slider-animation");"undefined"!=typeof r&&"true"==r&&(t.autoPlay=!0),e(i).flickity(t),e(i).flickity("stopPlayer"),Rexbuilder_Util.$window.on("resize",function(){e(i).flickity("resize")}),e(i).on("dragStart.flickity",function(){e(this).addClass("is-dragging")}),e(i).on("dragEnd.flickity",function(){e(this).removeClass("is-dragging")})},o=function(){e(i,n).length>0&&e(i,n).each(function(i,t){RexSlider.initSlider(e(t)),e(t).attr("data-rex-slider-number",i),Rexbuilder_Dom_Util.lastSliderNumber=i}),e(a,n).length>0&&e(a,n).each(function(e,i){s(i)})},c=function(i){"undefined"!=typeof i.data("flickity")&&i.flickity("destroy"),i.find(".rex-slider-video-wrapper").each(function(i,t){Rexbuilder_Util.destroyVideo(e(t),!1)})},f=function(){e(i,n).length>0&&e(i,n).each(function(i,t){c(e(t))}),e(a,n).length>0&&e(a,n).each(function(i,t){c(e(t))})},u=function(){e(i,n).length&&e(i,n).each(function(i,t){var r=e(t).attr("data-rex-slider-animation");"undefined"!=typeof r&&"true"==r&&e(t).flickity("playPlayer")})},y=function(){o()};return{init:y,initSlider:d,startAutoPlay:u,destroy:f,destroySliderPlugins:c}}(jQuery);
/**
 * JS object to fix CF7 forms if user wants some materialize style
 */
var Rexbuilder_FormFixes=function(e){"use strict";var c,n=function(){c=Rexbuilder_Util.$rexContainer.find(".wpcf7-form")},i=function(){c.each(function(c,n){var i=e(n);i.hasClass("rxcf7-custom-checkbox")&&(i.find(".wpcf7-checkbox").each(function(c,n){e(n).find("label").length>0&&e(n).find("input[type=checkbox]").after('<span class="rex-checkbox__indicator"></span>')}),i.find(".wpcf7-acceptance").each(function(c,n){e(n).find("label").length>0&&e(n).find("input[type=checkbox]").after('<span class="rex-checkbox__indicator"></span>')})),i.hasClass("rxcf7-custom-loader")&&i.find(".ajax-loader").append('<div class="sk-double-bounce"><div class="sk-child sk-double-bounce1"></div><div class="sk-child sk-double-bounce2"></div></div>')})},t=function(){document.addEventListener("wpcf7submit",function(c){var n=e(c.srcElement).parents(".perfect-grid-gallery");n.length>0&&setTimeout(function(){n.perfectGridGallery("refreshGrid")},200)},!1)},a=function(){n(),t(),i()};return{init:a}}(jQuery);
var VimeoVideo=function(e){"use strict";var i=null,o=null,n=function(){i=Rexbuilder_Util.$rexContainer.find(".rex-video-vimeo-wrap--section"),o=Rexbuilder_Util.$rexContainer.find(".rex-video-vimeo-wrap--block")},t=function(){i.length>0&&i.each(function(i,o){var n=e(o).find("iframe")[0];if("undefined"!=typeof Vimeo){var t=new Vimeo.Player(n);t.ready().then(function(){t.setVolume(0)})}})},r=function(i){var n=i;o.length>0&&o.each(function(i,o){var t=e(o).attr("data-vimeo-video-mute"),r=e(o).find("iframe")[0];"undefined"!=typeof Vimeo&&n.addPlayer(t,r)})},l=function(e,i,o){if("undefined"!=typeof this.blockVideos){var n;n="undefined"!=typeof o?new Vimeo.Player(i,o):new Vimeo.Player(i),"1"==e&&n.ready().then(function(){n.setVolume(0)});var t={el:i,player:n};this.blockVideos.push(t)}},d=function(e){if(void 0!==this.blockVideos)for(var i=0;i<this.blockVideos.length;i++)if(this.blockVideos[i].el===e)return this.blockVideos[i].player;return null},a=function(e){var i,o=!1;for(i=0;i<this.blockVideos.length;i++)if(this.blockVideos[i].el===e){this.blockVideos[i].player.destroy().then(function(){})["catch"](function(e){}),o=!0;break}o&&this.blockVideos.splice(i,1)},f=function(){this.blockVideos=[],n(),t(),r(this)};return{init:f,findVideo:d,initBlockVideos:r,addPlayer:l,removePlayer:a}}(jQuery);
var lodash=_.noConflict(),Rexbuilder_App=function(e){"use strict";var t=null,i=null,n=function(){if(Rexbuilder_Util.init(),Rexbuilder_Dom_Util.init(),Rexbuilder_Util.editorMode&&(Rexbuilder_Util_Editor.init(),Rexbuilder_Section.init(),Rexbuilder_Block.init(),Rexbuilder_Util_Editor.addDocumentListeners(),Rexbuilder_Util_Editor.addWindowListeners()),Rex_Navigator.init(),Rexbuilder_Util.addWindowListeners(),t=Rexbuilder_Util.$rexContainer.find(".rexpansive_section"),i=Rexbuilder_Util.$rexContainer.find(".grid-stack-row"),i.perfectGridGalleryEditor(),Rexbuilder_Util.editorMode||(t.each(function(t,i){var n=i.getElementsByClassName("pswp-figure");0===n.length&&e(i).removeClass("photoswipe-gallery")}),a(".photoswipe-gallery")),1==_plugin_frontend_settings.native_scroll_animation){for(var n=['[href="#"]',".no-smoothing",".vertical-nav-link",".rex-vertical-nav-link",".woocommerce-review-link"],l=Rexbuilder_Util.$body.find('a[href*="#"]'),o=0;o<n.length;o++)l=l.not(n[o]);l=l.not(d),l.click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=e(this.hash);if(t=t.length?t:Rexbuilder_Util.$rexContainer.find("[name="+this.hash.slice(1)+"]"),t.length)return Rexbuilder_Util.smoothScroll(t),!1}});var d=function(t){return 0!=e(this).parents(".woocommerce-tabs").length}}r(),RexSlider.init(),Rexbuilder_Util.launchVideoPlugins(),Rexbuilder_Util.playAllVideos()},r=function(){e(document).on("YTPStart",function(t){var i=e(t.target),n=i.parents(".youtube-player").eq(0).children(".rex-video-toggle-audio"),r=i.YTPGetPlayer();void 0!==r&&(i.optimizeDisplay(),0==n.length||n.hasClass("user-has-muted")?(r.mute(),r.isMute=!0,r.setVolume(0)):i.YTPUnmute())}),e(document).on("click",".YTPOverlay",function(t){var i=e(t.target).parents(".rex-youtube-wrap");if(i.length>0){var n=i[0].state;1==n?i.YTPPause():i.YTPPlay()}}),e(document).on("click",".perfect-grid-item",function(){if(!e(this).hasClass("block-has-slider")){var t=e(this).find(".grid-item-content"),i=t.children(".rex-youtube-wrap"),n=t.children(".rex-video-vimeo-wrap--block"),r=t.children(".rex-video-wrap");if(i.length>0){var l=i[0].state;1==l?i.YTPPause():i.YTPPlay()}if(n.length>0){var a=VimeoVideo.findVideo(n.find("iframe")[0]);a&&a.getPaused().then(function(e){e?a.play():a.pause()})["catch"](function(e){})}if(r.length>0){var o=r.find(".rex-video-container").get(0);o.paused?o.play():o.pause()}}}),e(document).on("click",".rex-video-toggle-audio",function(t){t.stopPropagation();var i=e(this),n=i.parents(".youtube-player").eq(0).children(".rex-youtube-wrap"),r=i.parents(".mp4-player").eq(0).find(".rex-video-container"),l=i.parents(".vimeo-player").eq(0).find(".rex-video-vimeo-wrap--block");if(n.length>0){var a=n.get(0).player.isMuted();a?(n.YTPUnmute(),i.removeClass("user-has-muted")):(n.YTPMute(),i.addClass("user-has-muted"))}if(r.length>0&&(r.prop("muted")?(r.prop("muted",!1),i.removeClass("user-has-muted")):(r.prop("muted",!0),i.addClass("user-has-muted"))),l.length>0){var o=VimeoVideo.findVideo(l.find("iframe")[0]);o&&o.getVolume().then(function(e){0==e?(o.setVolume(1),i.removeClass("user-has-muted")):(o.setVolume(0),i.addClass("user-has-muted"))})["catch"](function(e){})}})},l=function(){var n=e(".text-fill-container-canvas");n.length>0&&(n.textFill({relative:!0,relativeWrap:".perfect-grid-item",fontFamily:_plugin_frontend_settings.textFill.font_family,fontWeight:_plugin_frontend_settings.textFill.font_weight}),n.on("textfill-render-complete",function(){Rexbuilder_Util.$window.resize()})),RexSlider.startAutoPlay(),i.find(".rex-indicator__placeholder").rexIndicator(),t.rexScrolled({callback:function(t){if(Rexbuilder_Util.has_class(t,"rex-element--animated")){var i=e(t);i.addClass("run-animation").on(Rexbuilder_Util.transitionEvent,function(e){})}}}),"undefined"!=typeof _plugin_frontend_settings&&1==_plugin_frontend_settings.animations&&e(".rs-animation").rexScrollify({mobile:!1}),Rexbuilder_Util.galleryPluginActive=!0},a=function(t){for(var i=function(t){for(var i,n,r,l,a=e(t).find(".pswp-figure").get(),o=a.length,d=[],u=0;u<o;u++)i=a[u],1===i.nodeType&&(n=i.children[0],r=n.getAttribute("data-size").split("x"),l={src:n.getAttribute("href"),w:parseInt(r[0],10),h:parseInt(r[1],10)},i.children.length>1&&(l.title=i.children[1].innerHTML),n.children.length>0&&(l.msrc=n.children[0].getAttribute("data-thumburl")),l.el=i,d.push(l));return d},n=function c(e,t){return e&&(t(e)?e:c(e.parentNode,t))},r=function(i){if(i=i||window.event,!(e(i.target).parents(".perfect-grid-item").find(".element-link").length>0||e(i.target).is("a"))){i.preventDefault?i.preventDefault():i.returnValue=!1;var r=i.target||i.srcElement,l=n(r,function(e){return e.tagName&&"FIGURE"===e.tagName.toUpperCase()});if(l){for(var o,d=e(l).parents(t)[0],u=e(d).find(".pswp-figure").get(),s=u.length,c=0,f=0;f<s;f++)if(1===u[f].nodeType){if(u[f]===l){o=c;break}c++}return o>=0&&a(o,d),!1}}},l=function(){var e=window.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),n=0;n<i.length;n++)if(i[n]){var r=i[n].split("=");r.length<2||(t[r[0]]=r[1])}return t.gid&&(t.gid=parseInt(t.gid,10)),t},a=function(e,t,n,r){var l,a,o,d=document.querySelectorAll(".pswp")[0];if(o=i(t),a={galleryUID:t.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(e){var t=o[e].el.getElementsByClassName("pswp-item-thumb")[0],i=o[e].el.getElementsByClassName("rex-custom-scrollbar")[0],n=window.pageYOffset||document.documentElement.scrollTop,r=i.getBoundingClientRect(),l=t.getAttribute("data-thumb-image-type");return"natural"==l?{x:r.left,y:r.top+n,w:r.width}:null},closeOnScroll:!1,showHideOpacity:!0},r)if(a.galleryPIDs){for(var u=0;u<o.length;u++)if(o[u].pid==e){a.index=u;break}}else a.index=parseInt(e,10)-1;else a.index=parseInt(e,10);isNaN(a.index)||(n&&(a.showAnimationDuration=0),l=new PhotoSwipe(d,PhotoSwipeUI_Default,o,a),l.init())},o=document.querySelectorAll(t),d=0,u=o.length;d<u;d++)o[d].setAttribute("data-pswp-uid",d+1),o[d].onclick=r;var s=l();s.pid&&s.gid&&a(s.pid,o[s.gid-1],!0,!0)};return{init:n,load:l}}(jQuery);!function(e){"use strict";e(function(){Rexbuilder_App.init()}),e(window).load(function(){Rexbuilder_App.load()})}(jQuery);