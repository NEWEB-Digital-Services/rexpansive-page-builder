/**
 * Object that contains the image media uploader
 * Admin side
 * @since 2.0.0
 */
var Rexlive_MediaUploader=function(e){"use strict";function t(e){if(n)return n.state("insert-image").set("liveTarget",e.sectionTarget),n.state("insert-image").set("eventName",e.returnEventName),void n.open();var t=wp.media.controller.Library.extend({defaults:_.defaults({id:"insert-image",title:"Insert Image",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!0,library:wp.media.query({type:"image"}),liveTarget:e.sectionTarget,eventName:e.returnEventName,type:"image"},wp.media.controller.Library.prototype.defaults)});n=wp.media({button:{text:"Select"},state:"insert-image",states:[new t]}),n.on("select",function(){var t=n.state("insert-image"),a=t.get("liveTarget"),i=t.get("eventName"),d=t.get("selection"),o={eventName:i,data_to_send:{info:e,media:[],sectionTarget:a}};d&&(d.each(function(e){var a=t.display(e).toJSON(),i=e.toJSON();wp.media.view.settings.captions||delete i.caption,a=wp.media.string.props(a,i);var d={media_info:i,display_info:a};o.data_to_send.media.push(d)}),Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(o))}),n.on("close",function(){}),n.on("open",function(){var e=n.state("insert-image").get("selection");e.each(function(t){if("undefined"!=typeof t){var a=wp.media.attachment(t.attributes.id);a.fetch(),e.remove(a?[a]:[])}})}),n.open()}function a(e){if(s)return s.state("live-image").set("liveTarget",e.sectionTarget).set("selected_image",e.idImage).set("eventName",e.returnEventName).set("data_to_send",e.data_to_send),void s.open();var t=wp.media.controller.Library.extend({defaults:_.defaults({id:"live-image",title:"Insert Image",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!1,library:wp.media.query({type:"image"}),liveTarget:e.sectionTarget,eventName:e.returnEventName,data_to_send:e.data_to_send,selected_image:e.idImage,type:"image"},wp.media.controller.Library.prototype.defaults)});s=wp.media({button:{text:"Select"},state:"live-image",states:[new t]}),s.on("select",function(){var e=s.state("live-image"),t=e.get("liveTarget"),a=e.get("eventName"),i=e.get("data_to_send"),d=e.get("selection"),o={eventName:a,data_to_send:{sectionTarget:t,target:t}};d&&(d.each(function(t){var a=e.display(t).toJSON(),d=t.toJSON();wp.media.view.settings.captions||delete d.caption,a=wp.media.string.props(a,d),o.data_to_send.idImage=d.id,o.data_to_send.urlImage=a.src,o.data_to_send.width=a.width,o.data_to_send.height=a.height,"undefined"!=typeof i.photoswipe&&(o.data_to_send.photoswipe=i.photoswipe),"undefined"!=typeof i.active&&(o.data_to_send.active=i.active),"undefined"!=typeof i.typeBGimage&&(o.data_to_send.typeBGimage=i.typeBGimage)}),Rexbuilder_Util_Admin_Editor.highlightRowSetData({image_bg_section_active:o.data_to_send.active,image_bg_section:o.data_to_send.urlImage,id_image_bg_section:o.data_to_send.idImage}),Rexbuilder_Util_Admin_Editor.updateBkgrImgTool(),o.data_to_send.tools=i.tools,Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(o))}),s.on("close",function(){}),s.on("open",function(){var e,t=s.state("live-image").get("selection");t.each(function(a){e=wp.media.attachment(a.attributes.id),e.fetch(),t.remove(e?[e]:[])});var a=s.state("live-image").get("selected_image");a&&(e=wp.media.attachment(a),e.fetch(),t.add(e?[e]:[]))}),s.open()}function i(e,t,a){if(a="undefined"!=typeof a?a:null,r)return r.state("upload-image-bg").set("$data",e),r.state("upload-image-bg").set("$preview",t),r.state("upload-image-bg").set("image_id",a),void r.open();var i=wp.media.controller.Library.extend({defaults:_.defaults({id:"upload-image-bg",title:"Select Background Image",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!1,library:wp.media.query({type:"image"}),type:"image",$data:e,$preview:t,image_id:a},wp.media.controller.Library.prototype.defaults)});r=wp.media({button:{text:"Select"},state:"upload-image-bg",states:[new i]}),r.on("close",function(){var t=r.state("upload-image-bg").get("selection");0==t.length&&e.val()}),r.on("select",function(){var e=r.state("upload-image-bg"),t=e.get("selection");t&&t.each(function(t){var a=e.display(t).toJSON(),i=t.toJSON();wp.media.view.settings.captions||delete i.caption,a=wp.media.string.props(a,i);var d=r.state("upload-image-bg").get("$data");d.val(i.id),d.attr("data-rex-image-bg-url",a.src),d.attr("data-rex-image-width",a.width),d.attr("data-rex-image-height",a.height),r.state("upload-image-bg").get("$preview").css("backgroundImage","url("+i.url+")"),r.state("upload-image-bg").get("$preview").children().css("display","none"),0!=d.parents("#rex-edit-background-section").length?Background_Section_Image_Modal.updateImageBackground():0!=d.parents("#block-edit-image-bg").length?Background_Block_Image_Modal.updateImageBackground():0!=d.parents("#block-edit-image-setting-bg").length&&Background_Block_Image_Setting.updateImageBackground()})}),r.on("open",function(){var e,t=r.state("upload-image-bg").get("selection");t.each(function(a){e=wp.media.attachment(a.attributes.id),e.fetch(),t.remove(e?[e]:[])});var a=r.state("upload-image-bg").get("image_id");a&&(e=wp.media.attachment(a),e.fetch(),t.add(e?[e]:[]))}),r.open()}function d(e){if(l)return void l.open();var t=wp.media.controller.Library.extend({defaults:_.defaults({id:"insert-video",title:"Insert Video",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!0,library:wp.media.query({type:"video"}),type:"video"},wp.media.controller.Library.prototype.defaults)});l=wp.media({button:{text:"Select"},state:"insert-video",states:[new t]}),l.on("close",function(){}),l.on("select",function(){var e=l.state("insert-video"),t=e.get("selection"),a=[];t&&(t.each(function(t){var i={videoID:-1,videoUrl:"",width:"",height:""},d=e.display(t).toJSON(),o=t.toJSON();wp.media.view.settings.captions||delete o.caption,d=wp.media.string.props(d,o),i.videoID=o.id,i.videoUrl=o.url,i.width=o.width,i.height=o.height,a.push(i)}),Insert_Video_Modal.updateMp4VideoModal(a))}),l.on("open",function(){var e=l.state("insert-video").get("selection");e.each(function(t){if("undefined"!=typeof t){var a=wp.media.attachment(t.attributes.id);a.fetch(),e.remove(a?[a]:[])}})}),l.open()}function o(e,t){if(t="undefined"!=typeof t?t:null,g)return g.state("upload-video-bg").set("$data",e),g.state("upload-video-bg").set("video_id",t),void g.open();var a=wp.media.controller.Library.extend({defaults:_.defaults({id:"upload-video-bg",title:"Select Background Image",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!1,library:wp.media.query({type:"video"}),type:"video",$data:e,video_id:t},wp.media.controller.Library.prototype.defaults)});g=wp.media({button:{text:"Select"},state:"upload-video-bg",states:[new a]}),g.on("close",function(){var t=g.state("upload-video-bg").get("selection");0==t.length&&e.val()}),g.on("select",function(){var e=g.state("upload-video-bg"),t=e.get("selection");t&&t.each(function(t){var a=e.display(t).toJSON(),i=t.toJSON();wp.media.view.settings.captions||delete i.caption,a=wp.media.string.props(a,i);var d=g.state("upload-video-bg").get("$data");d.val(i.id),d.attr("data-rex-video-bg-url",i.url),d.attr("data-rex-video-bg-width",i.width),d.attr("data-rex-video-bg-height",i.height),0!=d.parents("#video-section-editor-wrapper").length?(Section_Video_Background_Modal.updateVideoBackground(),Section_Video_Background_Modal.updateVideoMp4Link(i.url)):0!=d.parents("#video-block-editor-wrapper").length&&(Block_Video_Background_Modal.updateVideoBackground(),Block_Video_Background_Modal.updateVideoMp4Link(i.url))})}),g.on("open",function(){var e,t=g.state("upload-video-bg").get("selection");t.each(function(a){e=wp.media.attachment(a.attributes.id),e.fetch(),t.remove(e?[e]:[])});var a=g.state("upload-video-bg").get("video_id");a&&(e=wp.media.attachment(a),e.fetch(),t.add(e?[e]:[]))}),g.open()}var n,r,s,l,g;return{openInsertImageBlocksMediaUploader:t,openEditImageMediaUploader:i,openImageLiveMediaUploader:a,openInsertVideoBlocksMediaUploader:d,openMediaUploaderVideo:o}}(jQuery);
/**
 * Object that contains the TextEditor definition
 */
var Rexpansive_Builder_Admin_TextEditor=function(e){"use strict";var i,d,t,a,n,l=function(i,t,a,l){a="undefined"!=typeof a&&a,l="undefined"!=typeof l?l:[];var r=tinyMCE.get("rexbuilder_editor");"undefined"!=typeof i&&null!==i&&n.val(i),"undefined"==typeof r||null===r?(e("#rexbuilder_editor").val(t),e("#rexbuilder_editor").text(t)):(r.setContent(t),r.save({no_events:!0})),Rexpansive_Builder_Admin_Modals.OpenModal(d,a,l)},r=function(){t.on("click",function(e){e.preventDefault(),n.val(""),Rexpansive_Builder_Admin_Modals.CloseModal(d,!1,["hide-padding-position"]),tinyMCE.triggerSave()}),a.on("click",function(e){e.preventDefault(),a.val(""),n.val(""),Rexpansive_Builder_Admin_Modals.CloseModal(Rexpansive_Builder_Admin_PaddingEditor.$modal_wrap,!0),Rexpansive_Builder_Admin_Modals.CloseModal(Rexpansive_Builder_Admin_PositionEditor.$modal_wrap,!0),Rexpansive_Builder_Admin_Modals.CloseModal(d,!1,["hide-padding-position"])}),n.on("click",function(i){i.preventDefault(),"new-block"==a.val()&&(Rexpansive_Builder_Admin_Utilities.createNewTextBlock(),Rexpansive_Builder_Admin_Utilities.launchTooltips()),tinyMCE.triggerSave();var t=(tinyMCE.get("rexbuilder_editor"),e("#rexbuilder_editor")),n=t.val(),l=e(e(this).val()),r=l.attr("data-block_type");switch(r){case"image":l.find(".element-preview .backend-image-preview").empty().append(n.replace(/'/gi,"’"));break;case"slide":l.find("textarea[name=rex-slider--slide-text]").text(n.replace(/'/gi,"’")),""!=n?l.find(".rex-slider__slide-edit[value=text]").addClass("rex-slider__slide-edit__field-active-notice"):l.find(".rex-slider__slide-edit[value=text]").removeClass("rex-slider__slide-edit__field-active-notice");break;case"empty":l.attr("data-block_type","text").removeClass("empty").addClass("text").find(".element-preview").empty().append(n.replace(/'/gi,"’"));break;default:l.find(".element-preview").empty().append(n.replace(/'/gi,"’"))}l.find(".data-text-content").text(n.replace(/'/gi,"’")),a.val(""),Rexpansive_Builder_Admin_Modals.CloseModal(Rexpansive_Builder_Admin_PaddingEditor.$modal_wrap,!0),Rexpansive_Builder_Admin_Modals.CloseModal(Rexpansive_Builder_Admin_PositionEditor.$modal_wrap,!0),Rexpansive_Builder_Admin_Modals.CloseModal(d,!1,["hide-padding-position"]),e(document).trigger("rexbuilder:block_content_edit",l)})},o=function(){i=e("#rexeditor-modal"),d=i.parent(".rex-modal-wrap"),t=e("#rexeditor-close"),a=e("#editor-cancel"),n=e("#editor-save")},_=function(){o(),r(),this.$text_editor=i,this.$text_editor_modal_wrap=d};return{init:_,openTextEditor:l}}(jQuery);
var Rexlive_Modals_Utils=function(e){"use strict";var o,a,t,i=function(a,t,i,d){if(t="undefined"!=typeof t&&t,i="undefined"!=typeof i?i:[],d="undefined"!=typeof d&&d,t?a.addClass("rex-in--up"):(e("body").addClass("rex-modal-open"),o.show()),a.addClass("rex-modal--active").fadeIn({duration:300}),i.length)for(var s=0;s<i.length;s++)a.find(".rex-modal").addClass(i[s]);d&&l(a.find(".rex-modal"),{x:100,y:0}),n(a.find(".rex-modal"))},d=function(a,t,i){if(t="undefined"!=typeof t&&t,i="undefined"!=typeof i?i:[],t||a.hasClass("rex-in--up")||(e("body").removeClass("rex-modal-open"),o.hide()),a.removeClass("rex-modal--active").fadeOut({duration:300}),a.hasClass("rex-in--up")&&a.removeClass("rex-in--up"),a.children().removeClass("rex-modal__bottom-arrow--active").removeClass("rex-modal__top-arrow--active"),i.length)for(var d=0;d<i.length;d++)a.find(".rex-modal").removeClass(i[d]);var l={eventName:"rexlive:close_modal"};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l),n(a.find(".rex-modal"))},n=function(e){e.css("height","auto"),e.css("width","auto")},l=function(e,o){if("undefined"!=typeof o&&null!==o){var a=e.actual("height");e.css("left",o.x-Rexlive_Base_Settings.viewport().width/2+"px"),a<o.y?(e.addClass("rex-modal__bottom-arrow--active"),e.css("top",o.y-a+t.y+"px")):(e.addClass("rex-modal__top-arrow--active"),e.css("top",o.y+t.y+"px"))}else e.css("left","0px"),e.css("top","50px")},s=function(){Rexlive_Base_Settings.$document.on("click",".rex-modal-wrap",function(o){o.target===this&&d(e(this))}),Rexlive_Base_Settings.$document.on("keydown",function(e){27===e.keyCode&&r()})},r=function(){if(Rexbuilder_Util_Admin_Editor.$body.hasClass("rex-modal-open")){var e=Rexbuilder_Util_Admin_Editor.$body.find(".rex-modal--active");0<e.length&&d(e)}},c=function(){o=e(".lean-overlay"),a=e(".rex-modal-draggable"),a.each(function(o,a){var t=e(a);t.draggable({cancel:"input,textarea,button,select,option,.rex-check-icon, .input-field, .rex-slider__slide-edit, #rex-css-ace-editor, #rex-html-ace-editor, label",stop:function(o,a){n(e(this))}})}),t={x:0,y:-20},s()};return{init:c,openModal:i,closeModal:d,resetModalDimensions:n,close_focus_modal:r,positionModal:l}}(jQuery);
/**
 * Object that handles the Modal of the video inserting
 * @since 2.0.0
 */
var Insert_Video_Modal=function(e){"use strict";var o,i,t,a=function(e){n(),t=e.sectionTarget,Rexlive_Modals_Utils.openModal(o.$self.parent(".rex-modal-wrap"))},d=function(){Rexlive_Modals_Utils.closeModal(o.$self.parent(".rex-modal-wrap"))},r=function(){o.$youTubeWrap.removeClass("selected"),o.$vimeoWrap.removeClass("selected"),o.$mp4Wrap.removeClass("selected"),o.$radioChooseYoutube.attr("checked",!1),o.$radioChooseVimeo.attr("checked",!1),o.$radioChooseMp4.attr("checked",!1)},n=function(){o.$linkVimeo.val(""),o.$linkYoutube.val(""),o.$linkMp4.val("").next("label").removeClass("active"),r()},l=function(){o.$youTubeWrap.addClass("selected"),o.$radioChooseYoutube.attr("checked",!0)},s=function(){o.$vimeoWrap.addClass("selected"),o.$radioChooseVimeo.attr("checked",!0)},u=function(){o.$mp4Wrap.addClass("selected"),o.$radioChooseMp4.attr("checked",!0)},c=function(e){i=e,o.$linkMp4.val(e[0].videoUrl).next("label").addClass("active")},p=function(){o.$self.find(".input-field").click(function(o){o.preventDefault(),r();var i=e(o.target);i.is("div")||(i=i.parents(".input-field"));var t=i.attr("data-rex-video-type");switch(t){case"youtube":l();break;case"vimeo":s();break;case"mp4":u()}}),o.$close_modal_btn.click(function(e){e.preventDefault(),d()}),o.$self.find(".set-video-audio-btn").click(function(o){o.preventDefault();var i=e(o.target),t=i.parents(".set-video-audio-btn"),a=t.find(".video-audio-checkbox"),d=a.attr("checked");d=!d,a.attr("checked",d)}),o.$self.find(".rex-video-type-select").click(function(o){o.preventDefault(),r();var i=e(o.target);0!=i.parents(".youtube-insert-wrap").length?l():0!=i.parents(".vimeo-insert-wrap").length?s():0!=i.parents(".mp4-insert-wrap").length&&u()}),o.$self.find("#rex-upload-mp4-video").click(function(e){Rexlive_MediaUploader.openInsertVideoBlocksMediaUploader()}),o.$self.find("#rex-insert-video-block-save").click(function(e){var a,r,n,l,s,u=o.$self.find(".video-insert-wrap.selected");u.hasClass("youtube-insert-wrap")?(a="youtube",r=o.$linkYoutube.val(),s=o.$audioYoutube.attr("checked")):u.hasClass("vimeo-insert-wrap")?(a="vimeo",n=o.$linkVimeo.val(),s=o.$audioVimeo.attr("checked")):u.hasClass("mp4-insert-wrap")&&(a="mp4",l=i,s=o.$audioMp4.attr("checked")),s="undefined"!=typeof s&&"checked"==s;var c={eventName:"rexlive:insert_video",data_to_send:{urlYoutube:r,urlVimeo:n,videoMp4:l,hasAudio:s,typeVideo:a,sectionTarget:t}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(c),d()})},v=function(){var t=e("#rex-insert-new-video-block");o={$self:t,$close_modal_btn:t.find(".rex-modal__close-button"),$linkYoutube:t.find("#rex-insert-youtube-url"),$linkVimeo:t.find("#rex-insert-vimeo-url"),$linkMp4:t.find("#rex-insert-mp4-url"),$audioYoutube:t.find("#rex-new-block-video-youtube-audio"),$audioVimeo:t.find("#rex-new-block-video-vimeo-audio"),$audioMp4:t.find("#rex-new-block-video-mp4-audio"),$radioChooseYoutube:t.find("#rex-choose-youtube-video"),$radioChooseVimeo:t.find("#rex-choose-vimeo-video"),$radioChooseMp4:t.find("#rex-choose-mp4-video"),$youTubeWrap:t.find("#insert-video-block-wrap-1"),$vimeoWrap:t.find("#insert-video-block-wrap-2"),$mp4Wrap:t.find("#insert-video-block-wrap-3")},i=null,p()};return{init:v,openVideoModal:a,updateMp4VideoModal:c}}(jQuery);
/**
 * Row Fixed/Masonry Logic
 * 
 * @since 2.0.0
 */
var LayoutGrid_Modal=function(t){"use strict";var e,a,i=function(t){a=t.sectionTarget,r(t.activeLayout)},n=function(){o()},o=function(){e.$section_layout_typeWrap.each(function(e,a){t(a).removeClass("selected"),t(a).find("input").attr("checked",!1)})},r=function(t){var a=e.$section_layout_types_wrap.children('[data-rex-layout="'+t+'"]');a.addClass("selected"),a.find("input").attr("checked",!0)},l=function(){var t=e.$section_layout_types_wrap,a=t.children(".selected").attr("data-rex-layout"),i={layout:a};return i},u=function(){var t=l();Rexbuilder_Util_Admin_Editor.highlightRowSetData({layout:t.layout}),Rexbuilder_Util_Admin_Editor.updateLayoutTool();var e={eventName:"rexlive:set_gallery_layout",data_to_send:{sectionTarget:a,layout:t.layout}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(e)},d=function(){Rexlive_Base_Settings.$document.on("click","#modal-background-responsive-set .rexlive-layout-type",function(e){e.preventDefault(),o();var a=t(e.target).parents(".rexlive-layout-type");a.addClass("selected"),a.find("input").attr("checked",!0),u()})},c=function(t){e={$section_layout_typeWrap:t.find(".rexlive-layout-type"),$section_layout_types_wrap:t.find(".rex-edit-layout-wrap"),$section_fixed:t.find("#section-fixed"),$section_masonry:t.find("#section-masonry")},d()};return{init:c,getData:l,updateLayoutModal:i,clearLayoutModal:n}}(jQuery);
/**
 * Row Full/Boxed logic
 * 
 * @since 2.0.0
 */
var Section_Width_Modal=function(e){"use strict";var t,i,d,n,o=function(){i.dimension="",i.sectionWidth="",i.widthType=""},a=function(e){c(),n=e.sectionTarget;var d=e.dimension,o=e.section_width,a="%",s="100";"full"!=d&&(s=parseInt(o),o.indexOf("%")==-1&&(a="px")),i.type=d,i.sectionWidth=s,i.dimension=a,t.$section_boxed_width_input.val(s);var r=t.$section_width_type.children('[data-rex-section-width="'+d+'"]');r.addClass("selected"),r.find("input").attr("checked",!0);var l=t.$section_boxed_width_wrap.children('[data-rex-section-width-type="'+a+'"]');l.addClass("selected"),l.find("input").attr("checked",!0)},c=function(){t.$section_width_type_wrap.each(function(t,i){e(i).removeClass("selected"),e(i).find("input").attr("checked",!1)}),t.$section_boxed_width_input.val("")},s=function(){t.$section_boxed_width_wrap.children().each(function(t,i){e(i).removeClass("selected"),e(i).find("input").attr("checked",!1)})},r=function(e){s(),t.$section_boxed_width_input.val(e.sectionWidth);var i=t.$section_boxed_width_wrap.children('[data-rex-section-width-type="'+e.dimension+'"]');i.addClass("selected"),i.find("input").attr("checked",!0)},l=function(){var e=t.$section_boxed_width_input.val(),i=t.$section_boxed_width_wrap.children(".selected").attr("data-rex-section-width-type");return{width:e,type:i}},h=function(){var e=t.$section_boxed_width_input.val(),i=t.$section_boxed_width_wrap.children(".selected").attr("data-rex-section-width-type");Rexbuilder_Util_Admin_Editor.highlightRowSetData({section_width:e+i,dimension:"100%"===e+i?"full":"boxed"}),Rexbuilder_Util_Admin_Editor.updateWidthTool();var d={eventName:"rexlive:set_section_width",data_to_send:{sectionWidth:{width:e,type:i},sectionTarget:n}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(d)},_=function(t){t.keydown(function(t){var i=e(t.target);return e.inArray(t.keyCode,[46,8,9,13,110])!==-1||65===t.keyCode&&(t.ctrlKey===!0||t.metaKey===!0)||t.keyCode>=35&&t.keyCode<=40?(38==t.keyCode&&(t.preventDefault(),i.val(isNaN(parseInt(i.val()))?0:parseInt(i.val())+1)),void(40==t.keyCode&&(t.preventDefault(),i.val(Math.max(isNaN(parseInt(i.val()))?0:parseInt(i.val())-1,0))))):((t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault(),void(27==t.keyCode&&i.blur()))})},p=function(e){e.keyup(function(e){(e.keyCode>=48&&e.keyCode<=57||38==e.keyCode||40==e.keyCode||8==e.keyCode)&&(e.preventDefault(),h())})},u=function(){Rexlive_Base_Settings.$document.on("click","#modal-background-responsive-set .boxed-width-type-wrap",function(i){i.preventDefault();var n="full"==t.$section_width_type.children(".selected").attr("data-rex-section-width");s();var o=e(i.target).parents(".boxed-width-type-wrap");if(o.addClass("selected"),o.find("input").attr("checked",!0),n&&"px"==o.attr("data-rex-section-width-type")){c();var a=t.$section_width_type.children('[data-rex-section-width="boxed"]');a.addClass("selected"),a.find("input").attr("checked",!0),t.$section_boxed_width_input.val(d.boxed.sectionWidth)}h()}),Rexlive_Base_Settings.$document.on("click","#modal-background-responsive-set .rexlive-section-width",function(t){t.preventDefault(),c();var n=e(t.target).parents(".rexlive-section-width");n.addClass("selected"),n.find("input").attr("checked",!0);var o=n.attr("data-rex-section-width");r(o!=i.type?"boxed"==o?d.boxed:d.full:i),h()}),p(t.$section_boxed_width_input),_(t.$section_boxed_width_input)},w=function(e){var n=e.find(".section-width-wrapper");t={$self:n,$section_width_type_wrap:n.find(".rexlive-section-width"),$section_width_type:n.find(".rex-edit-row-width"),$section_full:n.find("#section-full-modal"),$section_boxed:n.find("#section-boxed-modal"),$section_boxed_width_input:n.find(".section-set-boxed-width"),$section_boxed_width_type:n.find(".section-width-type"),$section_boxed_width_wrap:n.find(".section-set-boxed-width-wrap")},d={boxed:{type:"boxed",dimension:"%",sectionWidth:"80"},full:{type:"full",dimension:"%",sectionWidth:"100"}},i={dimension:"",sectionWidth:"",widthType:""},u()};return{init:w,resetOldWidthData:o,getData:l,clearSectionWidth:c,updateSectionWidth:a,applySectionWidth:h}}(jQuery);
var GridSeparators_Modal=function(t){"use strict";var r,e,o,a=function(){r.$block_gutter.val(e.gutter),r.$row_separator_top.val(e.top),r.$row_separator_right.val(e.right),r.$row_separator_bottom.val(e.bottom),r.$row_separator_left.val(e.left)},s=function(t){o=t.sectionTarget;var a=t.rowDistances,s=isNaN(a.gutter)?e.gutter:a.gutter,i=isNaN(a.top)?e.top:a.top,_=isNaN(a.right)?e.right:a.right,p=isNaN(a.bottom)?e.bottom:a.bottom,n=isNaN(a.left)?e.left:a.left;r.$block_gutter.val(s),r.$row_separator_top.val(i),r.$row_separator_right.val(_),r.$row_separator_bottom.val(p),r.$row_separator_left.val(n)},i=function(){var t=parseInt(r.$block_gutter.val()),o=parseInt(r.$row_separator_top.val()),a=parseInt(r.$row_separator_right.val()),s=parseInt(r.$row_separator_bottom.val()),i=parseInt(r.$row_separator_left.val()),_={gutter:isNaN(t)?e.gutter:t,top:isNaN(o)?e.top:o,right:isNaN(a)?e.right:a,bottom:isNaN(s)?e.bottom:s,left:isNaN(i)?e.left:i};return _},_=function(){var t={eventName:"rexlive:set_row_separatos",data_to_send:{distances:i(),sectionTarget:o}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(t)},p=function(r){r.keydown(function(r){var e=t(r.target);return t.inArray(r.keyCode,[46,8,9,13,110])!==-1||65===r.keyCode&&(r.ctrlKey===!0||r.metaKey===!0)||r.keyCode>=35&&r.keyCode<=40?(38==r.keyCode&&(r.preventDefault(),e.val(isNaN(parseInt(e.val()))?0:parseInt(e.val())+1)),void(40==r.keyCode&&(r.preventDefault(),e.val(Math.max(isNaN(parseInt(e.val()))?0:parseInt(e.val())-1,0))))):((r.shiftKey||r.keyCode<48||r.keyCode>57)&&(r.keyCode<96||r.keyCode>105)&&r.preventDefault(),void(27==r.keyCode&&e.blur()))})},n=function(t){t.keyup(function(t){(t.keyCode>=48&&t.keyCode<=57||38==t.keyCode||40==t.keyCode||8==t.keyCode)&&(t.preventDefault(),_())})},l=function(){p(r.$block_gutter),p(r.$row_separator_top),p(r.$row_separator_right),p(r.$row_separator_bottom),p(r.$row_separator_left),n(r.$block_gutter),n(r.$row_separator_top),n(r.$row_separator_right),n(r.$row_separator_bottom),n(r.$row_separator_left)},u=function(t){var o=t;r={$self:o,$block_gutter:o.find(".section-set-block-gutter"),$row_separator_top:o.find("#row-separator-top"),$row_separator_right:o.find("#row-separator-right"),$row_separator_bottom:o.find("#row-separator-bottom"),$row_separator_left:o.find("#row-separator-left")},e={gutter:20,top:20,right:20,bottom:20,left:20},a(),l()};return{init:u,updateDistances:s,resetDistances:a,getData:i}}(jQuery);
var SectionMargins_Modal=function(t){"use strict";var r,o,e,a=function(){r.$row_margin_top.val(o.top),r.$row_margin_right.val(o.right),r.$row_margin_bottom.val(o.bottom),r.$row_margin_left.val(o.left)},i=function(t){e=t.sectionTarget;var a=t.marginsSection,i=isNaN(a.top)?o.top:a.top,n=isNaN(a.right)?o.right:a.right,_=isNaN(a.bottom)?o.bottom:a.bottom,g=isNaN(a.left)?o.left:a.left;r.$row_margin_top.val(i),r.$row_margin_right.val(n),r.$row_margin_bottom.val(_),r.$row_margin_left.val(g)},n=function(){var t=parseInt(r.$row_margin_top.val()),e=parseInt(r.$row_margin_right.val()),a=parseInt(r.$row_margin_bottom.val()),i=parseInt(r.$row_margin_left.val()),n={top:isNaN(t)?o.top:t,right:isNaN(e)?o.right:e,bottom:isNaN(a)?o.bottom:a,left:isNaN(i)?o.left:i};return n},_=function(){var t={eventName:"rexlive:set_section_margins",data_to_send:{margins:n(),sectionTarget:e}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(t)},g=function(r){r.keydown(function(r){var o=t(r.target);return t.inArray(r.keyCode,[46,8,9,13,110])!==-1||65===r.keyCode&&(r.ctrlKey===!0||r.metaKey===!0)||r.keyCode>=35&&r.keyCode<=40?(38==r.keyCode&&(r.preventDefault(),o.val(isNaN(parseInt(o.val()))?0:parseInt(o.val())+1)),void(40==r.keyCode&&(r.preventDefault(),o.val(Math.max(isNaN(parseInt(o.val()))?0:parseInt(o.val())-1,0))))):((r.shiftKey||r.keyCode<48||r.keyCode>57)&&(r.keyCode<96||r.keyCode>105)&&r.preventDefault(),void(27==r.keyCode&&o.blur()))})},m=function(t){t.keyup(function(t){(t.keyCode>=48&&t.keyCode<=57||38==t.keyCode||40==t.keyCode||8==t.keyCode)&&(t.preventDefault(),_())})},l=function(){g(r.$row_margin_top),g(r.$row_margin_right),g(r.$row_margin_bottom),g(r.$row_margin_left),m(r.$row_margin_top),m(r.$row_margin_right),m(r.$row_margin_bottom),m(r.$row_margin_left)},s=function(t){r={$row_margin_top:t.find("#row-margin-top"),$row_margin_right:t.find("#row-margin-right"),$row_margin_bottom:t.find("#row-margin-bottom"),$row_margin_left:t.find("#row-margin-left")},o={top:0,right:0,bottom:0,left:0},a(),l()};return{init:s,updateMargins:i,resetMargins:a,getData:n}}(jQuery);
var PhotoSwipe_Modal=function(e){"use strict";var t,i,o,n=function(){t.$section_active_photoswipe.attr("checked",i)},c=function(e){o=e.sectionTarget,t.$section_active_photoswipe.attr("checked",e.photoswipe)},s=function(){var e=!0===t.$section_active_photoswipe.prop("checked")?"true":"false";return e},a=function(){var e=s(),t={eventName:"rexlive:set_row_photoswipe",data_to_send:{sectionTarget:o,photoswipe:e}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(t)},p=function(){t.$section_active_photoswipe.click(function(e){a()})},r=function(e){t={$section_active_photoswipe:e.find("#section-active-photoswipe")},i=!1,n(),p()};return{init:r,updatePhotoswipe:c,resetPhotoswipe:n,getData:s}}(jQuery);
var FullHeight_Modal=function(e){"use strict";var i,t,l,u=function(){i.$is_full.prop("checked",t)},n=function(e){l=e.sectionTarget,i.$is_full.prop("checked","true"==e.fullHeight)},r=function(){var e=!0===i.$is_full.prop("checked")?"true":"false";return e},c=function(){var e=r(),i={eventName:"rexlive:set_row_fullHeight",data_to_send:{sectionTarget:l,fullHeight:e}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(i)},f=function(){i.$is_full.click(function(){c()})},o=function(e){i={$is_full:e.find("#section-is-full")},t=!1,u(),f()};return{init:o,updateFullHeight:n,resetFullHeight:u}}(jQuery);
var SectionName_Modal=function(e){"use strict";var n,i,t,a=function(){n.$section_id.val(i)},o=function(e){t=e.sectionTarget,n.$section_id.val(e.sectionName)},c=function(){var e=n.$section_id.val();return e},r=function(){var e=c(),n={eventName:"rexlive:change_section_name",data_to_send:{sectionTarget:t,sectionName:e}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(n)},s=function(){n.$section_id.keyup(function(e){r()})},d=function(e){n={$section_id:e.find("#sectionid-container")},i="",a(),s()};return{init:d,updateSectionName:o,resetSectionName:a,getData:c}}(jQuery);
var Rexlive_Top_Tools=function(o){"use strict";var e,i=function(){e=Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.find(".rexlive-toolbox__toggle-wrap .close-toolbox")},n=function(){e.on("click",function(o){o.preventDefault(),Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.toggleClass("toolbox--closed")})},t=function(){i(),n()};return{init:t}}(jQuery);
var Section_CustomClasses_Modal=function(e){"use strict";var a,s,t,l,i=function(){a.$classes.val(s)},c=function(e){l=e.sectionTarget;var s=e.customClasses;t="",s.indexOf("active-large-overlay")!==-1&&(t+=" active-large-overlay",s=s.replace("active-large-overlay","")),s.indexOf("active-medium-overlay")!==-1&&(t+=" active-medium-overlay",s=s.replace("active-medium-overlay","")),s.indexOf("active-small-overlay")!==-1&&(t+=" active-small-overlay",s=s.replace("active-small-overlay","")),a.$classes.val(s)},r=function(){var e=n();e=e.trim();var a=e.split(/\s+/),s={eventName:"rexlive:apply_section_custom_classes",data_to_send:{sectionTarget:l,customClasses:a}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(s)},n=function(){var e=a.$classes.val();return e+=t},o=function(){a.$classes.blur(function(e){r()})},v=function(e){a={$classes:e.find("#section-set-custom-class")},s="",i(),o()};return{init:v,updateCustomClasses:c,resetCustomClasses:i,getData:n}}(jQuery);
var Section_Modal=function(o){"use strict";var t,e=function(o,e){i(),l(o),Rexlive_Modals_Utils.positionModal(t.$self,e),Rexlive_Modals_Utils.openModal(t.$self.parent(".rex-modal-wrap"))},a=function(){i(),Rexlive_Modals_Utils.closeModal(t.$self.parent(".rex-modal-wrap"))},i=function(){LayoutGrid_Modal.clearLayoutModal(),Section_Width_Modal.clearSectionWidth(),GridSeparators_Modal.resetDistances(),SectionMargins_Modal.resetMargins(),PhotoSwipe_Modal.resetPhotoswipe(),FullHeight_Modal.resetFullHeight(),SectionName_Modal.resetSectionName(),Section_CustomClasses_Modal.resetCustomClasses()},l=function(o){LayoutGrid_Modal.updateLayoutModal(o),Section_Width_Modal.updateSectionWidth(o),GridSeparators_Modal.updateDistances(o),SectionMargins_Modal.updateMargins(o),PhotoSwipe_Modal.updatePhotoswipe(o),FullHeight_Modal.updateFullHeight(o),SectionName_Modal.updateSectionName(o),Section_CustomClasses_Modal.updateCustomClasses(o)},n=function(){t.$close_button.click(function(o){o.preventDefault(),a()})},s=function(){var e=o("#modal-background-responsive-set");t={$self:e,$close_button:e.find(".rex-modal__close-button")},n(),LayoutGrid_Modal.init(e),Section_Width_Modal.init(e),GridSeparators_Modal.init(e),SectionMargins_Modal.init(e),PhotoSwipe_Modal.init(e),FullHeight_Modal.init(e),SectionName_Modal.init(e),Section_CustomClasses_Modal.init(e)};return{init:s,openSectionModal:e}}(jQuery);
/**
 * Set the row background color with the color picker
 * @since 2.0.0
 */
var Background_Section_Color_Modal=function(o){"use strict";var e,c,r,t,l,a=function(o){t=o.sectionTarget,l.data_to_send.sectionTarget=o.sectionTarget,""!=o.color?(e.$color_runtime_value.val(o.color),e.$color_preview_icon.hide(),e.$color_value.spectrum("set",o.color)):(e.$color_runtime_value.val(""),e.$color_preview_icon.show(),e.$color_value.spectrum("set","")),c=o.color,r="true"==o.active.toString(),r?e.$color_active.prop("checked",!0):e.$color_active.prop("checked",!1)},n=function(){var o=!0===e.$color_active.prop("checked");r=o;var l={eventName:"rexlive:apply_background_color_section",data_to_send:{color:r?c:"",active:r,sectionTarget:t}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l)},i=function(){l={eventName:"rexlive:change_section_bg_color",data_to_send:{color:null,sectionTarget:{}}};var t;e.$color_value.spectrum({replacerClassName:"btn-floating",preferredFormat:"hex",showPalette:!1,showAlpha:!0,showInput:!0,showButtons:!1,containerClassName:"rexbuilder-materialize-wrap block-background-color-picker",show:function(){t=!1},move:function(o){e.$color_preview_icon.hide(),l.data_to_send.color=r?o.toRgbString():"",Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l),t=!0},change:function(o){e.$color_palette_buttons.removeClass("palette-color-active")},hide:function(o){t&&(c=o.toRgbString()),console.log(c),e.$color_runtime_value.val(c),n()},cancelText:"",chooseText:""});var a=tmpl("tmpl-tool-close",{}),i=o(a);e.$color_value.spectrum("container").append(i),i.on("click",function(o){o.preventDefault(),e.$color_value.spectrum("hide")}),e.$color_palette_buttons.on("click",function(r){var t=o(r.currentTarget).find(".bg-palette-value").val();o(r.currentTarget).addClass("palette-color-active"),e.$color_preview_icon.hide(),e.$color_palette_buttons.not(r.currentTarget).removeClass("palette-color-active"),e.$color_value.spectrum("set",t),e.$color_runtime_value.val(t),c=t,n()}),o(".block-background-color-picker .sp-choose").on("click",function(){e.$color_preview_icon.hide(),e.$color_runtime_value.val(e.$color_value.spectrum("get"))}),e.$color_preview_icon.on("click",function(){return e.$color_value.spectrum("show"),!1})},_=function(o){var t=o.find("#background-section-set-color");e={$color_active:t.find("#color-section-active"),$color_active_wrapper:t.find(".bg-color-section-active-wrapper"),$color_runtime_value:t.find("#background-section-color-runtime"),$color_value:t.find("#background-section-color"),$color_preview_icon:t.find("#background-section-preview-icon"),$color_palette_wrap:t.find("#bg-section-color-palette"),$color_palette_buttons:t.find("#bg-section-color-palette .bg-palette-selector")},r=!0,i(),e.$color_active_wrapper.click(function(o){o.preventDefault();var r=!0===e.$color_active.prop("checked");r?(e.$color_active.prop("checked",!1),c=""):(e.$color_active.prop("checked",!0),c=e.$color_runtime_value.val()),n()})};return{init:_,updateColorModal:a}}(jQuery);
/**
 * Set the overlay color of a row
 * @since 2.0.0
 */
var Overlay_Color_Section_Modal=function(e){"use strict";var o,r,a,l,t=function(e){l=e.sectionTarget,a.data_to_send.sectionTarget=e.sectionTarget,""!=e.color?(o.$overlay_color_value.val(e.color),o.$overlay_color_preview_icon.hide(),o.$overlay_color_value.spectrum("set",e.color),r=e.color):(o.$overlay_color_value.val(""),o.$overlay_color_preview_icon.show()),"true"==e.active.toString()?o.$overlay_active.prop("checked",!0):o.$overlay_active.prop("checked",!1)},c=function(){var e=!0===o.$overlay_active.prop("checked"),a={eventName:"rexlive:change_section_overlay",data_to_send:{color:r,active:e,sectionTarget:l}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(a)},i=function(){a={eventName:"rexlive:change_section_overlay_color",data_to_send:{color:null,sectionTarget:{}}},o.$overlay_color_value.spectrum({replacerClassName:"btn-floating",preferredFormat:"hex",showPalette:!1,showAlpha:!0,showInput:!0,showButtons:!1,containerClassName:"rexbuilder-materialize-wrap block-overlay-color-picker",move:function(e){o.$overlay_color_preview_icon.hide(),a.data_to_send.color=e.toRgbString(),Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(a)},change:function(e){o.$overlay_color_palette_buttons.removeClass("palette-color-active")},hide:function(e){r=e.toRgbString(),c()},cancelText:"",chooseText:""});var l=tmpl("tmpl-tool-close",{}),t=e(l);o.$overlay_color_value.spectrum("container").append(t),t.on("click",function(e){e.preventDefault(),o.$overlay_color_value.spectrum("hide")}),o.$overlay_color_palette_buttons.on("click",function(a){var l=e(a.currentTarget).find(".bg-palette-value").val();e(a.currentTarget).addClass("palette-color-active"),o.$overlay_color_preview_icon.hide(),o.$overlay_color_palette_buttons.not(a.currentTarget).removeClass("palette-color-active"),o.$overlay_color_value.spectrum("set",l),r=l,c()}),e(".block-overlay-color-picker .sp-choose").on("click",function(){o.$overlay_color_preview_icon.hide()}),o.$overlay_color_preview_icon.on("click",function(){return o.$overlay_color_value.spectrum("show"),!1})},n=function(e){o={$overlay_active:e.find("#overlay-section-active"),$overlay_active_wrapper:e.find(".overlay-active-wrapper"),$overlay_color_value:e.find("#overlay-color-row-value"),$overlay_color_preview_icon:e.find("#overlay-row-preview-icon"),$overlay_color_palette_buttons:e.find("#bg-overlay-row-color-palette .bg-palette-selector")},i(),o.$overlay_active_wrapper.click(function(e){e.preventDefault();var r=!0===o.$overlay_active.prop("checked");r?o.$overlay_active.prop("checked",!1):o.$overlay_active.prop("checked",!0),c()})};return{init:n,updateOverlayModal:t}}(jQuery);
/**
 * Handling the live change of a section background
 * Admin side
 * @since 2.0.0
 */
var Background_Section_Image_Modal=function(e){"use strict";var a,i,r,t=function(e){r=e.sectionTarget,a.$image_url.val(e.idImage),""!=e.idImage&&(a.$image_preview.css("backgroundImage","url("+e.imageUrl+")"),a.$image_preview.children().css("display","none"),a.$image_url.attr("data-rex-image-bg-url",e.imageUrl),a.$image_url.attr("data-rex-image-width",e.width),a.$image_url.attr("data-rex-image-height",e.height)),i="true"==e.active.toString(),i?a.$image_active.prop("checked",!0):a.$image_active.prop("checked",!1)},g=function(){a.$image_url.val(""),a.$image_preview.css("backgroundImage",""),a.$image_preview.children().css("display","block"),a.$image_url.attr("data-rex-image-bg-url",""),a.$image_url.attr("data-rex-image-width",""),a.$image_url.attr("data-rex-image-height",""),i=!0,a.$image_active.prop("checked",!0)},d=function(){var e=!0===a.$image_active.prop("checked");i=e;var t=a.$image_url.val(),g="undefined"==typeof a.$image_url.attr("data-rex-image-bg-url")?"":a.$image_url.attr("data-rex-image-bg-url"),d="undefined"==typeof a.$image_url.attr("data-rex-image-width")?"":a.$image_url.attr("data-rex-image-width"),m="undefined"==typeof a.$image_url.attr("data-rex-image-height")?"":a.$image_url.attr("data-rex-image-height"),c={eventName:"rexlive:apply_background_image_section",data_to_send:{idImage:i?t:"",urlImage:i?g:"",width:i?d:"",height:i?m:"",active:i,sectionTarget:r}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(c)},m=function(){a.$image_active_wrapper.click(function(e){e.preventDefault();var r=!0===a.$image_active.prop("checked");r?a.$image_active.prop("checked",!1):a.$image_active.prop("checked",!0),i=r,d()}),a.$image_upload_wrap.click(function(e){Rexlive_MediaUploader.openEditImageMediaUploader(a.$image_url,a.$image_preview,a.$image_url.val())})},c=function(e){var r=e.find("#section-edit-image-bg");a={$image_upload_wrap:r.find("#bg-section-set-img-wrap"),$image_active:r.find("#image-section-active"),$image_active_wrapper:r.find(".bg-image-section-active-wrapper"),$image_preview:r.find("#bg-section-img-preview"),$image_preview_icon:r.find("#bg-section-img-preview i"),$image_url:r.find("#background-section-url"),$image_id:r.find("#background-section-up-img")},i=!0,m()};return{init:c,updateImageModal:t,resetImageModal:g,updateImageBackground:d}}(jQuery);
/**
 * Object that handles the logic of the insert/editing of the row video background
 * @since 2.0.0
 */
var Section_Video_Background_Modal=function(e){"use strict";var o,i,a,t=function(e,i){s(e.bgVideo),Rexlive_Modals_Utils.positionModal(o.$self,i),Rexlive_Modals_Utils.openModal(o.$self.parent(".rex-modal-wrap"))},l=function(){Rexlive_Modals_Utils.closeModal(o.$self.parent(".rex-modal-wrap"))},s=function(e){r(),a=e.sectionTarget,""!=e.mp4VideoID?(i="mp4",o.$linkVimeo.val(""),o.$linkYoutube.val(""),o.$linkMp4.val(e.mp4VideoID),o.$linkMp4.attr("data-rex-video-bg-url",e.mp4Video),o.$linkMp4Preview.val(e.mp4Video).next("label").addClass("active"),u()):""!=e.vimeoUrl?(i="vimeo",o.$linkVimeo.val(e.vimeoUrl),o.$linkYoutube.val(""),o.$linkMp4.val(""),o.$linkMp4.attr("data-rex-video-bg-url",""),o.$linkMp4Preview.val("").next("label").removeClass("active"),c()):""!=e.youtubeVideo&&(i="youtube",o.$linkVimeo.val(""),o.$linkYoutube.val(e.youtubeVideo),o.$linkMp4.val(""),o.$linkMp4.attr("data-rex-video-bg-url",""),o.$linkMp4Preview.val("").next("label").removeClass("active"),n())},d=function(){o.$youTubeWrap.removeClass("selected"),o.$vimeoWrap.removeClass("selected"),o.$mp4Wrap.removeClass("selected"),o.$checkboxChooseYoutube.attr("checked",!1),o.$checkboxChooseVimeo.attr("checked",!1),o.$checkboxChooseMp4.attr("checked",!1),o.$checkboxChooseYoutube.attr("disabled",!1),o.$checkboxChooseVimeo.attr("disabled",!1),o.$checkboxChooseMp4.attr("disabled",!1),o.$linkYoutube.next("label").removeClass("active"),o.$linkVimeo.next("label").removeClass("active"),o.$linkMp4Preview.next("label").removeClass("active")},r=function(){d(),i="",o.$linkVimeo.val(""),o.$linkYoutube.val(""),o.$linkMp4.val(""),o.$linkMp4Preview.val("").next("label").removeClass("active")},n=function(){o.$youTubeWrap.hasClass("selected")?(o.$youTubeWrap.removeClass("selected"),o.$checkboxChooseYoutube.attr("checked",!1),o.$checkboxChooseVimeo.attr("disabled",!1),o.$checkboxChooseMp4.attr("disabled",!1),o.$linkYoutube.attr("disabled",!1),o.$linkVimeo.attr("disabled",!1),""===o.$linkYoutube.val()&&o.$linkYoutube.next("label").removeClass("active"),i=""):(o.$checkboxChooseYoutube.attr("checked",!0),o.$checkboxChooseVimeo.attr("disabled",!0),o.$checkboxChooseMp4.attr("disabled",!0),o.$youTubeWrap.addClass("selected"),o.$linkYoutube.next("label").addClass("active"),o.$linkVimeo.attr("disabled",!0),i="youtube"),o.$vimeoWrap.removeClass("selected"),o.$mp4Wrap.removeClass("selected")},c=function(){o.$vimeoWrap.hasClass("selected")?(o.$vimeoWrap.removeClass("selected"),o.$checkboxChooseVimeo.attr("checked",!1),o.$checkboxChooseYoutube.attr("disabled",!1),o.$checkboxChooseMp4.attr("disabled",!1),o.$linkYoutube.attr("disabled",!1),o.$linkVimeo.attr("disabled",!1),""===o.$linkVimeo.val()&&o.$linkVimeo.next("label").removeClass("active"),i=""):(o.$checkboxChooseVimeo.attr("checked",!0),o.$checkboxChooseYoutube.attr("disabled",!0),o.$checkboxChooseMp4.attr("disabled",!0),o.$vimeoWrap.addClass("selected"),o.$linkVimeo.next("label").addClass("active"),o.$linkYoutube.attr("disabled",!0),i="vimeo"),o.$youTubeWrap.removeClass("selected"),o.$mp4Wrap.removeClass("selected")},u=function(){o.$mp4Wrap.hasClass("selected")?(o.$mp4Wrap.removeClass("selected"),o.$checkboxChooseMp4.attr("checked",!1),o.$checkboxChooseYoutube.attr("disabled",!1),o.$checkboxChooseVimeo.attr("disabled",!1),o.$linkYoutube.attr("disabled",!1),o.$linkVimeo.attr("disabled",!1),""===o.$linkMp4Preview.val()&&o.$linkMp4Preview.next("label").removeClass("active"),i=""):(o.$checkboxChooseMp4.attr("checked",!0),o.$checkboxChooseYoutube.attr("disabled",!0),o.$checkboxChooseVimeo.attr("disabled",!0),o.$mp4Wrap.addClass("selected"),o.$linkMp4Preview.next("label").addClass("active"),o.$linkYoutube.attr("disabled",!0),o.$linkVimeo.attr("disabled",!0),i="mp4"),o.$youTubeWrap.removeClass("selected"),o.$vimeoWrap.removeClass("selected")},p=function(){var e="",i=o.$linkYoutube.val(),t=o.$linkVimeo.val(),l={linkMp4:"undefined"==typeof o.$linkMp4.attr("data-rex-video-bg-url")?"":o.$linkMp4.attr("data-rex-video-bg-url"),idMp4:o.$linkMp4.val()},s={linkMp4:"",idMp4:""},d=o.$self.find(".video-insert-wrap.selected");d.hasClass("youtube-insert-wrap")?e="youtube":d.hasClass("vimeo-insert-wrap")?e="vimeo":d.hasClass("mp4-insert-wrap")&&(e="mp4"),Rexbuilder_Util_Admin_Editor.highlightRowSetData({video_bg_url_section:""==e||"youtube"!=e?"":i,video_bg_id_section:""==e||"mp4"!=e?"":l.idMp4,video_bg_url_vimeo_section:""==e||"vimeo"!=e?"":t,video_mp4_url:""==e||"mp4"!=e?"":l.linkMp4}),Rexbuilder_Util_Admin_Editor.updateBkgrVidTool();var r={eventName:"rexlive:update_section_background_video",data_to_send:{urlYoutube:""==e||"youtube"!=e?"":i,urlVimeo:""==e||"vimeo"!=e?"":t,videoMp4:""==e||"mp4"!=e?s:l,typeVideo:e,sectionTarget:a}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(r)},v=function(){o.$chooseVideoWrapper.click(function(o){o.preventDefault();var a=e(o.target);!a.hasClass("youtube-insert-wrap")&&0==a.parents(".youtube-insert-wrap").length||"youtube"!=i&&""!=i?!a.hasClass("vimeo-insert-wrap")&&0==a.parents(".vimeo-insert-wrap").length||"vimeo"!=i&&""!=i?!a.hasClass("mp4-insert-wrap")&&(0==a.parents(".mp4-insert-wrap").length||a.is("i"))||"mp4"!=i&&""!=i||(u(),p()):(c(),p()):(n(),p())}),o.$uploadMp4.click(function(){o.$mp4Wrap.hasClass("selected")&&Rexlive_MediaUploader.openMediaUploaderVideo(o.$linkMp4,o.$linkMp4.val())}),o.$close_button.on("click",function(e){e.preventDefault(),l()})},b=function(e){o.$linkMp4Preview.val(e).next("label").addClass("active")},$=function(){var a=e("#video-section-editor-wrapper");o={$self:a,$linkYoutube:a.find("#rex-youtube-video-section"),$linkVimeo:a.find("#rex-vimeo-video-section"),$linkMp4:a.find("#video-section-mp4-url"),$linkMp4Preview:a.find("#rex-mp4-video-section-preview"),$checkboxChooseYoutube:a.find("#rex-choose-youtube-video-section"),$checkboxChooseVimeo:a.find("#rex-choose-vimeo-video-section"),$checkboxChooseMp4:a.find("#rex-choose-mp4-video-section"),$chooseVideoWrapper:a.find(".rex-video-type-select"),$uploadMp4:a.find("#rex-upload-mp4-video-section i"),$youTubeWrap:a.find("#edit-video-row-wrap-1"),$vimeoWrap:a.find("#edit-video-row-wrap-2"),$mp4Wrap:a.find("#edit-video-row-wrap-3"),$close_button:a.find(".rex-modal__close-button")},i="",v()};return{init:$,clearVideoModal:r,updateVideoModal:s,updateVideoBackground:p,openSectionVideoBackgroundModal:t,updateVideoMp4Link:b}}(jQuery);
/**
 * Handling the image/overlay configuration of the row background
 * @since 2.0.0
 */
var SectionBackground_Modal=function(o){"use strict";var e,a=function(o){Background_Section_Color_Modal.updateColorModal(o.bgColor),Overlay_Color_Section_Modal.updateOverlayModal(o.overlay),Background_Section_Image_Modal.updateImageModal(o.imageBG),Rexlive_Modals_Utils.openModal(e.$self.parent(".rex-modal-wrap"))},n=function(){Background_Section_Image_Modal.resetImageModal(),Rexlive_Modals_Utils.closeModal(e.$self.parent(".rex-modal-wrap"))},l=function(){e.$close_button.click(function(o){o.preventDefault(),n()})},t=function(){var a=o("#rex-edit-background-section");e={$self:a,$close_button:a.find(".rex-modal__close-button")},Background_Section_Color_Modal.init(a),Background_Section_Image_Modal.init(a),Overlay_Color_Section_Modal.init(a),l()};return{init:t,openSectionBackgroundModal:a}}(jQuery);
var CssEditor_Modal=function(e){"use strict";var t,n,o,i=function(e){"undefined"==typeof e||""==e.trim()?n.setValue(o):n.setValue(e),n.clearSelection(),Rexlive_Modals_Utils.openModal(t.$modal_wrap)},s=function(){Rexlive_Modals_Utils.closeModal(t.$modal_wrap)},a=function(){t.$save_button.on("click",function(e){e.preventDefault();var o=n.getValue(),i={eventName:"rexlive:SetCustomCSS",data_to_send:{customCSS:o}};t.$self.addClass("setting-saving"),setTimeout(function(){Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(i),s(),t.$self.removeClass("setting-saving")},800)}),t.$cancel_button.on("click",function(e){s()}),t.$open_button.on("click",function(e){var t={eventName:"rexlive:getCustomCss"};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(t)})},l=function(){var i=e("#rex-css-editor");t={$self:i,$modal_wrap:null,$save_button:i.find("#css-editor-save"),$cancel_button:i.find("#css-editor-cancel"),$open_button:Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find("#open-css-editor")},n=ace.edit("rex-css-ace-editor"),t.$modal_wrap=i.parent(".rex-modal-wrap"),n.setTheme("ace/theme/monokai"),n.getSession().setMode("ace/mode/css"),n.on("change",function(e){Rexbuilder_Util_Admin_Editor.editPageProperties()}),o="",a()};return{init:l,openModal:i}}(jQuery);
/**
 * Editor for html inside blocks
 * @since 2.0.0
 */
var HtmlEditor_Modal=function(e){"use strict";var t,o,n,i=function(e){"undefined"==typeof e||""==e.trim()?o.setValue(n):o.setValue(e),o.clearSelection(),Rexlive_Modals_Utils.openModal(t.$modal_wrap)},a=function(){Rexlive_Modals_Utils.closeModal(t.$modal_wrap)},l=function(){t.$save_button.on("click",function(e){e.preventDefault();var n=o.getValue(),i={eventName:"rexlive:SetcustomHTML",data_to_send:{customHTML:n}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(i),t.$self.addClass("setting-saving").on(Rexbuilder_Util_Admin_Editor.animationEvent,function(e){a(),t.$self.removeClass("setting-saving")})}),t.$close_button.on("click",function(e){a()})},s=function(){var i=e("#rex-html-text-editor");t={$self:i,$modal_wrap:null,$save_button:i.find(".rex-modal__save-button"),$close_button:i.find(".rex-modal__close-button"),$open_button:Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find("#test-html-editor")},t.$modal_wrap=i.parent(".rex-modal-wrap"),o=ace.edit("rex-html-ace-editor"),o.setTheme("ace/theme/monokai"),o.getSession().setMode("ace/mode/html"),o.getSession().setUseWrapMode(!0),n="",l()};return{init:s,openModal:i}}(jQuery);
/**
 * Handle the background color of a block
 * @since 2.0.0
 */
var Background_Block_Color_Modal=function(o){"use strict";var e,r,c,t,l,a=function(o){t=o.target,l.data_to_send.target=o.target,""!=o.color?(e.$color_runtime_value.val(o.color),e.$color_preview_icon.hide(),e.$color_value.spectrum("set",o.color)):(e.$color_runtime_value.val(""),e.$color_preview_icon.show(),e.$color_value.spectrum("set","")),r=o.color,c="true"==o.active.toString(),c?e.$color_active.prop("checked",!0):e.$color_active.prop("checked",!1)},n=function(){var o=!0===e.$color_active.prop("checked");c=o;var l={eventName:"rexlive:apply_background_color_block",data_to_send:{color:c?r:"",active:c,target:t}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l)},i=function(){l={eventName:"rexlive:change_block_bg_color",data_to_send:{color:null,target:{}}};var t;e.$color_value.spectrum({replacerClassName:"btn-floating",preferredFormat:"hex",showPalette:!1,showAlpha:!0,showInput:!0,showButtons:!1,containerClassName:"rexbuilder-materialize-wrap block-background-color-picker",show:function(){t=!1},move:function(o){e.$color_preview_icon.hide(),l.data_to_send.color=c?o.toRgbString():"",Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l),t=!0},change:function(o){e.$color_palette_buttons.removeClass("palette-color-active")},hide:function(o){t&&(r=o.toRgbString()),e.$color_runtime_value.val(r),n()},cancelText:"",chooseText:""});var a=tmpl("tmpl-tool-close",{}),i=o(a);e.$color_value.spectrum("container").append(i),i.on("click",function(o){o.preventDefault(),e.$color_value.spectrum("hide")}),e.$color_palette_buttons.on("click",function(c){var t=o(c.currentTarget).find(".bg-palette-value").val();o(c.currentTarget).addClass("palette-color-active"),e.$color_preview_icon.hide(),e.$color_palette_buttons.not(c.currentTarget).removeClass("palette-color-active"),e.$color_value.spectrum("set",t),e.$color_runtime_value.val(t),r=t,n()}),o(".block-background-color-picker .sp-choose").on("click",function(){e.$color_preview_icon.hide(),e.$color_runtime_value.val(e.$color_value.spectrum("get"))}),e.$color_preview_icon.on("click",function(){return e.$color_value.spectrum("show"),!1})},_=function(o){var t=o.find("#background-block-set-color");e={$color_active:t.find("#color-block-active"),$color_active_wrapper:t.find(".bg-color-block-active-wrapper"),$color_runtime_value:t.find("#background-block-color-runtime"),$color_value:t.find("#background-block-color"),$color_preview_icon:t.find("#background-block-preview-icon"),$color_palette_wrap:t.find("#bg-block-color-palette"),$color_palette_buttons:t.find("#bg-block-color-palette .bg-palette-selector")},c=!0,i(),e.$color_active_wrapper.click(function(o){o.preventDefault();var c=!0===e.$color_active.prop("checked");c?(e.$color_active.prop("checked",!1),r=""):(e.$color_active.prop("checked",!0),r=e.$color_runtime_value.val()),n()})};return{init:_,updateColorModal:a}}(jQuery);
/**
 * Handling Block Overlay Color
 * @since 2.0.0
 */
var Overlay_Color_block_Modal=function(e){"use strict";var o,r,l,a,t=function(e){l=e.target,a.data_to_send.target=e.target,""!=e.color?(o.$overlay_color_value.val(e.color),o.$overlay_color_preview_icon.hide(),o.$overlay_color_value.spectrum("set",e.color),r=e.color):(o.$overlay_color_value.val(""),o.$overlay_color_preview_icon.show()),"true"==e.active.toString()?o.$overlay_active.prop("checked",!0):o.$overlay_active.prop("checked",!1)},c=function(){var e=!0===o.$overlay_active.prop("checked"),a={eventName:"rexlive:change_block_overlay",data_to_send:{color:r,active:e,target:l}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(a)},v=function(){a={eventName:"rexlive:change_block_overlay_color",data_to_send:{color:null,target:{}}},o.$overlay_color_value.spectrum({replacerClassName:"btn-floating",preferredFormat:"hex",showPalette:!1,showAlpha:!0,showInput:!0,showButtons:!1,containerClassName:"rexbuilder-materialize-wrap block-overlay-color-picker",move:function(e){o.$overlay_color_preview_icon.hide(),a.data_to_send.color=e.toRgbString(),Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(a)},change:function(e){o.$overlay_color_palette_buttons.removeClass("palette-color-active")},hide:function(e){r=e.toRgbString(),c()},cancelText:"",chooseText:""});var l=tmpl("tmpl-tool-close",{}),t=e(l);o.$overlay_color_value.spectrum("container").append(t),t.on("click",function(e){e.preventDefault(),o.$overlay_color_value.spectrum("hide")}),o.$overlay_color_palette_buttons.on("click",function(l){var a=e(l.currentTarget).find(".bg-palette-value").val();e(l.currentTarget).addClass("palette-color-active"),o.$overlay_color_preview_icon.hide(),o.$overlay_color_palette_buttons.not(l.currentTarget).removeClass("palette-color-active"),o.$overlay_color_value.spectrum("set",a),r=a,c()}),e(".block-overlay-color-picker .sp-choose").on("click",function(){o.$overlay_color_preview_icon.hide()}),o.$overlay_color_preview_icon.on("click",function(){return o.$overlay_color_value.spectrum("show"),!1})},i=function(e){var r=e.find("#bg-overlay-block-set-color");o={$overlay_active:r.find("#overlay-block-active"),$overlay_active_wrapper:r.find(".overlay-active-wrapper"),$overlay_color_value:r.find("#overlay-color-block-value"),$overlay_color_preview_icon:r.find("#overlay-block-preview-icon"),$overlay_color_palette_buttons:r.find("#bg-overlay-block-color-palette .bg-palette-selector")},v(),o.$overlay_active_wrapper.click(function(e){e.preventDefault();var r=!0===o.$overlay_active.prop("checked");r?o.$overlay_active.prop("checked",!1):o.$overlay_active.prop("checked",!0),c()})};return{init:i,updateOverlayModal:t}}(jQuery);
var Background_Block_Image_Modal=function(e){"use strict";var a,i,t,r=function(e){c(),t=e.target,a.$image_url.val(e.idImage),""!=e.idImage&&(a.$image_preview.css("backgroundImage","url("+e.imageUrl+")"),a.$image_preview.children().css("display","none"),a.$image_url.attr("data-rex-image-bg-url",e.imageUrl),a.$image_url.attr("data-rex-image-width",e.width),a.$image_url.attr("data-rex-image-height",e.height)),d(""==e.typeBGimage?e.defaultTypeImage:e.typeBGimage),p(e.photoswipe),i="true"==e.active.toString(),i?a.$image_active.prop("checked",!0):a.$image_active.prop("checked",!1)},c=function(){a.$image_url.val(""),a.$image_preview.css("backgroundImage",""),a.$image_preview.children().css("display","block"),a.$image_url.attr("data-rex-image-bg-url",""),a.$image_url.attr("data-rex-image-width",""),a.$image_url.attr("data-rex-image-height",""),i=!0,a.$image_active.prop("checked",!0),a.$checkboxPhotoswipe.prop("checked",!1),a.$image_type_typeWrap.removeClass("selected")},g=function(){var e=!0===a.$image_active.prop("checked");i=e;var r=a.$image_url.val(),c="undefined"==typeof a.$image_url.attr("data-rex-image-bg-url")?"":a.$image_url.attr("data-rex-image-bg-url"),g="undefined"==typeof a.$image_url.attr("data-rex-image-width")?"":a.$image_url.attr("data-rex-image-width"),p="undefined"==typeof a.$image_url.attr("data-rex-image-height")?"":a.$image_url.attr("data-rex-image-height"),d=a.$image_type_types_wrap,o=d.children(".selected").attr("data-rex-type-image"),m=!0===a.$checkboxPhotoswipe.prop("checked")?"true":"false",n={eventName:"rexlive:apply_background_image_block",data_to_send:{idImage:i?r:"",urlImage:i?c:"",width:i?g:"",height:i?p:"",typeBGimage:i?o:"",photoswipe:i?m:"",active:i,target:t}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(n)},p=function(e){a.$checkboxPhotoswipe.prop("checked","true"==e.toString())},d=function(e){var i=a.$image_type_types_wrap.children('[data-rex-type-image="'+e+'"]');i.addClass("selected"),i.find("input").attr("checked",!0)},o=function(){a.$image_type_typeWrap.each(function(a,i){e(i).removeClass("selected"),e(i).find("input").attr("checked",!1)})},m=function(){a.$image_active_wrapper.click(function(e){e.preventDefault();var t=!0===a.$image_active.prop("checked");t?a.$image_active.prop("checked",!1):a.$image_active.prop("checked",!0),i=t,g()}),a.$image_upload_wrap.click(function(e){Rexlive_MediaUploader.openEditImageMediaUploader(a.$image_url,a.$image_preview,a.$image_url.val())}),a.$image_type_typeWrap.click(function(a){a.preventDefault();var i=e(a.target).parents(".rex-background-image-type-wrap");i.hasClass("selected")||(o(),i.addClass("selected"),i.find("input").attr("checked",!0),g())}),a.$is_photoswipe.click(function(e){e.preventDefault();var i=!0===a.$checkboxPhotoswipe.prop("checked");i?a.$checkboxPhotoswipe.prop("checked",!1):a.$checkboxPhotoswipe.prop("checked",!0),g()})},n=function(e){var t=e.find(".background_set_image");a={$image_upload_wrap:t.find("#bg-block-set-img-wrap"),$image_active:t.find("#image-block-active"),$image_active_wrapper:t.find(".bg-image-block-active-wrapper"),$image_preview:t.find("#bg-block-img-preview"),$image_preview_icon:t.find("#bg-block-img-preview i"),$image_url:t.find("#background-block-url"),$image_id:t.find("#background-block-up-img"),$image_type_typeWrap:t.find(".rex-background-image-type-wrap"),$image_type_types_wrap:t.find("#bg-set-img-type"),$is_photoswipe:t.find("#bg-set-photoswipe"),$checkboxPhotoswipe:t.find("#background_photoswipe")},i=!0,m()};return{init:n,updateImageModal:r,resetImageModal:c,updateImageBackground:g}}(jQuery);
var Background_Block_Image_Setting=function(e){"use strict";var a,i,t,r=function(e){g(),t=e.target,a.$image_url.val(e.idImage),""!=e.idImage&&(a.$image_preview.css("backgroundImage","url("+e.imageUrl+")"),a.$image_preview.children().css("display","none"),a.$image_url.attr("data-rex-image-bg-url",e.imageUrl),a.$image_url.attr("data-rex-image-width",e.width),a.$image_url.attr("data-rex-image-height",e.height)),d(""==e.typeBGimage?e.defaultTypeImage:e.typeBGimage),p(e.photoswipe),i="true"==e.active.toString(),i?a.$image_active.prop("checked",!0):a.$image_active.prop("checked",!1)},g=function(){a.$image_url.val(""),a.$image_preview.css("backgroundImage",""),a.$image_preview.children().css("display","block"),a.$image_url.attr("data-rex-image-bg-url",""),a.$image_url.attr("data-rex-image-width",""),a.$image_url.attr("data-rex-image-height",""),i=!0,a.$image_active.prop("checked",!0),a.$checkboxPhotoswipe.prop("checked",!1),a.$image_type_typeWrap.removeClass("selected")},c=function(){var e=!0===a.$image_active.prop("checked");i=e;var r=a.$image_url.val(),g="undefined"==typeof a.$image_url.attr("data-rex-image-bg-url")?"":a.$image_url.attr("data-rex-image-bg-url"),c="undefined"==typeof a.$image_url.attr("data-rex-image-width")?"":a.$image_url.attr("data-rex-image-width"),p="undefined"==typeof a.$image_url.attr("data-rex-image-height")?"":a.$image_url.attr("data-rex-image-height"),d=a.$image_type_types_wrap,o=d.children(".selected").attr("data-rex-type-image"),m=!0===a.$checkboxPhotoswipe.prop("checked")?"true":"false",n={eventName:"rexlive:apply_background_image_block",data_to_send:{idImage:i?r:"",urlImage:i?g:"",width:i?c:"",height:i?p:"",typeBGimage:i?o:"",photoswipe:i?m:"",active:i,target:t}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(n)},p=function(e){a.$checkboxPhotoswipe.prop("checked","true"==e.toString())},d=function(e){var i=a.$image_type_types_wrap.children('[data-rex-type-image="'+e+'"]');i.addClass("selected"),i.find("input").attr("checked",!0)},o=function(){a.$image_type_typeWrap.each(function(a,i){e(i).removeClass("selected"),e(i).find("input").attr("checked",!1)})},m=function(){a.$image_active_wrapper.click(function(e){e.preventDefault();var t=!0===a.$image_active.prop("checked");t?a.$image_active.prop("checked",!1):a.$image_active.prop("checked",!0),i=t,c()}),a.$image_upload_wrap.click(function(e){Rexlive_MediaUploader.openEditImageMediaUploader(a.$image_url,a.$image_preview,a.$image_url.val())}),a.$image_type_typeWrap.click(function(a){a.preventDefault();var i=e(a.target).parents(".rex-background-image-type-wrap");i.hasClass("selected")||(o(),i.addClass("selected"),i.find("input").attr("checked",!0),c())}),a.$is_photoswipe.click(function(e){e.preventDefault();var i=!0===a.$checkboxPhotoswipe.prop("checked");i?a.$checkboxPhotoswipe.prop("checked",!1):a.$checkboxPhotoswipe.prop("checked",!0),c()})},n=function(e){var t=e.find(".background_set_image");a={$image_upload_wrap:t.find("#bg-block-set-img-wrap"),$image_active:t.find("#image-block-active"),$image_active_wrapper:t.find(".bg-image-block-active-wrapper"),$image_preview:t.find("#bg-block-img-preview"),$image_preview_icon:t.find("#bg-block-img-preview i"),$image_url:t.find("#background-block-url"),$image_id:t.find("#background-block-up-img"),$image_type_typeWrap:t.find(".rex-background-image-type-wrap"),$image_type_types_wrap:t.find("#bg-set-img-type"),$is_photoswipe:t.find("#bg-set-photoswipe"),$checkboxPhotoswipe:t.find("#background_photoswipe")},i=!0,m()};return{init:n,updateImageModal:r,resetImageModal:g,updateImageBackground:c}}(jQuery);
/**
 * Object that handles the logic of the insert/editing of the block video background
 * @since 2.0.0
 */
var Block_Video_Background_Modal=function(e){"use strict";var o,a,t,i=function(e,a){d(e.bgVideo),o.$self.attr("data-block_tools",e.bgVideo.tools),Rexlive_Modals_Utils.positionModal(o.$self,a),Rexlive_Modals_Utils.openModal(o.$self.parent(".rex-modal-wrap"))},l=function(){o.$self.attr("data-block_tools",""),Rexlive_Modals_Utils.closeModal(o.$self.parent(".rex-modal-wrap"))},d=function(e){s(),"mp4"==e.type?(a="mp4",o.$linkVimeo.val(""),o.$linkYoutube.val(""),o.$linkMp4.val(e.mp4Data.idMp4),o.$linkMp4.attr("data-rex-video-bg-url",e.mp4Data.linkMp4),o.$linkMp4.attr("data-rex-video-bg-width",e.mp4Data.width),o.$linkMp4.attr("data-rex-video-bg-height",e.mp4Data.height),o.$linkMp4Preview.val(e.mp4Data.linkMp4).next("label").addClass("active"),o.$audioMp4.prop("checked","true"==e.audio.toString()),u()):"vimeo"==e.type?(a="vimeo",o.$linkVimeo.val(e.vimeoUrl),o.$linkYoutube.val(""),o.$linkMp4.val(""),o.$linkMp4.attr("data-rex-video-bg-url",""),o.$linkMp4Preview.val("").next("label").removeClass("active"),o.$audioVimeo.prop("checked","true"==e.audio.toString()),n()):"youtube"==e.type&&(a="youtube",o.$linkVimeo.val(""),o.$linkYoutube.val(e.youtubeUrl),o.$linkMp4.val(""),o.$linkMp4.attr("data-rex-video-bg-url",""),o.$linkMp4Preview.val("").next("label").removeClass("active"),o.$audioYoutube.prop("checked","true"==e.audio.toString()),c()),t=e.target},r=function(){o.$youTubeWrap.removeClass("selected"),o.$vimeoWrap.removeClass("selected"),o.$mp4Wrap.removeClass("selected"),o.$checkboxChooseYoutube.attr("checked",!1),o.$checkboxChooseVimeo.attr("checked",!1),o.$checkboxChooseMp4.attr("checked",!1),o.$checkboxChooseYoutube.attr("disabled",!1),o.$checkboxChooseVimeo.attr("disabled",!1),o.$checkboxChooseMp4.attr("disabled",!1),o.$linkYoutube.next("label").removeClass("active"),o.$linkVimeo.next("label").removeClass("active"),o.$linkMp4Preview.next("label").removeClass("active")},s=function(){r(),a="",o.$linkVimeo.val(""),o.$linkYoutube.val(""),o.$linkMp4.val(""),o.$linkMp4Preview.val("").next("label").removeClass("active")},c=function(){o.$youTubeWrap.hasClass("selected")?(o.$youTubeWrap.removeClass("selected"),o.$checkboxChooseYoutube.attr("checked",!1),o.$checkboxChooseVimeo.attr("disabled",!1),o.$checkboxChooseMp4.attr("disabled",!1),o.$linkYoutube.attr("disabled",!1),o.$linkVimeo.attr("disabled",!1),""===o.$linkYoutube.val()&&o.$linkYoutube.next("label").removeClass("active"),a=""):(o.$checkboxChooseYoutube.attr("checked",!0),o.$checkboxChooseVimeo.attr("disabled",!0),o.$checkboxChooseMp4.attr("disabled",!0),o.$youTubeWrap.addClass("selected"),o.$linkYoutube.next("label").addClass("active"),o.$linkVimeo.attr("disabled",!0),a="youtube"),o.$vimeoWrap.removeClass("selected"),o.$mp4Wrap.removeClass("selected")},n=function(){o.$vimeoWrap.hasClass("selected")?(o.$vimeoWrap.removeClass("selected"),o.$checkboxChooseVimeo.attr("checked",!1),o.$checkboxChooseYoutube.attr("disabled",!1),o.$checkboxChooseMp4.attr("disabled",!1),o.$linkYoutube.attr("disabled",!1),o.$linkVimeo.attr("disabled",!1),""===o.$linkVimeo.val()&&o.$linkVimeo.next("label").removeClass("active"),a=""):(o.$checkboxChooseVimeo.attr("checked",!0),o.$checkboxChooseYoutube.attr("disabled",!0),o.$checkboxChooseMp4.attr("disabled",!0),o.$vimeoWrap.addClass("selected"),o.$linkVimeo.next("label").addClass("active"),o.$linkYoutube.attr("disabled",!0),a="vimeo"),o.$youTubeWrap.removeClass("selected"),o.$mp4Wrap.removeClass("selected")},u=function(){o.$mp4Wrap.hasClass("selected")?(o.$mp4Wrap.removeClass("selected"),o.$checkboxChooseMp4.attr("checked",!1),o.$checkboxChooseYoutube.attr("disabled",!1),o.$checkboxChooseVimeo.attr("disabled",!1),o.$linkYoutube.attr("disabled",!1),o.$linkVimeo.attr("disabled",!1),""===o.$linkMp4Preview.val()&&o.$linkMp4Preview.next("label").removeClass("active"),a=""):(o.$checkboxChooseMp4.attr("checked",!0),o.$checkboxChooseYoutube.attr("disabled",!0),o.$checkboxChooseVimeo.attr("disabled",!0),o.$mp4Wrap.addClass("selected"),o.$linkMp4Preview.next("label").addClass("active"),o.$linkYoutube.attr("disabled",!0),o.$linkVimeo.attr("disabled",!0),a="mp4"),o.$youTubeWrap.removeClass("selected"),o.$vimeoWrap.removeClass("selected")},p=function(){var e="",a="",i=o.$linkYoutube.val(),l=o.$linkVimeo.val(),d={linkMp4:"undefined"==typeof o.$linkMp4.attr("data-rex-video-bg-url")?"":o.$linkMp4.attr("data-rex-video-bg-url"),width:"undefined"==typeof o.$linkMp4.attr("data-rex-video-bg-width")?"":o.$linkMp4.attr("data-rex-video-bg-width"),height:"undefined"==typeof o.$linkMp4.attr("data-rex-video-bg-height")?"":o.$linkMp4.attr("data-rex-video-bg-height"),idMp4:o.$linkMp4.val()},r={linkMp4:"",idMp4:"",width:"",height:""},s=o.$self.find(".video-insert-wrap.selected");s.hasClass("youtube-insert-wrap")?(e="youtube",a=!0===o.$audioYoutube.prop("checked")?"true":"false"):s.hasClass("vimeo-insert-wrap")?(e="vimeo",a=!0===o.$audioVimeo.prop("checked")?"true":"false"):s.hasClass("mp4-insert-wrap")&&(e="mp4",a=!0===o.$audioMp4.prop("checked")?"true":"false");var c={eventName:"rexlive:update_block_background_video",data_to_send:{target:t,urlYoutube:""==e||"youtube"!=e?"":i,urlVimeo:""==e||"vimeo"!=e?"":l,videoMp4:""==e||"mp4"!=e?r:d,audio:""==e?"":a,typeVideo:e,tools:o.$self.attr("data-block_tools")}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(c)},b=function(){o.$chooseVideoWrapper.click(function(o){o.preventDefault();var t=e(o.target);!t.hasClass("youtube-insert-wrap")&&0==t.parents(".youtube-insert-wrap").length||"youtube"!=a&&""!=a?!t.hasClass("vimeo-insert-wrap")&&0==t.parents(".vimeo-insert-wrap").length||"vimeo"!=a&&""!=a?!t.hasClass("mp4-insert-wrap")&&(0==t.parents(".mp4-insert-wrap").length||t.is("i"))||"mp4"!=a&&""!=a||(u(),p()):(n(),p()):(c(),p())}),o.$uploadMp4.click(function(){o.$mp4Wrap.hasClass("selected")&&Rexlive_MediaUploader.openMediaUploaderVideo(o.$linkMp4,o.$linkMp4.val())}),o.$self.find(".set-video-audio-btn").click(function(o){o.preventDefault();var a=e(o.target),t=a.parents(".set-video-audio-btn"),i=t.find(".video-audio-checkbox"),l=i.attr("checked");l=!l,i.attr("checked",l),p()}),o.$close_button.on("click",function(e){e.preventDefault(),l()})},v=function(e){o.$linkMp4Preview.val(e).next("label").addClass("active")},k=function(t){var i=e("#video-block-editor-wrapper");o={$self:i,$youTubeWrap:i.find("#edit-video-block-wrap-1"),$vimeoWrap:i.find("#edit-video-block-wrap-2"),$mp4Wrap:i.find("#edit-video-block-wrap-3"),$chooseVideoWrapper:i.find(".rex-video-type-select"),$linkYoutube:i.find("#rex-youtube-video-block"),$linkVimeo:i.find("#rex-vimeo-video-block"),$linkMp4:i.find("#video-block-mp4-url"),$linkMp4Preview:i.find("#rex-mp4-video-block-preview"),$checkboxChooseYoutube:i.find("#rex-choose-youtube-video-block"),$checkboxChooseVimeo:i.find("#rex-choose-vimeo-video-block"),$checkboxChooseMp4:i.find("#rex-choose-mp4-video-block"),$uploadMp4:i.find("#rex-upload-mp4-video-block i"),$audioYoutube:i.find("#rex-edit-block-video-youtube-audio"),$audioVimeo:i.find("#rex-edit-block-video-vimeo-audio"),$audioMp4:i.find("#rex-edit-block-video-mp4-audio"),$close_button:i.find(".rex-modal__close-button")},a="",b()};return{init:k,clearVideoModal:s,updateVideoModal:d,updateVideoBackground:p,openBlockVideoBackgroundModal:i,updateVideoMp4Link:v}}(jQuery);
/**
 * Setting the content position
 * @since 2.0.0
 */
var Block_Content_Positions_Modal=function(o){"use strict";var i,t,n,e=function(o,t){a(o.flexPosition),Rexlive_Modals_Utils.positionModal(i.$self,t),Rexlive_Modals_Utils.openModal(i.$self.parent(".rex-modal-wrap"))},l=function(){Rexlive_Modals_Utils.closeModal(i.$self.parent(".rex-modal-wrap"))},s=function(){i.$close_button.on("click",function(o){o.preventDefault(),l()})},a=function(o){n=o.target,c();var e=""==o.position?t:o.position;i.$positions.filter('[value="'+e+'"]').prop("checked",!0)},c=function(){i.$positions.prop("checked",!1)},r=function(){var o=i.$positions.filter(":checked").val(),t=o.split("-")[0],e=o.split("-")[1],l={eventName:"rexlive:apply_flex_position_block",data_to_send:{position:{x:e,y:t},target:n}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l)},p=function(o){var n=o;i={$self:n,$positions:n.find(".content-position"),$close_button:n.find(".rex-modal__close-button")},t="",s(),i.$self.find(".rex-block-position").on("click",function(o){setTimeout(function(){r()},50)})};return{init:p,updatePosition:a,resetPosition:c,openBlockContentPositionModal:e,closeBlockContentPositionModal:l}}(jQuery);
/**
 * Setting the content position
 * @since 2.0.0
 */
var Block_Content_Positions_Setting=function(o){"use strict";var t,i,n,e=function(o){c(o.flexPosition),Rexlive_Modals_Utils.openModal(t.$self.parent(".rex-modal-wrap"))},s=function(){Rexlive_Modals_Utils.closeModal(t.$self.parent(".rex-modal-wrap"))},l=function(){t.$close_button.on("click",function(o){o.preventDefault(),s()})},c=function(o){n=o.target,a();var e=""==o.position?i:o.position;t.$positions.filter('[value="'+e+'"]').prop("checked",!0)},a=function(){t.$positions.prop("checked",!1)},r=function(){var o=t.$positions.filter(":checked").val(),i=o.split("-")[0],e=o.split("-")[1],s={eventName:"rexlive:apply_flex_position_block",data_to_send:{position:{x:e,y:i},target:n}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(s)},p=function(o){var n=o;t={$self:n,$positions:n.find(".content-position"),$close_button:n.find(".rex-modal__close-button")},i="",l(),t.$self.find(".rex-block-position").on("click",function(o){setTimeout(function(){r()},50)})};return{init:p,updatePosition:c,resetPosition:a,openBlockContentPositionModal:e,closeBlockContentPositionModal:s}}(jQuery);
/**
 * Setting the block image positon
 * @since 2.0.0
 */
var Block_Image_Positions_Modal=function(i){"use strict";var o,e,t,n=function(i){t=i.target,s();var n=""==i.position?e:i.position;o.$positions.filter('[value="'+n+'"]').prop("checked",!0)},s=function(){o.$positions.prop("checked",!1)},r=function(){var i=o.$positions.filter(":checked").val(),e=i.split("-")[0],n=i.split("-")[1],s={eventName:"rexlive:apply_flex_image_position_block",data_to_send:{position:{x:n,y:e},target:t}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(s)},a=function(i){var t=i.find("#rex-block-image-position-editor");o={$self:t,$positions:t.find(".image-position")},e="",o.$self.find(".rex-block-image-position").on("click",function(i){setTimeout(function(){r()},50)})};return{init:a,updatePosition:n,resetPosition:s}}(jQuery);
/**
 * Setting the block image positon
 * @since 2.0.0
 */
var Block_Image_Positions_Setting=function(i){"use strict";var t,o,e,n=function(i){e=i.target,s();var n=""==i.position?o:i.position;t.$positions.filter('[value="'+n+'"]').prop("checked",!0)},s=function(){t.$positions.prop("checked",!1)},r=function(){var i=t.$positions.filter(":checked").val(),o=i.split("-")[0],n=i.split("-")[1],s={eventName:"rexlive:apply_flex_image_position_block",data_to_send:{position:{x:n,y:o},target:e}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(s)},a=function(i){var e=i.find("#rex-block-image-position-setting");t={$self:e,$positions:e.find(".image-position")},o="",t.$self.find(".rex-block-image-position").on("click",function(i){setTimeout(function(){r()},50)})};return{init:a,updatePosition:n,resetPosition:s}}(jQuery);
var BlockPaddings_Modal=function(t){"use strict";var d,e,a,n=function(){d.$block_padding_top.val(e.top),d.$block_padding_right.val(e.right),d.$block_padding_bottom.val(e.bottom),d.$block_padding_left.val(e.left)},p=function(t){a=t.target;var n=isNaN(parseInt(t.paddings.top))?e.top:t.paddings.top,p=isNaN(parseInt(t.paddings.right))?e.right:t.paddings.right,l=isNaN(parseInt(t.paddings.bottom))?e.bottom:t.paddings.bottom,r=isNaN(parseInt(t.paddings.left))?e.left:t.paddings.left;o(),i(""==t.paddings.type?e.type:t.paddings.type),d.$block_padding_top.val(n),d.$block_padding_right.val(p),d.$block_padding_bottom.val(l),d.$block_padding_left.val(r)},i=function(t){var e=d.$padding_type_types_wrap.children('[data-rex-type-padding="'+t+'"]');e.addClass("selected"),e.find("input").attr("checked",!0)},o=function(){d.$padding_type_typeWrap.each(function(d,e){t(e).removeClass("selected"),t(e).find("input").attr("checked",!1)})},l=function(){var t=parseInt(d.$block_padding_top.val()),n=parseInt(d.$block_padding_right.val()),p=parseInt(d.$block_padding_bottom.val()),i=parseInt(d.$block_padding_left.val()),o=d.$padding_type_types_wrap,l=o.children(".selected").attr("data-rex-type-padding"),r={eventName:"rexlive:apply_paddings_block",data_to_send:{target:a,paddings:{top:isNaN(t)?e.top:t,right:isNaN(n)?e.right:n,bottom:isNaN(p)?e.bottom:p,left:isNaN(i)?e.left:i,type:l}}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(r)},r=function(d){d.keydown(function(d){var e=t(d.target);return console.log(d.target),t.inArray(d.keyCode,[46,8,9,13,110])!==-1||65===d.keyCode&&(d.ctrlKey===!0||d.metaKey===!0)||d.keyCode>=35&&d.keyCode<=40?(38==d.keyCode&&(d.preventDefault(),e.val(isNaN(parseInt(e.val()))?0:parseInt(e.val())+1)),void(40==d.keyCode&&(d.preventDefault(),e.val(Math.max(isNaN(parseInt(e.val()))?0:parseInt(e.val())-1,0))))):((d.shiftKey||d.keyCode<48||d.keyCode>57)&&(d.keyCode<96||d.keyCode>105)&&d.preventDefault(),void(27==d.keyCode&&e.blur()))})},g=function(t){t.keyup(function(t){(t.keyCode>=48&&t.keyCode<=57||38==t.keyCode||40==t.keyCode||8==t.keyCode)&&(t.preventDefault(),l())})},_=function(){r(d.$block_padding_top),r(d.$block_padding_right),r(d.$block_padding_bottom),r(d.$block_padding_left),g(d.$block_padding_top),g(d.$block_padding_right),g(d.$block_padding_bottom),g(d.$block_padding_left),d.$padding_type_typeWrap.click(function(d){d.preventDefault();var e=t(d.target).parents(".rex-block-padding-type-wrap");e.hasClass("selected")||(o(),e.addClass("selected"),e.find("input").attr("checked",!0),l())})},c=function(t){var a=t.find("#block-paddings-wrapper");d={$block_padding_top:a.find("#bm-block-padding-top"),$block_padding_right:a.find("#bm-block-padding-right"),$block_padding_bottom:a.find("#bm-block-padding-bottom"),$block_padding_left:a.find("#bm-block-padding-left"),$padding_type_typeWrap:a.find(".rex-block-padding-type-wrap"),$padding_type_types_wrap:a.find("#block-padding-type-select")},e={top:5,right:5,bottom:5,left:5,type:"px"},n(),_()};return{init:c,updatePaddings:p,resetPaddings:n}}(jQuery);
var Block_CustomClasses_Modal=function(e){"use strict";var a,l,s,c,t,o=function(){a.$classes.val(l)},r=function(e){t=e.target,c="",s="",c=e.classes,c.indexOf("active-large-block-overlay")!==-1&&(s+=" active-large-block-overlay",c=c.replace("active-large-block-overlay","")),c.indexOf("active-medium-block-overlay")!==-1&&(s+=" active-medium-block-overlay",c=c.replace("active-medium-block-overlay","")),c.indexOf("active-small-block-overlay")!==-1&&(s+=" active-small-block-overlay",c=c.replace("active-small-block-overlay","")),a.$classes.val(c)},i=function(){var e=a.$classes.val();e=e.trim(),e+=s;var l=e.split(/\s+/),c={eventName:"rexlive:apply_block_custom_classes",data_to_send:{customClasses:l,target:t}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(c)},v=function(){a.$classes.blur(function(e){i()})},n=function(e){var s=e.find(".block-custom-class-wrapper");a={$classes:s.find("#rex_block_custom_class")},l="",o(),v()};return{init:n,updateCustomClasses:r,resetCustomClasses:o}}(jQuery);
/**
 * Handling the modal to edit the block image properties:
 * - type: natural|full
 * - zoom
 * - position
 * @since 2.0.0
 */
var Block_Image_Editor_Modal=function(o){"use strict";var t,e,i=function(){e={$modal:o("#rex-block-image-editor"),$close_button:null},e.$close_button=e.$modal.find(".rex-modal__close-button"),t=e.$modal.parent(".rex-modal-wrap")},l=function(o,i){Background_Block_Image_Setting.updateImageModal(o.imageBG),Block_Image_Positions_Setting.updatePosition(o.flexImgPosition),Rexlive_Modals_Utils.positionModal(e.$modal,i),Rexlive_Modals_Utils.openModal(t)},n=function(){e.$close_button.on("click",function(o){o.preventDefault(),Rexlive_Modals_Utils.closeModal(t)})},a=function(o){i(),n(),Background_Block_Image_Setting.init(e.$modal),Block_Image_Positions_Setting.init(e.$modal)};return{init:a,openModal:l}}(jQuery);
var Block_Url_Modal=function(l){"use strict";var n,r,u,t=function(){n.$urlInput.val(r)},e=function(l){u=l.target,n.$urlInput.val(l.link)},i=function(){var l=n.$urlInput.val(),r={eventName:"rexlive:apply_block_link_url",data_to_send:{url:l,target:u}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(r)},a=function(){n.$urlInput.blur(function(l){i()})},o=function(l){var u=l.find(".block-url-link-wrapper");n={$urlInput:u.find("#block_link_value")},r="",t(),a()};return{init:o,updateBlockUrl:e,resetBlockUrl:t}}(jQuery);
var BlockOptions_Modal=function(o){"use strict";var l,a=function(o){Background_Block_Color_Modal.updateColorModal(o.bgColor),Overlay_Color_block_Modal.updateOverlayModal(o.overlay),Background_Block_Image_Modal.updateImageModal(o.imageBG),Block_Video_Background_Modal.updateVideoModal(o.bgVideo),BlockPaddings_Modal.updatePaddings(o.paddings),Block_Content_Positions_Setting.updatePosition(o.flexPosition),Block_Image_Positions_Modal.updatePosition(o.flexImgPosition),Block_CustomClasses_Modal.updateCustomClasses(o.customClasses),Block_Url_Modal.updateBlockUrl(o.linkBlock),Rexlive_Modals_Utils.openModal(l.$self.parent(".rex-modal-wrap"))},i=function(){Rexlive_Modals_Utils.closeModal(l.$self.parent(".rex-modal-wrap"))},t=function(){l.$close_button.on("click",function(o){o.preventDefault(),i()})},n=function(){var a=o("#rex-block-options");l={$self:a,$close_button:a.find(".rex-modal__close-button")},t(),Background_Block_Color_Modal.init(a),Overlay_Color_block_Modal.init(a),Background_Block_Image_Modal.init(a),Block_Video_Background_Modal.init(a),BlockPaddings_Modal.init(a),Block_Content_Positions_Setting.init(a),Block_Image_Positions_Modal.init(a),Block_Image_Editor_Modal.init(a),Block_CustomClasses_Modal.init(a),Block_Url_Modal.init(a)};return{init:n,openBlockOptionsModal:a}}(jQuery);
/**
 * Create a Model starting from a Row
 * @since 2.0.0
 */
var Model_Modal=function(e){"use strict";var o,t,a,n,l,d,i,r,m=function(m){d=m.sectionTarget,i=m.modelID,a=m.shortCode,n=m.layouts,l=m.layoutsNames,t=!1,r=m.modelsNumbers,e.ajax({type:"GET",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_get_model_list",nonce_param:live_editor_obj.rexnonce},success:function(t){if(t.success){var a=[],n={id:"0",founded:!0};a.push(n),o.$model_import.children().each(function(o,t){var n=e(t).val();if("0"!=n){var l={id:n,founded:!1};a.push(l)}});var l,d,r=t.data.updated_list;for(l=0;l<r.length;l++)r[l].founded=!1;for(l=0;l<r.length;l++)for(d=0;d<a.length;d++)if(r[l].id==a[d].id){r[l].founded=!0,a[d].founded=!0;break}for(l=0;l<r.length;l++)r[l].founded||o.$model_import.children().eq(0).after('<option value="'+r[l].id+'">'+r[l].name+"</option>");for(l=0;l<a.length;l++)a[l].founded||o.$model_import.find("option[value="+a[l].id+"]").remove();o.$model_name.val(""),o.$model_import.find("option[value=0]").prop("selected",!0),""!=i&&(o.$model_import.find("option[value=0]").prop("selected",!1),o.$model_import.find("option[value="+i+"]").prop("selected",!0)),Rexlive_Modals_Utils.openModal(o.$self.parent(".rex-modal-wrap"))}},error:function(e){},complete:function(e){o.$self.removeClass("rex-modal--loading")}})},s=function(e){o.$model_import_wrap.removeClass("hide-import-wrap"),o.$model_insert_success_wrap.text(""),m(e)},_=function(){Rexlive_Modals_Utils.closeModal(o.$self.parent(".rex-modal-wrap"))},c=function(){o.$save_button.click(function(e){e.preventDefault(),_()}),o.$cancel_button.click(function(e){e.preventDefault(),_()}),o.$model_import.on("change",function(a){var n=o.$model_import.val();if(""!=n&&"0"!=n&&!t){o.$self.addClass("rex-modal--loading");var l={ID:n};e.ajax({type:"GET",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_get_model_live",nonce_param:live_editor_obj.rexnonce,model_data:l},success:function(e){if(e.success){for(var o={eventName:"rexlive:applyModelSection",data_to_send:{sectionTarget:jQuery.extend(!0,{},d),model:e.data.model,modelName:e.data.name,modelID:e.data.id,customizationsData:e.data.customizations_data,customizationsNames:e.data.customizations_names}},t=e.data.sectionRexID[0][1],a=!1,n=1,l=0;l<r.length;l++)e.data.id==r[l].modelID&&(a=!0,r[l].number+=1,n=r[l].number);a||r.push({modelID:e.data.id,number:n}),d={sectionID:t,modelNumber:n},Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(o)}},error:function(e){},complete:function(e){o.$self.removeClass("rex-modal--loading")}})}}),o.$model_name.on("focusout",function(e){e.preventDefault(),o.$model_name.parent().removeClass("input-active")}),o.$model_name.on("focusin",function(e){e.preventDefault(),o.$model_name.parent().addClass("input-active")}),o.$add_new_model.on("click",function(){if(""!=o.$model_name.val()){o.$self.addClass("setting-saving");var i=o.$model_name.val(),r={post_title:i,post_content:a},m={modelID:-1,modelTitle:"",modelHtml:""};e.ajax({type:"POST",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_create_model_from_builder",nonce_param:live_editor_obj.rexnonce,model_data:r},success:function(a){if(a.success){o.$model_import_wrap.addClass("hide-import-wrap");var r=a.data.model_id;m.modelID=r,m.modelTitle=i,m.modelHtml=a.data.model_html;for(var s=[],c=0;c<n.length;c++){var u=n[c].name,p=n[c].targets;s.push(e.ajax({type:"POST",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_save_model_customization",nonce_param:live_editor_obj.rexnonce,model_id_to_update:r,targets:JSON.stringify(p),layout_name:u},success:function(e){},error:function(e){},complete:function(e){}}))}s.push(e.ajax({type:"POST",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_save_model_customization_names",nonce_param:live_editor_obj.rexnonce,model_id_to_update:r,names:l},success:function(e){},error:function(e){},complete:function(e){}})),e.when.apply(e,s).then(function(){o.$self.removeClass("rex-modal--loading");var e=m.modelID,a=m.modelTitle,i=m.modelHtml;o.$model_name.val("").siblings("label").removeClass("active"),o.$save_button.val(""),o.$model_import.children().eq(0).after('<option value="'+e+'">'+a+"</option>"),o.$model_import.find("option[value="+e+"]").prop("selected",!0);var r={eventName:"rexlive:applyModelSection",data_to_send:{sectionTarget:d,model:i,modelName:a,modelID:e,customizationsData:n,customizationsNames:l}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(r),Rexbuilder_Util_Admin_Editor.highlightRowSetData({rexlive_model_id:e,rexlive_model_name:a}),Rexbuilder_Util_Admin_Editor.updateModelId(e),Rexbuilder_Util_Admin_Editor.updateModelState(),t=!0,o.$model_insert_success_wrap.text("Modello Inserito"),setTimeout(function(){_(),o.$self.removeClass("setting-saving")},1e3)}).fail(function(){}).always(function(){})}},error:function(e){o.$model_import_wrap.addClass("hide-import-wrap"),o.$model_insert_success_wrap.text("Nome già presente")},complete:function(e){}})}else o.$model_name.focus()})},u=function(){var n=e("#rex-model-block"),l=n;o={$self:n,$save_button:l.find(".rex-save-button"),$cancel_button:l.find(".rex-cancel-button"),$model_import:l.find("#rex-model__import"),$model_name:l.find("#rex-model__name"),$add_new_model:l.find("#rex-model__add-new-model"),$model_import_wrap:l.find(".rex-model__import--wrap-active"),$model_insert_success_wrap:l.find(".rex-model__model-insert-success-wrap")},t=!1,i="",a="",c()};return{init:u,openModal:s,closeModal:_}}(jQuery);
var Open_Models_Warning=function(n){"use strict";var e,l=function(n){e.$models_list.empty();for(var l=0;l<n.length;l++)e.$models_list.append('<span class="modal-info--highlight">'+n[l].m_name+(l!=n.length-1?", ":"")+"</span>");Rexlive_Modals_Utils.openModal(e.$self.parent(".rex-modal-wrap"))},o=function(){Rexlive_Modals_Utils.closeModal(e.$self.parent(".rex-modal-wrap"))},s=function(){e.$close_button.on("click",function(){o()})},t=function(){var l=n("#rex-open-models-warning"),o=l;e={$self:l,$close_button:o.find(".rex-modal__close-button"),$models_list:o.find(".open-models-list")},s()};return{init:t,openModal:l,closeModal:o}}(jQuery);
/**
 * Handling the custom layouts editing and sorting
 * @since 2.0.0
 */
var CustomLayouts_Modal=function(t){"use strict";var e,a,n,o=function(){var a,i,n=4;do i=!0,a=Rexbuilder_Util_Admin_Editor.createRandomID(n),e.$layoutsList.find(".layout__item").each(function(){t(this).find("input[name=rexlive-layout-id]").val()==a&&(i=!1)});while(!i);return a},d=function(e){t.ajax({type:"POST",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_save_custom_layouts",nonce_param:live_editor_obj.rexnonce,custom_layouts:e},success:function(t){console.log(t),t.success&&console.log("custom layouts aggiornati"),console.log("chiama effettuata con successo")},error:function(t){console.log("errore chiama ajax")}})},l=function(){var a=[];return e.$layoutsList.find(".layout__item").each(function(e,i){var n=t(i),o={id:n.find("input[name=rexlive-layout-id]").val(),label:n.find("input[name=rexlive-layout-label]").val(),min:n.find("input[name=rexlive-layout-min]").val(),max:n.find("input[name=rexlive-layout-max]").val(),type:n.find("input[name=rexlive-layout-type]").val()};a.push(o)}),a},u=function(t){var e=!1,a=!1;for(i=0;i<t.length;i++)if(n.id==t[i].id){e=!0,n.min!=t[i].min&&"default"!=t[i].id&&(a=!0,n.min=t[i].min,Rexbuilder_Util_Admin_Editor.updateLayoutActiveData(null),Rexbuilder_Util_Admin_Editor.updateIframeWidth(t[i].min));break}var o={eventName:"rexlive:updateLayoutsDimensions",data_to_send:{layouts:t,updateHeights:a}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(o),setTimeout(function(){e||(Rexbuilder_Util_Admin_Editor.setActiveLayout("default"),Rexbuilder_Util_Admin_Editor.updateLayoutPage({min:"",max:"",id:"default",label:"My Desktop",type:"standard"}),c("default"))},50,e)},r=function(t){e.$layoutDataContainer.text(JSON.stringify(t))},s=function(a){var i;e.$buttonsWrapper.find(".btn-builder-layout").each(function(e,n){var o=t(n);for(i=0;i<a.length;i++)if(o.attr("data-name")==a[i].id&&"default"!=a[i].id){o.attr("data-min-width")!=a[i].min&&o.attr("data-min-width",a[i].min),o.attr("data-max-width")!=a[i].max&&o.attr("data-max-width",a[i].max);break}}),e.$buttonsWrapper.find('.btn-builder-layout[data-layout-type="custom"]').each(function(e,a){t(a).find(".rex-number").text(e+1)})},f=function(){var t=l();s(t),r(t),u(t)},c=function(t){e.$layoutsList.find(".layout.active-on-page").removeClass("active-on-page"),e.$layoutsList.find('.layout input[name="rexlive-layout-id"][value="'+t+'"]').parents(".layout").addClass("active-on-page")},p=function(){Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.addClass("layout-window--active"),Rexlive_Modals_Utils.openModal(e.$self.parent(".rex-modal-wrap"))},y=function(){Rexlive_Modals_Utils.closeModal(e.$self.parent(".rex-modal-wrap")),Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.removeClass("layout-window--active")},m=function(e){var a=t(e.target);return t.inArray(e.keyCode,[46,8,9,13,110])!==-1||65===e.keyCode&&(e.ctrlKey===!0||e.metaKey===!0)||e.keyCode>=35&&e.keyCode<=40?(38==e.keyCode&&(e.preventDefault(),a.val(isNaN(parseInt(a.val()))?0:parseInt(a.val())+1)),void(40==e.keyCode&&(e.preventDefault(),a.val(Math.max(isNaN(parseInt(a.val()))?0:parseInt(a.val())-1,0))))):void((e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault())},v=function(e){var a=t(e.target);if((e.keyCode>=48&&e.keyCode<=57||38==e.keyCode||40==e.keyCode||8==e.keyCode)&&(e.preventDefault(),a.parents(".layout__setting").find(".layout-value").text(a.val()+"px"),f()),13==e.keyCode||27==e.keyCode){e.preventDefault();var i=a.parents(".layout").eq(0);i.find(".dashicons-before.dashicons-edit").removeClass("hide-icon"),i.find(".dashicons-before.dashicons-trash").removeClass("hide-icon"),i.find(".dashicons-before.dashicons-yes").addClass("hide-icon"),i.parent().removeClass("editing"),i.find("input[data-editable-field=true]").attr("type","hidden")}},_=function(e){e.preventDefault();var a=t(e.target);if(a.parents(".layout__setting").find(".layout-value").text(a.val()),13==e.keyCode||27==e.keyCode){e.preventDefault();var i=a.parents(".layout").eq(0);i.find(".dashicons-before.dashicons-edit").removeClass("hide-icon"),i.find(".dashicons-before.dashicons-trash").removeClass("hide-icon"),i.find(".dashicons-before.dashicons-yes").addClass("hide-icon"),i.parent().removeClass("editing"),i.find("input[data-editable-field=true]").attr("type","hidden")}f()},h=function(){e.$close_button.click(function(t){t.preventDefault(),d(l()),y()}),e.$config_layouts.on("click",function(t){t.preventDefault(),a=Rexbuilder_Util_Admin_Editor.getActiveLayout(),n={id:"",min:"",max:""};var i=e.$buttonsWrapper.find('div[data-name="'+a+'"]');n.id=i.attr("data-name"),n.min=i.attr("data-min-width"),n.max=i.attr("data-max-width"),c(a),p()}),e.$add_custom_layout_button.on("click",function(){var a=o();tmpl.arg="customLayout";var i=t(tmpl("rexlive-tmpl-custom-layout-modal",{id:a,label:"",minWidth:"",maxWidth:"",type:"custom"}));e.$layoutsList.append(i[0]);var n=i.find(".layout").eq(0);switch(n.find(".dashicons-before.dashicons-edit").addClass("hide-icon"),n.find(".dashicons-before.dashicons-trash").removeClass("hide-icon"),n.find(".dashicons-before.dashicons-yes").removeClass("hide-icon"),n.parent().addClass("editing"),n.find("input[data-editable-field=true]").attr("type","input"),e.layoutListType){case"dropdown":e.$buttonsWrapper.find(".builder-add-custom-layout").parent().before(tmpl("rexlive-tmpl-custom-layout-button-list",{id:a,label:"",minWidth:"",maxWidth:"",type:"custom"}));break;case"list":default:e.$buttonsWrapper.append(tmpl("rexlive-tmpl-custom-layout-button",{id:a,label:"",minWidth:"",maxWidth:"",type:"custom"}))}Rexlive_Base_Settings.launchTooltips(),f()}),e.$self.on("click",".rexlive-layout--edit",function(e){t(e.currentTarget).find(".dashicons-before").toggleClass("hide-icon"),t(e.target).hasClass("dashicons-yes")?t(this).parents(".layout__item").eq(0).removeClass("editing").find("input[data-editable-field=true]").attr("type","hidden"):t(e.target).hasClass("dashicons-edit")&&t(this).parents(".layout__item").eq(0).addClass("editing").find("input[data-editable-field=true]").attr("type","input")}),e.$self.on("click",".rexlive-layout--delete",function(a){if(confirm("Are you sure?")){var i=t(this).parents(".layout__item").find("input[name=rexlive-layout-id]").val();e.$buttonsWrapper.find('div[data-name="'+i+'"]').parent().remove(),t(this).parents(".layout__item").remove(),f()}}),e.$self.on("keydown","input.layout-min-input",function(t){m(t)}),e.$self.on("keydown","input.layout-max-input",function(t){m(t)}),e.$self.on("keyup","input.layout-min-input",function(t){v(t)}),e.$self.on("keyup","input.layout-max-input",function(t){v(t)}),e.$self.on("keyup","input.layout-label-input",function(t){_(t)})},b=function(){e.$layoutsList.children(".layout__item").each(function(e,a){var i=t(a);i.find('input[name="rexlive-layout-id"]').val()})},x=function(){var a=t("#rexlive-custom-layout-modal"),i=Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.find(".rexlive-responsive-buttons-wrapper"),n=Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.find("#rexbuilder-layout-data-backend > .avaiable-layouts");e={$self:a,$close_button:a.find(".rex-cancel-button"),$buttonsWrapper:i,$config_layouts:i.find(".builder-config-layouts"),$layoutDataContainer:n,$layoutsList:a.find(".layout__list"),$add_custom_layout_button:a.find("#rexlive-add-custom-layout"),layoutListType:a.attr("data-layout-list-type")},b(),h(),e.$layoutsList.sortable({items:".layout__item:not(.layout__item--standard)",handle:".rexlive-layout--move",stop:function(a,i){var n=i.item.find('input[name="rexlive-layout-id"]').val(),o=i.item.prev().find('input[name="rexlive-layout-id"]').val(),d=e.$buttonsWrapper.find('div[data-name="'+n+'"]').parent("div");if("default"!==o)var l=e.$buttonsWrapper.find('div[data-name="'+o+'"]').parent("div");else var l=e.$buttonsWrapper.find(".builder-add-custom-layout").parent("div");l.after(d.detach()),e.$buttonsWrapper.find('.btn-builder-layout[data-layout-type="custom"]').each(function(e,a){t(a).find(".rex-number").text(e+1)})}})};return{init:x}}(jQuery);
var Model_Edit_Modal=function(e){"use strict";var t,i,d,o=function(o){i=jQuery.extend(!0,{},o),d=o.layoutActive,t.$modelNamePreview.html('<span class="modal-info--highlight">'+o.modelName+"</span>"),t.$self.find(".rex-edit-option").each(function(t,i){var o=e(i);"edit"!=o.attr("data-rex-option")&&("default"!=d?o.addClass("rex-hide-option"):o.removeClass("rex-hide-option"))}),Rexlive_Modals_Utils.openModal(t.$self.parent(".rex-modal-wrap"))},l=function(){Rexlive_Modals_Utils.closeModal(t.$self.parent(".rex-modal-wrap"))},n=function(){t.$button.on("click",function(t){var d=e(this),o=d.attr("data-rex-option"),n={eventName:"",data_to_send:i};switch(o){case"remove":n.eventName="rexlive:modelBecameSection",Rexbuilder_Util_Admin_Editor.updateOpenModelsList("REMOVE",i),Rexbuilder_Util_Admin_Editor.highlightRowSetData({rexlive_model_id:"",rexlive_model_name:""}),Rexbuilder_Util_Admin_Editor.updateModelId(""),Rexbuilder_Util_Admin_Editor.updateModelState();break;case"edit":n.eventName="rexlive:editModel",Rexbuilder_Util_Admin_Editor.updateOpenModelsList("OPEN",i),Rexbuilder_Util_Admin_Editor.updateModelEditing("true"),Rexbuilder_Util_Admin_Editor.updateModelState()}Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(n),l()}),t.$close_button.on("click",function(){l()})},a=function(){var d=e("#rex-edit-model-choose"),o=d;t={$self:d,$button:o.find(".rex-button"),$close_button:o.find(".rex-modal__close-button"),$modelNamePreview:o.find(".info-model-name")},i={},n()};return{init:a,openModal:o,closeModal:l}}(jQuery);
/**
 * Slider Modal
 * @since 2.0.0
 */
var Rexbuilder_RexSlider=function(e){function i(e,i,d){if(d="undefined"!=typeof d?d:null,s)return s.state("upload-slide").set("$data",e),s.state("upload-slide").set("$preview",i),s.state("upload-slide").set("image_id",d),void s.open();var t=wp.media.controller.Library.extend({defaults:_.defaults({id:"upload-slide",title:"Select Slide Image",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!1,library:wp.media.query({type:"image"}),type:"image",$data:e,$preview:i,image_id:d},wp.media.controller.Library.prototype.defaults)});s=wp.media({button:{text:"Select"},state:"upload-slide",states:[new t]}),s.on("close",function(){var i=s.state("upload-slide").get("selection");0==i.length&&e.val()}),s.on("select",function(){var e=s.state("upload-slide"),i=e.get("selection");i&&i.each(function(i){var d,t,l=e.display(i).toJSON(),a=i.toJSON(),r=a.caption;wp.media.view.settings.captions||delete a.caption,l=wp.media.string.props(l,a),d={id:a.id,post_content:a.description,post_excerpt:r},l.linkUrl&&(d.url=l.linkUrl),"image"===a.type||("video"===a.type?t=wp.media.string.video(l,a):"audio"===a.type?t=wp.media.string.audio(l,a):(t=wp.media.string.link(l),d.post_title=l.title)),i.attributes.nonce=wp.media.view.settings.nonce.sendToEditor,i.attributes.attachment=d,i.attributes.html=t,i.attributes.post_id=wp.media.view.settings.post.id,s.state("upload-slide").get("$data").val(a.id),s.state("upload-slide").get("$preview").css("backgroundImage","url("+a.url+")").addClass("rex-slider__slide__image-preview--active")})}),s.on("open",function(){var e,i=s.state("upload-slide").get("selection");i.each(function(d){e=wp.media.attachment(d.attributes.id),e.fetch(),i.remove(e?[e]:[])});var d=s.state("upload-slide").get("image_id");d&&(e=wp.media.attachment(d),e.fetch(),i.add(e?[e]:[]))}),s.open()}function d(e){if(r)return r.state("upload-slide-video").set("$data",e),void r.open();var i=wp.media.controller.Library.extend({defaults:_.defaults({id:"upload-slide-video",title:"Select Slide Video",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0,multiple:!1,library:wp.media.query({type:"video"}),type:"video",$data:e},wp.media.controller.Library.prototype.defaults)});r=wp.media({button:{text:"Select"},state:"upload-slide-video",states:[new i]}),r.on("close",function(){var i=r.state("upload-slide-video").get("selection");0==i.length&&e.val()}),r.on("select",function(){var e=r.state("upload-slide-video"),i=e.get("selection");i&&i.each(function(i){var d={videoID:-1,videoUrl:""},t=e.display(i).toJSON(),l=i.toJSON();wp.media.view.settings.captions||delete l.caption,t=wp.media.string.props(t,l),d.videoID=l.id,d.videoUrl=l.url,r.state("upload-slide-video").get("$data").val(d.videoID),r.state("upload-slide-video").get("$data").attr("data-video-mp4-url",d.videoUrl)})}),r.on("open",function(){var e,i=r.state("upload-slide-video").get("selection");i.each(function(d){"undefined"!=typeof d&&(e=wp.media.attachment(d.attributes.id),e.fetch(),i.remove(e?[e]:[]))});var d=r.state("upload-slide-video").get("$data").val();d&&(e=wp.media.attachment(d),e.fetch(),i.add(e?[e]:[]))}),r.open()}var t,l,a,s,r,o,n,v,u=function(){var i={slides:[],settings:{}},d=t.$modal.find(".rex-slider__slide");return d.length>0&&(i.settings.auto_start=t.$slider_autostart.prop("checked"),i.settings.prev_next=t.$slider_prev_next.prop("checked"),i.settings.dots=t.$slider_dots.prop("checked"),d.each(function(d,t){var l=e(t),a=l.children(".rex-slider__slide-data"),s=a.find("input[name=rex-slider--slide-id]").val(),r="",o=a.find("textarea[name=rex-slider--slide-text]").text(),n=a.find("input[name=rex-slider--slide-video-url]").val(),_=a.find("input[name=rex-slider--slide-video-type]").val(),v="",u=a.find("input[name=rex-slider--slide-video-audio]").val(),c=a.find("input[name=rex-slider--slide-url]").val();if("undefined"!=typeof s){var p=l.find(".rex-slider__slide__image-preview").css("background-image");r=p.replace("url(","").replace(")","").replace(/\"/gi,"")}"mp4"==_&&(v=a.find("input[name=rex-slider--slide-video-url]").attr("data-mp4-url"));var m={slide_image_id:s,slide_image_url:r,slide_text:o,slide_video:n,slide_videoMp4Url:v,slide_video_type:_,slide_video_audio:u,slide_url:c};i.slides.push(m)})),i},c=function(i,d){var t=e(d.item).siblings().add(e(d.item));t.each(function(i,d){e(d).attr("data-slider-slide-id",i).find(".rex-slider__slide-index").text(i+1)})},p=function(i,d){switch(a.$modal.removeClass(a.visibility_classes.join(" ")),a.$save_button.val("").val(d),i){case"video":a.$video_type.prop("checked",!1),a.$video_audio.prop("checked",!1),a.$video_youtube.val("").next().removeClass("active"),a.$video_mp4.val(""),a.$video_vimeo.val("").next().removeClass("active");var t=e(d),l=t.find("input[name=rex-slider--slide-video-type]").val(),s=t.find("input[name=rex-slider--slide-video-url]").val(),r=t.find("input[name=rex-slider--slide-video-audio]").val();if(s&&l)switch(a.$video_type.filter("[value="+l+"]").prop("checked",!0),a.$video_audio.prop("checked",r),l){case"youtube":a.$video_youtube.val(s).next().addClass("active");break;case"mp4":a.$video_mp4.val(s);break;case"vimeo":a.$video_vimeo.val(s).next().addClass("active")}a.$modal.addClass("video-links--visible");break;case"url":a.$link_value.val("").next().removeClass("active");var s=e(d).find("input[name=rex-slider--slide-url]").val();s&&a.$link_value.val(s).next().addClass("active"),a.$modal.addClass("url-links--visible")}Rexlive_Modals_Utils.openModal(a.$modal_wrap,!0)},m=function(e){t.$slider_autostart.prop("checked",!1),t.$slider_prev_next.prop("checked",!1),t.$slider_dots.prop("checked",!1);for(var i in e)if(e.hasOwnProperty(i)){var d=e[i];switch(i){case"auto_start":"true"==d&&t.$slider_autostart.prop("checked",!0);break;case"prev_next":"true"==d&&t.$slider_prev_next.prop("checked",!0);break;case"dots":"true"==d&&t.$slider_dots.prop("checked",!0)}}},$=function(){t.$slider_autostart.prop("checked",!1),t.$slider_prev_next.prop("checked",!1),t.$slider_dots.prop("checked",!1),t.$slide_list.empty(),t.$slider_import.val("0"),t.$modal.removeClass("rex-slider-block--editing"),t.$slide_title.prop("disabled",!0)},x=function(i,d,a,s){$(),i="undefined"!=typeof i?i:"",d="undefined"!=typeof d?d:"",a="undefined"!=typeof a?a:"",v=s,i&&d&&a?(t.$save_button.attr("data-block-to-edit",i),t.$save_button.attr("data-slider-to-edit",a),t.$undo_button.attr("data-slider-to-edit",a),t.$modal.addClass("rex-modal--loading"),e.ajax({type:"POST",url:live_editor_obj.ajaxurl,data:{action:"rex_create_rexslider_admin_markup",nonce_param:live_editor_obj.rexnonce,data:d,slider_id:a},success:function(e){e.success&&(m(e.data.rexslider_attrs),t.$slide_title.val(Rexlive_Base_Settings.htmlDecode(e.data.slider.title)),t.$slide_list.append(e.data.slides_markup),t.$slide_list.sortable("refresh"),t.$modal.removeClass("rex-modal--loading"))},error:function(e){t.$modal.removeClass("rex-modal--loading")}}),Rexlive_Modals_Utils.openModal(t.$modal_wrap)):(t.$slider_autostart.prop("checked",!0),t.$slider_prev_next.prop("checked",!0),t.$slider_dots.prop("checked",!0),t.$save_button.attr("data-block-to-edit",""),t.$save_button.attr("data-slider-to-edit",""),t.$slide_title.val(live_editor_obj.labels.slider.new_slider).prop("disabled",!1),t.$slide_list.append(l.replace(/\bdata.slideindex\b/g,"0").replace(/\bdata.slideindexfront\b/g,"1")),t.$slide_list.sortable("refresh"),Rexlive_Modals_Utils.openModal(t.$modal_wrap))},f=function(i,d,l,a,s,r){function o(e){return e<10?"0"+e:e}var n,_="undefined"!=typeof a&&a,u="undefined"!=typeof s&&s;n=""!=l||_?l:0,"undefined"!=typeof r&&(v=r);var c=t.$slide_title.val();if(""==c||"New Slider"==c){var p=new Date;c="SLIDER_"+p.getFullYear().toString()+o(p.getMonth()+1)+o(p.getDate())+o(p.getHours())+o(p.getMinutes())+o(p.getSeconds())}else if(_)if(c.indexOf(" - copy")!=-1){for(var m,$=/copy(?:\s+([0-9]+))*/gm,x=-1;null!==(m=$.exec(c));)m.index===$.lastIndex&&$.lastIndex++,x="undefined"==typeof m[1]?0:parseInt(m[1]);c=c.replace($,""),x+=1,c+="copy "+x}else c+=" - copy";l&&!_?e.ajax({type:"POST",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_edit_slider_from_builder",nonce_param:live_editor_obj.rexnonce,slider_data:i,slider_id:l,sliderTitle:c},success:function(e){if(e.success&&!u){var t={eventName:"",data_to_send:{id:e.data.slider_id,settings:i.settings,slides:i.slides,target:v}};d?t.eventName="rexlive:updateSlider":t.eventName="rexlive:insert_new_slider",Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(t)}},error:function(e){}}):e.ajax({type:"POST",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_create_slider_from_builder",nonce_param:live_editor_obj.rexnonce,slider_data:i,sliderTitle:c},success:function(e){if(e.success){var l={eventName:"",data_to_send:{id:e.data.slider_id,settings:i.settings,slides:i.slides,target:v}};_?l.eventName="rexlive:newSliderSavedOnDB":d?l.eventName="rexlive:updateSlider":l.eventName="rexlive:insert_new_slider",t.$slider_import.append('<option value="'+e.data.slider_id+'" data-rex-slider-title="'+e.data.slider_title+'">'+live_editor_obj.labels.slider.list_title_prefix+e.data.slider_title+live_editor_obj.labels.slider.list_title_suffix+"</option>"),Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l)}},error:function(e){}})},b=function(){a.$video_youtube.on("change keyup paste",function(){""!=e(this).val()?a.$video_type.filter("[value=youtube]").attr("checked",!0):a.$video_type.filter("[value=youtube]").attr("checked",!1)}),a.$video_vimeo.on("change keyup paste",function(){""!=e(this).val()?a.$video_type.filter("[value=vimeo]").attr("checked",!0):a.$video_type.filter("[value=vimeo]").attr("checked",!1)}),Rexlive_Base_Settings.$document.on("click",".rex-slider__slide-edit",function(d){d.preventDefault();var l=e(this),a=l.parents(".rex-slider__slide"),s=a.find(".rex-slider__slide-data"),r=l.attr("value"),o=a.attr("data-slider-slide-id");switch(r){case"add-slide":var n=s.find("input[name=rex-slider--slide-id]"),_=a.find(".rex-slider__slide__image-preview");i(n,_);break;case"edit-slide":var n=s.find("input[name=rex-slider--slide-id]"),_=a.find(".rex-slider__slide__image-preview"),v=n.val();i(n,_,v);break;case"text":var u=s.find("textarea[name=rex-slider--slide-text]"),c=u.text(),m=".rex-slider__slide[data-slider-slide-id="+o+"]";Rexpansive_Builder_Admin_TextEditor.openTextEditor(m,c,!0,["hide-padding-position"]);break;case"video":t.$modal.addClass("push-down-modal"),p("video",".rex-slider__slide[data-slider-slide-id="+o+"]");break;case"url":t.$modal.addClass("push-down-modal"),p("url",".rex-slider__slide[data-slider-slide-id="+o+"]");break;case"copy":var $=parseInt(t.$modal.find(".rex-slider__slide").length),x=a.clone();x.attr("data-slider-slide-id",$),x.find(".rex-slider__slide-index").text($+1),t.$slide_list.append(x),t.$slide_list.sortable("refresh"),Rexlive_Modals_Utils.resetModalDimensions(t.$modal);break;case"delete":a.remove(),t.$modal.find(".rex-slider__slide").each(function(i,d){e(d).attr("data-slider-slide-id",i).find(".rex-slider__slide-index").text(i+1)}),Rexlive_Modals_Utils.resetModalDimensions(t.$modal)}}),t.$add_new_slide.on("click",function(){var e=parseInt(t.$modal.find(".rex-slider__slide").length),i=l.replace(/\bdata.slideindex\b/g,e).replace(/\bdata.slideindexfront\b/g,e+1);t.$slide_list.append(i),t.$slide_list.sortable("refresh"),Rexlive_Modals_Utils.resetModalDimensions(t.$modal)}),t.$cancel_button.on("click",function(){n||Rexlive_Modals_Utils.closeModal(t.$modal_wrap)}),t.$undo_button.on("click",function(){if(!n){var i=e(this).attr("data-slider-to-edit");""===i?(t.$slider_autostart.prop("checked",!0),t.$slider_prev_next.prop("checked",!0),t.$slider_dots.prop("checked",!0),t.$save_button.attr("data-block-to-edit",""),t.$save_button.attr("data-slider-to-edit",""),t.$slide_title.val(live_editor_obj.labels.slider.new_slider),t.$slide_list.empty().append(l.replace(/\bdata.slideindex\b/g,"0").replace(/\bdata.slideindexfront\b/g,"1")),t.$slide_list.sortable("refresh")):(t.$modal.addClass("rex-modal--loading"),e.ajax({type:"POST",url:live_editor_obj.ajaxurl,data:{action:"rex_create_rexslider_admin_markup",nonce_param:live_editor_obj.rexnonce,slider_id:i},success:function(e){m(e.data.rexslider_attrs),t.$slide_list.empty().append(e.data.slides_markup),t.$slide_list.sortable("refresh"),t.$slide_title.val(live_editor_obj.labels.slider.copy_slider+Rexlive_Base_Settings.htmlDecode(e.data.slider.title)),t.$undo_button.attr("data-slider-to-edit",i),t.$modal.removeClass("rex-modal--loading"),Rexlive_Modals_Utils.resetModalDimensions(t.$modal)},error:function(e){t.$modal.removeClass("rex-modal--loading")}}))}}),t.$save_button.on("click",function(i){if(!n){var d=u(),l=e(this).attr("data-block-to-edit"),a=e(this).attr("data-slider-to-edit");f(d,l,a),Rexlive_Modals_Utils.closeModal(t.$modal_wrap)}}),t.$slider_import.on("change",function(i){i.preventDefault();var d=e(this).val();if("0"!=d)t.$modal.addClass("rex-modal--loading"),e.ajax({type:"POST",url:live_editor_obj.ajaxurl,data:{action:"rex_create_rexslider_admin_markup",nonce_param:live_editor_obj.rexnonce,slider_id:d},success:function(e){m(e.data.rexslider_attrs),t.$slide_list.empty().append(e.data.slides_markup),t.$slide_list.sortable("refresh");var i=Rexlive_Base_Settings.htmlDecode(e.data.slider.title),l=g(i);t.$slide_title.val(live_editor_obj.labels.slider.copy_slider+(0!==l?l+"-":"")+i),t.$undo_button.attr("data-slider-to-edit",d),t.$modal.removeClass("rex-modal--loading"),Rexlive_Modals_Utils.resetModalDimensions(t.$modal)},error:function(e){t.$modal.removeClass("rex-modal--loading")}});else{t.$save_button.attr("data-slider-to-edit",""),t.$undo_button.attr("data-slider-to-edit",""),t.$slide_list.empty(),t.$slider_autostart.prop("checked",!0),t.$slider_prev_next.prop("checked",!0),t.$slider_dots.prop("checked",!0),t.$slide_title.val(live_editor_obj.labels.slider.new_slider);var a=0,s=l.replace(/\bdata.slideindex\b/g,a).replace(/\bdata.slideindexfront\b/g,a+1);t.$slide_list.append(s),t.$slide_list.sortable("refresh"),Rexlive_Modals_Utils.resetModalDimensions(t.$modal)}}),a.$cancel_button.on("click",function(){t.$modal.removeClass("push-down-modal"),Rexlive_Modals_Utils.closeModal(a.$modal_wrap,!0)}),a.$save_button.on("click",function(){var i=e(this.value);if(a.$modal.hasClass("video-links--visible")){var d=a.$video_type.filter(":checked").val(),l="",s="";switch(i.find("input[name=rex-slider--slide-video-type]").val(d),d){case"youtube":l=a.$video_youtube.val();break;case"mp4":l=a.$video_mp4.val(),s=a.$video_mp4.attr("data-video-mp4-url");break;case"vimeo":l=a.$video_vimeo.val()}""!=l?(i.find("input[name=rex-slider--slide-video-url]").val(l).attr("data-mp4-url",s),i.find(".rex-slider__slide-edit[value=video]").addClass("rex-slider__slide-edit__field-active-notice")):i.find(".rex-slider__slide-edit[value=video]").removeClass("rex-slider__slide-edit__field-active-notice"),i.find("input[name=rex-slider--slide-video-audio]").val(a.$video_audio.prop("checked"))}else if(a.$modal.hasClass("url-links--visible")){var r=a.$link_value.val();""!=r?(i.find("input[name=rex-slider--slide-url]").val(r),i.find(".rex-slider__slide-edit[value=url]").addClass("rex-slider__slide-edit__field-active-notice")):(i.find("input[name=rex-slider--slide-url]").val(""),i.find(".rex-slider__slide-edit[value=url]").removeClass("rex-slider__slide-edit__field-active-notice"))}console.log("fermi tutti"),t.$modal.removeClass("push-down-modal"),Rexlive_Modals_Utils.closeModal(a.$modal_wrap,!0)}),a.$video_mp4_add.on("click",function(e){d(a.$video_mp4)}),Rexlive_Base_Settings.$document.on("click","#edit_slider_title_btn",function(i){var d=e(i.target),l=d.parents("#rex-slider-block").find(".rx__select-wrap");o=l.children("select").find(":selected"),l.addClass("editing-title-slider");var a=o.val();t.$slide_title.val(o.text()),t.$slide_title.attr("data-rex-slider-id",a),n=!0}),Rexlive_Base_Settings.$document.on("click","#edit_slider_title_live_btn",function(i){var d=e(i.target),l=d.parents("#rex-slider-block").find(".rx__select-wrap");o=l.children("select").find(":selected"),l.addClass("editing-title-slider"),t.$slide_title.prop("disabled",function(e,i){return!i})}),Rexlive_Base_Settings.$document.on("click","#save_slider_title_btn",function(i){var d=e(i.target),l=d.parents("#rex-slider-block").find(".rx__select-wrap"),a=t.$slide_title.val();o.text(a),t.$slide_title.attr("data-rex-slider-id",""),t.$slide_title.val(""),l.removeClass("editing-title-slider"),n=!1}),Rexlive_Base_Settings.$document.on("click","#cancel_slider_title_btn",function(i){var d=e(i.target),l=d.parents("#rex-slider-block").find(".rx__select-wrap");t.$slide_title.attr("data-rex-slider-id",""),t.$slide_title.val(""),l.removeClass("editing-title-slider"),n=!1})},g=function(e){var i=0,d="("+live_editor_obj.labels.slider.copy_slider+"(\\d-){0,1}){0,1}"+e,l=new RegExp(d,"");return t.$slider_import.find("option").each(function(e,d){return"0"===d.value||void(null!==d.getAttribute("data-rex-slider-title").match(l)&&i++)}),i},h=function(){l=e("#rex-slider__new-slide-tmpl").html().trim(),t={$modal:e("#rex-slider-block"),$modal_wrap:null,$cancel_button:null,$undo_button:null,$save_button:null,$add_new_slide:null,$slide_list:null,$slide_title:null,$slider_autostart:null,$slider_prev_next:null,$slider_dots:null,$slider_import:null},t.$modal_wrap=t.$modal.parent(".rex-modal-wrap"),t.$cancel_button=t.$modal.find(".rex-modal__close-button"),t.$save_button=t.$modal.find(".rex-save-button"),t.$undo_button=t.$modal.find(".rex-undo-button"),t.$add_new_slide=t.$modal.find("#rex-slider__add-new-slide"),t.$slide_list=t.$modal.find(".rex-slider__slide-list"),t.$slide_title=t.$modal.find(".title-slider"),t.$slider_autostart=t.$modal.find("#rex-slider__autostart"),t.$slider_prev_next=t.$modal.find("#rex-slider__prev-next"),t.$slider_dots=t.$modal.find("#rex-slider__dots"),t.$slider_import=t.$modal.find("#rex-slider__import"),t.$slide_list.sortable({revert:!0,handle:".rex-slider__slide-edit[value=move]",update:function(e,i){c(e,i)}}),a={$modal:e("#rex-slider__links-editor"),$modal_wrap:null,$cancel_button:null,$save_button:null,visibility_classes:["video-links--visible","url-links--visible"],$link_value:null,$video_type:null,$video_youtube:null,$video_mp4:null,$video_mp4_add:null,$video_vimeo:null,$video_audio:null},a.$modal_wrap=a.$modal.parent(".rex-modal-wrap"),a.$cancel_button=a.$modal.find(".rex-cancel-button"),a.$save_button=a.$modal.find(".rex-save-button"),a.$link_value=a.$modal.find("#rex-slider__slide-url-link"),a.$video_type=a.$modal.find("input[name=rex-slide-choose-video]"),a.$video_mp4_add=a.$modal.find("#rex-slide-choose-mp4"),a.$video_youtube=a.$modal.find("#rex-slide__video-youtube"),a.$video_mp4=a.$modal.find("#rex-slide__video-mp4"),a.$video_vimeo=a.$modal.find("#rex-slide__video-vimeo"),a.$video_audio=a.$modal.find("#rex-slide__video--audio"),o=null,n=!1,b()};return{init:h,openSliderModal:x,saveSlider:f}}(jQuery);
var Change_Layout_Modal=function(e){"use strict";var a,t,n,i=function(e){t=e.activeLayout,n=e.buttonData,Rexlive_Modals_Utils.openModal(a.$self.parent(".rex-modal-wrap")),a.$layout_name_placholder.text(e.activeLayoutLabel)},o=function(){Rexlive_Modals_Utils.closeModal(a.$self.parent(".rex-modal-wrap"))},r=function(){a.$button.on("click",function(a){var i=e(a.target),r=i.parents(".rex-change-layout-option").attr("data-rex-option");switch(r){case"save":Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".btn-save").addClass("rex-saving");var d={eventName:"rexlive:savePage",data_to_send:{buttonData:n}},l={eventName:"rexlive:saveModel",data_to_send:{buttonData:n}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(d),Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(l),Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage({eventName:"rexlive:startChangeLayout"}),Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.removeClass("btn-redo--active btn-undo--active");break;case"continue":var s={eventName:"rexlive:dropChanges",data_to_send:{selected:t,eventName:"",buttonData:n}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(s),Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.removeClass("btn-redo--active btn-undo--active");break;case"abort":}o()})},d=function(){var t=e("#rex-layout-page-changed"),n=t;a={$self:t,$button:n.find(".rex-button"),$layout_name_placholder:n.find(".layout-name")},r()};return{init:d,openModal:i,closeModal:o}}(jQuery);
/**
 * Object that handles the message in case the user came from the first time from the backend
 * warning him that after the saving it can only use the builderlive to edit the page
 * @since 2.0.0
 */
var LockedOptionMask=function(e){"use strict";var t,a,o=function(e){a=e.buttonData,Rexlive_Modals_Utils.openModal(t.$self.parent(".rex-modal-wrap"))},n=function(){Rexlive_Modals_Utils.closeModal(t.$self.parent(".rex-modal-wrap"))},r=function(){t.$button.on("click",function(t){var o=e(t.target),r=o.parents(".rex-locked-option-wrapper").attr("data-rex-option");switch(r){case"save":Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".btn-save").addClass("rex-saving");var i={eventName:"rexlive:savePage",data_to_send:{buttonData:a}},d={eventName:"rexlive:saveModel",data_to_send:{buttonData:a}};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(i),Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(d);break;case"abort":}n()})},i=function(){var a=e("#rex-locked-option"),o=a;t={$self:a,$button:o.find(".rex-button")},r()};return{init:i,openModal:o,closeModal:n}}(jQuery);
/**
 * https://www.html5rocks.com/en/tutorials/dnd/basics/
 * https://github.com/StackHive/DragDropInterface
 * http://mereskin.github.io/dnd/
 */
var Model_Import_Modal=function(e){"use strict";var t,i=function(){e.ajax({type:"GET",dataType:"json",url:live_editor_obj.ajaxurl,data:{action:"rex_get_model_list",nonce_param:live_editor_obj.rexnonce},success:function(i){if(i.success){var r=[];t.$self.find(".model__element").each(function(t,i){var n=e(i).attr("data-rex-model-id"),a={id:n,founded:!1};r.push(a)});var n,a,o=i.data.updated_list;for(n=0;n<o.length;n++)o[n].founded=!1;for(n=0;n<o.length;n++)for(a=0;a<r.length;a++)if(o[n].id==r[a].id){o[n].founded=!0,r[a].founded=!0;break}for(tmpl.arg="model",n=0;n<o.length;n++)o[n].founded||t.$self.find(".model-list").prepend(tmpl("rexlive-tmpl-model-item-list",{id:o[n].id,name:o[n].name,preview:""!=o[n].preview_image_url?o[n].preview_image_url:""}));for(n=0;n<r.length;n++)r[n].founded||t.$self.find('.model__element[data-rex-model-id="'+r[n].id+'"]').remove();t.$self.addClass("rex-lateral-panel--open")}},error:function(e){},complete:function(e){t.$self.removeClass("rex-modal--loading")}})},r=function(){i()},n=function(){t.$self.addClass("rex-lateral-panel--close").one(Rexbuilder_Util_Admin_Editor.animationEvent,function(e){t.$self.removeClass("rex-lateral-panel--open rex-lateral-panel--close")})},a=function(){t.$close_button.click(function(e){e.preventDefault(),n()})},o=function(){var t,i,r,n,a,o=Rexbuilder_Util_Admin_Editor.$frameBuilder.get(0).contentWindow,d=!0,l=function(t){var i=e(Rexbuilder_Util_Admin_Editor.$frameBuilder[0].contentWindow).scrollTop();e(Rexbuilder_Util_Admin_Editor.$frameBuilder[0].contentWindow).scrollTop(i+t),d||setTimeout(function(){l(t)},20)};Rexlive_Base_Settings.$document.on("dragstart",".model-list li",function(t){Rexbuilder_Util_Admin_Editor.blockIframeRows(),t.originalEvent.dataTransfer.effectAllowed="all",a=setInterval(function(){s.ProcessDragOverQueue()},100),tmpl.arg="o";var i={model_id:e(this).attr("data-rex-model-id")},r=tmpl("rexlive-tmpl-insert-model-loader",i);t.originalEvent.dataTransfer.setData("text/plain",r)}),Rexlive_Base_Settings.$document.on("drag",".model-list li",function(t){d=!0,t.clientY<150&&(d=!1,l(-1)),t.clientY>e(Rexbuilder_Util_Admin_Editor.$frameBuilder[0].contentWindow).height()-150&&(d=!1,l(1))}),Rexlive_Base_Settings.$document.on("dragend",".model-list li",function(e){Rexbuilder_Util_Admin_Editor.releaseIframeRows(),d=!0,clearInterval(a),s.removePlaceholder(),s.ClearContainerContext()}),Rexbuilder_Util_Admin_Editor.$frameBuilder.load(function(){var a=e(o.document).find(".rex-container").eq(0);a.on("dragenter",function(a){a.stopPropagation(),t=e(a.target),i=!0,r=a.target.getBoundingClientRect(),n=1}),a.on("dragover",function(e){if(e.preventDefault(),e.stopPropagation(),n%15!=0&&0==i)return void(n+=1);e=e||window.event,n+=1,i=!1;var a={x:e.originalEvent.clientX,y:e.originalEvent.clientY};s.AddEntryToDragOverQueue(t,r,a)}),a.on("drop",function(t){t.preventDefault(),t.stopPropagation();var i;i=t.isTrigger?triggerEvent.originalEvent:t.originalEvent;try{var r=i.dataTransfer.getData("text/plain"),n=Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find(".drop-marker"),a=e(jQuery.parseHTML(r));a.insertAfter(n[0]),n.remove();var o={eventName:"rexlive:importModels"};Rexbuilder_Util_Admin_Editor.sendIframeBuilderMessage(o)}catch(i){console.log(i)}})});var s={dragoverqueue:[],GetMouseBearingsPercentage:function(e,t,i){t||(t=e.get(0).getBoundingClientRect());var r=(i.x-t.left)/(t.right-t.left)*100,n=(i.y-t.top)/(t.bottom-t.top)*100;return{x:r,y:n}},OrchestrateDragDrop:function(e,t,i){if(!e||0==e.length||!t||!i)return!1;e.is("html")&&(e=e.find("body"));var r={x:50,y:50},n=this.GetMouseBearingsPercentage(e,t,i);if(n.x>r.x&&n.x<100-r.x&&n.y>r.y&&n.y<100-r.y){var a=e.clone();if(a.find(".drop-marker").remove(),""!=a.html()||this.checkVoidElement(a))if(0==a.children().length)this.DecideBeforeAfter(e,n);else if(1==a.children().length)this.DecideBeforeAfter(e.children(":not(.drop-marker,[data-dragcontext-marker])").first(),n);else{var o=this.findNearestElement(e,i.x,i.y);this.DecideBeforeAfter(o.el,n,i)}else if(n.y<90)return this.PlaceInside(e)}else if(n.x<=r.x||n.y<=r.y){var d=this.FindValidParent(e,"top");d.is("body,html")&&(d=Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body").children(":not(.drop-marker,[data-dragcontext-marker])").first()),this.DecideBeforeAfter(d,n,i)}else if(n.x>=100-r.x||n.y>=100-r.y){var d=this.FindValidParent(e,"bottom");d.is("body,html")&&(d=Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body").children(":not(.drop-marker,[data-dragcontext-marker])").last()),this.DecideBeforeAfter(d,n,i)}},DecideBeforeAfter:function(e,t,i){i&&(t=this.GetMouseBearingsPercentage(e,null,i));var r="inline"==e.css("display")||"inline-block"==e.css("display");return e.is("br")&&(r=!1),r?t.x<50?this.PlaceBefore(e):this.PlaceAfter(e):t.y<50?this.PlaceBefore(e):this.PlaceAfter(e)},checkVoidElement:function(e){var t=["i","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","video","iframe","source","track","wbr"],i=t.join(",");return!!e.is(i)},calculateDistance:function(e,t,i){return Math.sqrt(Math.pow(e.x-t,2)+Math.pow(e.y-i,2))},FindValidParent:function(e,t){switch(t){case"left":for(;;){var i=e.get(0).getBoundingClientRect(),r=e.parent(),n=r.get(0).getBoundingClientRect();if(e.is("body")||e.hasClass("rex-container"))return e;if(0!=Math.abs(n.left-i.left))return e;e=e.parent()}break;case"right":for(;;){var i=e.get(0).getBoundingClientRect(),r=e.parent(),n=r.get(0).getBoundingClientRect();if(e.is("body")||e.hasClass("rex-container"))return e;if(0!=Math.abs(n.right-i.right))return e;e=e.parent()}break;case"top":for(;;){var i=e.get(0).getBoundingClientRect(),r=e.parent(),n=r.get(0).getBoundingClientRect();if(e.is("body")||e.hasClass("rex-container"))return e;if(0!=Math.abs(n.top-i.top))return e;e=e.parent()}break;case"bottom":for(;;){var i=e.get(0).getBoundingClientRect(),r=e.parent(),n=r.get(0).getBoundingClientRect();if(e.is("body")||e.hasClass("rex-container"))return e;if(0!=Math.abs(n.bottom-i.bottom))return e;e=e.parent()}}},addPlaceHolder:function(e,t,i){switch(e.hasClass("rex-container")&&(t="before"==t?"inside-prepend":"inside-append"),i||(i=this.getPlaceHolder()),this.removePlaceholder(),t){case"before":i.find(".message").html(e.parent().data("sh-dnd-error")),e.before(i),this.AddContainerContext(e,"sibling");break;case"after":i.find(".message").html(e.parent().data("sh-dnd-error")),e.after(i),this.AddContainerContext(e,"sibling");break;case"inside-prepend":i.find(".message").html(e.data("sh-dnd-error")),e.prepend(i),this.AddContainerContext(e,"inside");break;case"inside-append":i.find(".message").html(e.data("sh-dnd-error")),e.append(i),this.AddContainerContext(e,"inside")}},removePlaceholder:function(){Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find(".drop-marker").remove()},getPlaceHolder:function(){return e("<div class='drop-marker drop-marker--view'><div class='drop-marker--ruler'></div></div>")},PlaceInside:function(e){var t=this.getPlaceHolder();t.addClass("horizontal").css("width",e.width()+"px"),this.addPlaceHolder(e,"inside-append",t)},PlaceBefore:function(e){var t=this.getPlaceHolder(),i="inline"==e.css("display")||"inline-block"==e.css("display");if(e.is("br"))i=!1;else if(e.is("td,th"))return t.addClass("horizontal").css("width",e.width()+"px"),this.addPlaceHolder(e,"inside-prepend",t);i?t.addClass("vertical").css("height",e.innerHeight()+"px"):t.addClass("horizontal").css("width",e.parent().width()+"px"),this.addPlaceHolder(e,"before",t)},PlaceAfter:function(e){var t=this.getPlaceHolder(),i="inline"==e.css("display")||"inline-block"==e.css("display");if(e.is("br"))i=!1;else if(e.is("td,th"))return t.addClass("horizontal").css("width",e.width()+"px"),this.addPlaceHolder(e,"inside-append",t);i?t.addClass("vertical").css("height",e.innerHeight()+"px"):t.addClass("horizontal").css("width",e.parent().width()+"px"),this.addPlaceHolder(e,"after",t)},findNearestElement:function(t,i,r){var n=this,a=null,o=t.children(":not(.drop-marker,[data-dragcontext-marker])");if(o.length>0){if(o.each(function(){if(!e(this).is(".drop-marker")){var t,o=e(this).get(0).getBoundingClientRect(),d=0,l=null,s="",c=o.left,f=o.right,u=o.top,m=o.bottom,p=null,h=null;return r>u&&r<m?p=i<c&&r<f?{x:c,y:r,position:"before"}:{x:f,y:r,position:"after"}:i>c&&i<f?p=r<u&&r<m?{x:i,y:u,position:"before"}:{x:i,y:m,position:"after"}:i<c&&i<f?(p={x:c,y:u,position:"before"},h={x:c,y:m,position:"after"}):i>c&&i>f?(p={x:f,y:u,position:"before"},h={x:f,y:m,position:"after"}):r<u&&r<m?(p={x:c,y:u,position:"before"},h={x:f,y:u,position:"after"}):r>u&&r>m&&(p={x:c,y:m,position:"before"},h={x:f,y:m,position:"after"}),t=n.calculateDistance(p,i,r),null!==h&&(l=n.calculateDistance(h,i,r)),t<l||null===l?(d=t,s=p.position):(d=l,s=h.position),null!==a&&a.distance<d||void(a={el:this,distance:d,xPosition1:c,xPosition2:f,yPosition1:u,yPosition2:m,position:s})}}),null!==a){var d=a.position;return{el:e(a.el),position:d}}return!1}},AddEntryToDragOverQueue:function(e,t,i){var r=[e,t,i];this.dragoverqueue.push(r)},ProcessDragOverQueue:function(e,t,i){var r=this.dragoverqueue.pop();if(this.dragoverqueue=[],r&&3==r.length){var n=r[0],a=r[1],i=r[2];this.OrchestrateDragDrop(n,a,i)}},GetContextMarker:function(){var t=e("<div data-dragcontext-marker><span data-dragcontext-marker-text></span></div>");return t},AddContainerContext:function(e,t){var i=this.GetContextMarker();switch(this.ClearContainerContext(),e.is("html,body")&&(t="inside",e=Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body")),t){case"inside":this.PositionContextMarker(i,e),e.hasClass("stackhive-nodrop-zone")&&i.addClass("invalid");var r=this.getElementName(e);if(i.find("[data-dragcontext-marker-text]").html(r),0==Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body [data-sh-parent-marker]").length)break;Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body [data-sh-parent-marker]").first().before(i);case"sibling":this.PositionContextMarker(i,e.parent()),e.parent().hasClass("stackhive-nodrop-zone")&&i.addClass("invalid");var r=this.getElementName(e.parent());if(i.find("[data-dragcontext-marker-text]").html(r),i.attr("data-dragcontext-marker",r.toLowerCase()),0==Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body [data-sh-parent-marker]").length)break;Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body [data-sh-parent-marker]").first().before(i)}},PositionContextMarker:function(t,i){var r=i.get(0).getBoundingClientRect();t.css({height:r.height+4+"px",width:r.width+4+"px",top:r.top+e(Rexbuilder_Util_Admin_Editor.$frameBuilder.get(0).contentWindow).scrollTop()-2+"px",left:r.left+e(Rexbuilder_Util_Admin_Editor.$frameBuilder.get(0).contentWindow).scrollLeft()-2+"px"}),r.top+Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("body").scrollTop()<24&&t.find("[data-dragcontext-marker-text]").css("top","0px")},ClearContainerContext:function(){Rexbuilder_Util_Admin_Editor.$frameBuilder.contents().find("[data-dragcontext-marker]").remove()},getElementName:function(e){return e.prop("tagName")}}},d=function(){var i=e("#rex-models-list");t={$self:i,$close_button:i.find(".rex-close-button")},a(),o()};return{init:d,openModal:r,closeModal:n}}(jQuery);
var Rexlive_Modals=function(i){"use strict";var o=function(){Rexlive_Top_Tools.init(),Section_Modal.init(),Insert_Video_Modal.init(),CssEditor_Modal.init(),HtmlEditor_Modal.init(),SectionBackground_Modal.init(),Section_Video_Background_Modal.init(),BlockOptions_Modal.init(),Block_Content_Positions_Modal.init(i("#rex-block-content-position-editor")),Model_Modal.init(),Model_Edit_Modal.init(),Open_Models_Warning.init(),CustomLayouts_Modal.init(),Change_Layout_Modal.init(),LockedOptionMask.init(),Model_Import_Modal.init()};return{init:o}}(jQuery);
/**
 * Setting the content positon
 * @since 2.0.0
 */
var Rexlive_Base_Settings=function(t){"use strict";function n(n){return t("<div/>").html(n).text()}function e(n){return t("<div/>").text(n).html()}var i=function(){tippy(".tippy",{arrow:!0,arrowType:"round",size:"small",theme:"rexlive"})},o=function(){var t=window,n="inner";return"innerWidth"in window||(n="client",t=document.documentElement||document.body),{width:t[n+"Width"],height:t[n+"Height"]}},r=function(){this.$document=t(document),this.$window=t(window),i()};return{init:r,htmlDecode:n,htmlEncode:e,viewport:o,launchTooltips:i}}(jQuery);
/**
 * Live Editing
 */
var Rexbuilder_Util_Admin_Editor=function(e){"use strict";var t,o,a,i,n,d,l,r,s,c,v,u,_,m,b,p,g,f,x,h,w,k,y,N,R,M,E,S,C,D=function(e){return"default"==e||"mobile"==e||"tablet"==e?"standard":"custom"},B=function(e){if(e.data.rexliveEvent){var t=e.data;if("rexlive:edited"==e.data.eventName&&(e.data.modelEdited?a=!1:i=!1,n.addClass("page-edited")),"rexlive:undoRedoStackChange"==e.data.eventName&&(e.data.stacks.undo>0?Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.addClass("btn-undo--active"):Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.removeClass("btn-undo--active"),e.data.stacks.redo>0?Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.addClass("btn-redo--active"):Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.removeClass("btn-redo--active")),"rexlive:traceVisibleRow"==e.data.eventName&&(d.val(e.data.sectionTarget.sectionID),l.val(e.data.sectionTarget.modelNumber),r.val(e.data.sectionTarget.modelEditing),s=e.data.rowInfo,ee()),"rexlive:updateTopToolbar"==e.data.eventName&&(Rexbuilder_Util_Admin_Editor.highlightRowSetData(e.data.updateInfo),ee()),"rexlive:openMediaUploader"==e.data.eventName&&Rexlive_MediaUploader.openInsertImageBlocksMediaUploader(t),"rexlive:addNewBlockVideo"==e.data.eventName&&Insert_Video_Modal.openVideoModal(t),"rexlive:addNewSlider"==e.data.eventName&&Rexbuilder_RexSlider.openSliderModal("","","",t.target),"rexlive:editSlider"==e.data.eventName){var o=e.data;Rexbuilder_RexSlider.openSliderModal(o.blockID,o.shortCodeSlider,o.sliderID,o.target)}if("rexlive:openSectionModal"==e.data.eventName&&Section_Modal.openSectionModal(e.data.section_options_active,e.data.mousePosition),"rexlive:openModalMenu"==e.data.eventName&&Model_Modal.openModal(e.data.modelData),"rexlive:updateModel"==e.data.eventName&&Model_Modal.updateModel(e.data.modelData),"rexlive:uploadSliderFromLive"==e.data.eventName){var c=e.data.sliderInfo,v=c.slider,u=c.slider.id.toString(),_=c.newSlider,m=c.blockID,b=c.target;Rexbuilder_RexSlider.saveSlider(v,m,u,_,!0,b)}if("rexlive:openCssEditor"==e.data.eventName&&CssEditor_Modal.openModal(e.data.currentStyle),"rexlive:openHTMLEditor"==e.data.eventName&&HtmlEditor_Modal.openModal(e.data.htmlContent),"rexlive:openLiveImageUploader"==e.data.eventName&&Rexlive_MediaUploader.openImageLiveMediaUploader(e.data.live_uploader_data),"rexlive:editBackgroundSection"==e.data.eventName&&SectionBackground_Modal.openSectionBackgroundModal(e.data.activeBG),"rexlive:editRowVideoBackground"==e.data.eventName&&Section_Video_Background_Modal.openSectionVideoBackgroundModal(e.data.activeBG,e.data.mousePosition),"rexlive:editBlockOptions"==e.data.eventName&&BlockOptions_Modal.openBlockOptionsModal(e.data.activeBlockData),"rexlive:editBlockContentPosition"==e.data.eventName&&Block_Content_Positions_Modal.openBlockContentPositionModal(e.data.activeBlockData,e.data.mousePosition),"rexlive:editBlockImageSettings"==e.data.eventName&&Block_Image_Editor_Modal.openModal(e.data.activeBlockData,e.data.mousePosition),"rexlive:editBlockVideoBackground"==e.data.eventName&&Block_Video_Background_Modal.openBlockVideoBackgroundModal(e.data.activeBlockData,e.data.mousePosition),"rexlive:editRemoveModal"==e.data.eventName&&Model_Edit_Modal.openModal(e.data.modelData),"rexlive:saveAndCloseModel"==e.data.eventName&&(A("CLOSE",e.data.modelData),G("false"),j()),"rexlive:savePageEnded"==e.data.eventName){switch(e.data.dataSaved){case"model":a=!0;break;case"page":i=!0}a&&i&&(NProgress.done(),Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.attr("data-rex-edited-backend",!1),n.removeClass("page-edited"),n.removeClass("rex-saving"),"undefined"!=typeof e.data.buttonData&&""!=e.data.buttonData&&I(e.data.buttonData))}"rexlive:restoreStateEnded"==e.data.eventName&&(a=!0,i=!0,"undefined"!=typeof e.data.buttonData&&""!=typeof e.data.buttonData&&I(e.data.buttonData)),"rexlive:animateContentsFadeOutEnd"==e.data.eventName&&NProgress.inc(.5),"rexlive:animateContentsEnd"==e.data.eventName&&NProgress.done(),"rexlive:esc_pressed"==e.data.eventName&&Rexlive_Modals_Utils.close_focus_modal()}},T=function(){Rexlive_Base_Settings.$document.on("click",".btn-builder-layout",function(n){var d=e(n.target).parents(".btn-builder-layout"),l=d.attr("data-name");if(t!=l){var r={min:d.attr("data-min-width"),max:d.attr("data-max-width"),id:l,label:"undefined"!=typeof d.attr("data-label")?d.attr("data-label"):l,type:D(l)},s={activeLayout:t,activeLayoutLabel:o,buttonData:r,modelSaved:a,pageSaved:i};if("true"==Rexbuilder_Util_Admin_Editor.$rexpansiveContainer.attr("data-rex-edited-backend").toString())LockedOptionMask.openModal(s);else{if(!a||!i)return void Change_Layout_Modal.openModal(s);NProgress.start(),L({eventName:"rexlive:startChangeLayout"}),I(r)}}}),n.on("click",function(e){for(var t=[],o=0;o<R.length;o++)"open"==R[o].m_state&&t.push(R[o]);0===t.length?U():Open_Models_Warning.openModal(t)}),Rexlive_Base_Settings.$document.on("click",".btn-undo",function(e){var t={eventName:"rexlive:undo"};L(t)}),Rexlive_Base_Settings.$document.on("click",".btn-redo",function(e){var t={eventName:"rexlive:redo"};L(t)}),Rexlive_Base_Settings.$document.on("click",".btn-models",function(e){Model_Import_Modal.openModal()}),Rexlive_Base_Settings.$document.on("focus",C,function(t){e(t.target).is(C)&&e(t.target).siblings("label, .prefix").addClass("active")}),Rexlive_Base_Settings.$document.on("blur",C,function(t){e(t.target).is(C)&&""==t.target.value&&e(t.target).siblings("label, .prefix").removeClass("active")}),Rexlive_Base_Settings.$document.on("click",".toolbox-add-new-block-image",function(e){e.preventDefault();var t={rexliveEvent:!0,eventName:"rexlive:openMediaUploader",returnEventName:"rexlive:insert_image",sectionTarget:{sectionID:d.val(),modelNumber:l.val()}};window.postMessage(t,"*")}),Rexlive_Base_Settings.$document.on("click",".toolbox-add-new-block-text",function(e){e.preventDefault();var t={eventName:"rexlive:insert_new_text_block",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()}}};L(t)}),Rexlive_Base_Settings.$document.on("click",".toolbox-add-new-block-video",function(e){e.preventDefault();var t={rexliveEvent:!0,eventName:"rexlive:addNewBlockVideo",sectionTarget:{sectionID:d.val(),modelNumber:l.val()}};window.postMessage(t,"*")}),Rexlive_Base_Settings.$document.on("click",".toolbox-add-new-block-slider",function(e){e.preventDefault();var t={rexliveEvent:!0,eventName:"rexlive:addNewSlider",target:{sectionID:d.val(),modelNumber:l.val()}};window.postMessage(t,"*")}),Rexlive_Base_Settings.$document.on("click",".toolbox-add-new-section",function(e){e.preventDefault();var t={eventName:"rexlive:add_new_section_after",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},position:"after"}};L(t)}),Rexlive_Base_Settings.$document.on("click",".toolbox-collapse-grid",function(e){e.preventDefault(),"true"==s.collapse?s.collapse="false":s.collapse="true",z();var t={eventName:"rexlive:collapse_row",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()}}};L(t)}),Rexlive_Base_Settings.$document.on("change",".edit-row-layout-toolbox",function(e){Rexbuilder_Util_Admin_Editor.highlightRowSetData({layout:e.target.value});var t={eventName:"rexlive:set_gallery_layout",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},layout:e.target.value}};L(t)}),Rexlive_Base_Settings.$document.on("change",".edit-row-width-toolbox",function(e){var t="",o="",a=e.target.value.trim().split(/(\d+)/);t=a[1],o=a[2],Rexbuilder_Util_Admin_Editor.highlightRowSetData({section_width:e.target.value,dimension:e.target.getAttribute("data-section_width")});var i={eventName:"rexlive:set_section_width",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},sectionWidth:{width:t,type:o},forged:!0}};L(i)}),Rexlive_Base_Settings.$document.on("click",".toolbox-builder-section-config",function(e){e.preventDefault();var t=le(e,{offset:{w:this.offsetWidth,h:this.offsetHeight}}),o={rexliveEvent:!0,eventName:"rexlive:openSectionModal",section_options_active:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},activeLayout:s.layout,fullHeight:s.full_height,section_width:s.section_width,dimension:s.dimension,rowDistances:{gutter:s.block_distance,top:s.row_separator_top,right:s.row_separator_right,bottom:s.row_separator_bottom,left:s.row_separator_left},marginsSection:{top:s.row_margin_top,right:s.row_margin_right,bottom:s.row_margin_bottom,left:s.row_margin_left},photoswipe:!1,sectionName:s.section_name,customClasses:s.custom_classes},mousePosition:t};window.postMessage(o,"*")}),Rexlive_Base_Settings.$document.on("click",".edit-row-image-background-toolbox",function(e){e.preventDefault();var t={rexliveEvent:!0,eventName:"rexlive:openLiveImageUploader",live_uploader_data:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},idImage:s.id_image_bg_section,returnEventName:"rexlive:apply_background_image_section",data_to_send:{active:!0}}};window.postMessage(t,"*")}),Rexlive_Base_Settings.$document.on("click",".deactivate-row-image-background-toolbox",function(e){e.preventDefault(),Rexbuilder_Util_Admin_Editor.highlightRowSetData({image_bg_section_active:"false",image_bg_section:"",id_image_bg_section:""}),X();var t={eventName:"rexlive:apply_background_image_section",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},active:!1,idImage:"",urlImage:"",width:"",height:""}};L(t)}),Rexlive_Base_Settings.$document.on("click",".deactivate-row-color-background-toolbox",function(e){e.preventDefault(),Rexbuilder_Util_Admin_Editor.highlightRowSetData({color_bg_section_active:"false",color_bg_section:""}),q();var t={eventName:"rexlive:apply_background_color_section",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},active:!1,color:""}};L(t)}),Rexlive_Base_Settings.$document.on("click",".deactivate-row-overlay-color-toolbox",function(e){e.preventDefault(),Rexbuilder_Util_Admin_Editor.highlightRowSetData({row_overlay_color:"",row_overlay_active:"false"}),K();var t={eventName:"rexlive:change_section_overlay",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},active:!1,color:""}};L(t)}),Rexlive_Base_Settings.$document.on("click",".edit-row-video-background-toolbox",function(e){e.preventDefault();var t={rexliveEvent:!0,eventName:"rexlive:editRowVideoBackground",activeBG:{bgVideo:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},youtubeVideo:s.video_bg_url_section,vimeoUrl:s.video_bg_url_vimeo_section,mp4Video:s.video_mp4_url,mp4VideoID:s.video_bg_id_section}}};window.postMessage(t,"*")}),Rexlive_Base_Settings.$document.on("click",".deactivate-row-video-background-toolbox",function(e){e.preventDefault(),Rexbuilder_Util_Admin_Editor.highlightRowSetData({video_bg_url_section:"",video_bg_id_section:"",video_bg_url_vimeo_section:"",video_mp4_url:""}),Z(),s.video_bg_url_section="",s.video_bg_id_section="",s.video_bg_url_vimeo_section="",s.video_mp4_url="";var t={eventName:"rexlive:update_section_background_video",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()},typeVideo:"",urlVimeo:"",urlYoutube:"",videoMp4:{idMp4:"",linkMp4:""}}};L(t)}),Rexlive_Base_Settings.$document.on("click",".open-model-toolbox",function(e){e.preventDefault();var t={eventName:"rexlive:openCreateModelModal",data_to_send:{sectionTarget:{sectionID:d.val(),modelNumber:l.val()}}};L(t)}),window.addEventListener("message",B,!1)},I=function(e){a=!0,i=!0,t=e.id,o=e.label;var n=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find('.btn-builder-layout[data-name="'+t+'"]');Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".btn-builder-layout.active-layout").removeClass("active-layout"),n.addClass("active-layout"),Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".tool-option__choose-layout").find(".active-layout__icon").html(Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find('.btn-builder-layout[data-name="'+t+'"]').find(".layout__icon").html()),S={selectedLayoutName:t,eventName:"rexlive:changeLayout",layoutData:e},P(e.min)},$=function(e){S=e},A=function(e,t){switch(e){case"OPEN":for(var o=null,a=0;a<R.length;a++)if(t.modelID==R[a].m_id){o=a;break}if(null!==o)R[a].m_state="open";else{var i={m_id:t.modelID,m_name:t.modelName,m_state:"open"};R.push(i)}break;case"CLOSE":for(var o=null,a=0;a<R.length;a++)if(t.modelID==R[a].m_id){o=a;break}if(null!==o)R[a].m_state="close";else{var i={m_id:t.modelID,m_name:t.modelName,m_state:"close"};R.push(i)}break;case"REMOVE":for(var o=null,a=0;a<R.length;a++)if(t.modelID==R[a].m_id){o=a;break}null!==o&&R.splice(o,1)}},U=function(){NProgress.start(),e(this).addClass("rex-saving");var o={eventName:"rexlive:savePage",data_to_send:{activeLayout:t}};L(o)},P=function(e){e!=Rexbuilder_Util_Admin_Editor.activeWidth?(""==e?(M.css("width","100%"),M.css("min-width","1024px")):(M.css("width",e),M.css("min-width","")),Rexbuilder_Util_Admin_Editor.activeWidth=e):L(S)},L=function(e){var t={rexliveEvent:!0};jQuery.extend(t,e),E.postMessage(t,"*")},V=function(e){for(var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},O=function(){return t},W=function(e){t=e,this.$responsiveToolbar.find(".btn-builder-layout.active-layout").removeClass("active-layout"),this.$responsiveToolbar.find('.btn-builder-layout[data-name="'+t+'"]').addClass("active-layout")},F=function(){var e,t=document.createElement("fakeelement"),o={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in o)if(void 0!==t.style[e])return o[e]},Y=function(){var e,t=document.createElement("fakeelement"),o={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in o)if(void 0!==t.style[e])return o[e]},H=function(e){l.val(e)},G=function(e){r.val(e)},j=function(){""!==l.val()&&"undefined"!=typeof l.val()&&"false"===r.val()?Rexbuilder_Util_Admin_Editor.$responsiveToolbar.addClass("rexlive-toolbox--model"):Rexbuilder_Util_Admin_Editor.$responsiveToolbar.removeClass("rexlive-toolbox--model")},z=function(){"true"==s.collapse?u.addClass("active"):u.removeClass("active")},J=function(){c.filter("[data-section_width="+s.dimension+"]").attr("checked",!0)},Q=function(){v.filter("[value="+s.layout+"]").attr("checked",!0)},X=function(){""!==s.id_image_bg_section&&""!==s.image_bg_section?(_.addClass("tool-button--image-preview").attr("value",s.id_image_bg_section).css("background-image","url("+s.image_bg_section+")"),p.addClass("tool-button--hide"),g.parent().removeClass("tool-button--hide")):(_.removeClass("tool-button--image-preview").attr("value","").css("background-image","none"),p.removeClass("tool-button--hide"),g.parent().addClass("tool-button--hide"))},q=function(){""!==s.color_bg_section?(m.val(s.color_bg_section).spectrum("set",s.color_bg_section),m.parent().addClass("tool-button--picker-preview"),m.siblings(".tool-button--color-preview").css("background-color",s.color_bg_section),f.parent().addClass("tool-button--hide"),x.parent().removeClass("tool-button--hide")):(m.val("").spectrum("set",""),m.parent().removeClass("tool-button--picker-preview"),m.siblings(".tool-button--color-preview").css("background-color",""),f.parent().removeClass("tool-button--hide"),x.parent().addClass("tool-button--hide"))},K=function(){""!==s.row_overlay_color?(b.val(s.row_overlay_color).spectrum("set",s.row_overlay_color),b.parent().addClass("tool-button--picker-preview"),b.siblings(".tool-button--color-preview").css("background-color",s.row_overlay_color),h.parent().addClass("tool-button--hide"),w.parent().removeClass("tool-button--hide")):(b.val("").spectrum("set",""),b.parent().removeClass("tool-button--picker-preview"),b.siblings(".tool-button--color-preview").css("background-color",""),h.parent().removeClass("tool-button--hide"),w.parent().addClass("tool-button--hide"))},Z=function(){""!==s.video_bg_url_section&&"undefined"!=typeof s.video_bg_url_section||""!==s.video_bg_url_vimeo_section&&"undefined"!=typeof s.video_bg_url_vimeo_section||""!==s.video_mp4_url&&"undefined"!=typeof s.video_mp4_url||""!==s.video_bg_id_section&&"undefined"!=typeof s.video_bg_id_section?(y.addClass("tool-button--hide"),N.parent().removeClass("tool-button--hide")):(y.removeClass("tool-button--hide"),N.parent().addClass("tool-button--hide"))},ee=function(){j(),z(),J(),Q(),X(),q(),K(),Z()},te=function(){var e={eventName:"rexlive:lockRows"};L(e)},oe=function(){var e={eventName:"rexlive:unlockRows"};L(e)},ae=function(){i=!1,n.addClass("page-edited")},ie=function(){ne(),de()},ne=function(){var e=!1,t=!1,o={eventName:null,data_to_send:{color:null,sectionTarget:{sectionID:null,modelNumber:null}}};m.spectrum({replacerClassName:"tool-button tool-button--inline tool-button--empty tool-button--color tool-button--spectrum",preferredFormat:"hex",showPalette:!1,showAlpha:!0,showInput:!0,showButtons:!1,show:function(){e=!1,o.data_to_send.sectionTarget.sectionID=d.val(),o.data_to_send.sectionTarget.modelNumber=l.val(),t=JSON.parse(s.color_bg_section_active)},move:function(a){o.data_to_send.active=!0,o.data_to_send.color=a.toRgbString(),t?o.eventName="rexlive:change_section_bg_color":o.eventName="rexlive:apply_background_color_section",L(o),e=!0},hide:function(t){e&&(Rexbuilder_Util_Admin_Editor.highlightRowSetData({color_bg_section_active:"true",color_bg_section:t.toRgbString()}),Rexbuilder_Util_Admin_Editor.updateBkgrColTool(),o.data_to_send.active=!0,o.data_to_send.color=t.toRgbString(),o.eventName="rexlive:apply_background_color_section",L(o)),e=!1}})},de=function(){var e=!1,t=!1,o={eventName:null,data_to_send:{color:null,sectionTarget:{sectionID:null,modelNumber:null}}};b.spectrum({replacerClassName:"tool-button tool-button--inline tool-button--empty tool-button--color tool-button--spectrum",preferredFormat:"hex",showPalette:!1,showAlpha:!0,showInput:!0,showButtons:!1,show:function(){e=!1,o.data_to_send.sectionTarget.sectionID=d.val(),o.data_to_send.sectionTarget.modelNumber=l.val(),t=JSON.parse(s.row_overlay_active)},move:function(a){o.data_to_send.active=!0,o.data_to_send.color=a.toRgbString(),t?o.eventName="rexlive:change_section_overlay_color":o.eventName="rexlive:change_section_overlay",L(o),e=!0},hide:function(t){e&&(Rexbuilder_Util_Admin_Editor.highlightRowSetData({row_overlay_active:"true",row_overlay_color:t.toRgbString()}),Rexbuilder_Util_Admin_Editor.updateBkgrOverlayTool(),o.data_to_send.active=!0,o.data_to_send.color=t.toRgbString(),o.eventName="rexlive:change_section_overlay",L(o)),e=!1}})},le=function(e,t){var o={};if("undefined"!=typeof e.clientX&&"undefined"!=typeof e.clientY&&"undefined"!=typeof e.offsetX&&"undefined"!=typeof e.offsetY&&"undefined"!=typeof t){var a=e.target.getBoundingClientRect();o={x:a.left+t.offset.w/2,y:a.top+Rexbuilder_Util_Admin_Editor.mousePositionFrameYOffset}}else o={x:Rexbuilder_Util_Admin_Editor.viewportMeasurement.width/2,y:Rexbuilder_Util_Admin_Editor.viewportMeasurement.height/2};return o},re=function(e){if(""!==e)for(var t in e)s[t]=e[t]},se=function(){this.$body=e("body"),this.$rexpansiveContainer=e("#rexpansive-builder-backend-wrapper"),M=this.$rexpansiveContainer.find(".rexpansive-live-frame-container"),this.$frameBuilder=this.$rexpansiveContainer.find("#rexpansive-live-frame"),E=this.$frameBuilder[0].contentWindow,this.transitionEvent=F(),this.animationEvent=Y(),this.mousePositionFrameYOffset=50,this.viewportMeasurement=Rexlive_Base_Settings.viewport(),this.$responsiveToolbar=this.$rexpansiveContainer.find(".rexlive-toolbox"),d=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find("input[name=toolbox-insert-area--row-id]"),l=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find("input[name=toolbox-insert-area--row-model-id]"),r=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find("input[name=toolbox-insert-area--row-model-editing]"),c=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".edit-row-width-toolbox"),v=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".edit-row-layout-toolbox"),u=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".toolbox-collapse-grid");var s=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".toolbox-right-config-area"),D=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".toolbox-right-fast-config-area");p=s.find(".edit-row-image-background-toolbox"),g=D.find(".edit-row-image-background-toolbox"),_=p.add(g),f=s.find("input[name=edit-row-color-background-toolbox]"),x=D.find("input[name=edit-row-color-background-toolbox]"),m=f.add(x),h=s.find("input[name=edit-row-overlay-color-toolbox]"),w=D.find("input[name=edit-row-overlay-color-toolbox]"),b=h.add(w),y=s.find(".edit-row-video-background-toolbox"),N=D.find(".edit-row-video-background-toolbox"),k=y.add(N),n=Rexbuilder_Util_Admin_Editor.$responsiveToolbar.find(".btn-save"),i=!0,a=!0,R=[],t="default",o="default",this.$responsiveToolbar.find(".builder-default-layout").addClass("active-layout"),this.activeWidth=0,C="input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], input[type=date], input[type=time], textarea",NProgress.configure({template:'<div class="bar" role="bar"><div class="peg"></div></div>'}),M.on(Rexbuilder_Util_Admin_Editor.transitionEvent,function(){null!==S&&"undefined"!=typeof S&&L(S)}),ie(),T()};return{init:se,createRandomID:V,sendIframeBuilderMessage:L,updateLayoutPage:I,getActiveLayout:O,setActiveLayout:W,updateIframeWidth:P,updateLayoutActiveData:$,releaseIframeRows:oe,blockIframeRows:te,editPageProperties:ae,updateOpenModelsList:A,highlightRowSetData:re,updateTopToolbar:ee,updateModelId:H,updateModelEditing:G,updateModelState:j,updateWidthTool:J,updateLayoutTool:Q,updateBkgrImgTool:X,updateBkgrColTool:q,updateBkgrOverlayTool:K,updateBkgrVidTool:Z}}(jQuery);
!function(i){"use strict";i(document).ready(function(){Rexlive_Base_Settings.init(),Rexbuilder_Util_Admin_Editor.init(),Rexlive_Modals_Utils.init(),Rexlive_Modals.init(),Rexpansive_Builder_Admin_TextEditor.init(),Rexbuilder_RexSlider.init()})}(jQuery);